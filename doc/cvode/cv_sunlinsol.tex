%===================================================================================
\chapter{Description of the SUNLinearSolver module}\label{s:sunlinsol}
%===================================================================================
\index{SUNLinearSolver@\texttt{SUNLinearSolver} module}
\input{sunlinsol_generic}


%---------------------------------------------------------------------------
\section{SUNLinearSolver functions used by CVODE}

In Table \ref{t:sunlinsoluse}, we list the linear solver
functions in the {\sunlinsol} module used within the {\cvls} interface
in the {\cvode} package.  In general, {\cvls} considers two
non-overlapping categories of linear solvers: \emph{matrix-based} and
\emph{matrix-free}, determined based on whether the {\sunmatrix}
object \id{J} passed to \Id{CVodeSetLinearSolver} was not \id{NULL}.

Additionally, {\cvls} will consider a linear solver of either type as
\emph{iterative} if it self-identifies as
\id{SUNLINEARSOLVER\_ITERATIVE} (via the \Id{SUNLinSolGetType}
routine).  Since both matrix-based and matrix-free linear solvers may
be iterative, we only list {\sunlinsol} routines that are specifically
called based on this type; these routines are \emph{in addition to} those
listed for the other two categories.

As with the {\sunmatrix} module, we emphasize that the {\cvode} user
does not need to know detailed usage of linear solver functions by the
{\cvode} code modules in order to use {\cvode}. The information is
presented as an implementation detail for the interested reader.

The linear solver functions listed below are marked with \cm to
indicate that they are required, or with $\dagger$ to indicate that
they are only called if they are non-\id{NULL} in the {\sunlinsol}
implementation that is being used.  

\begin{table}[htb]
\centering
\caption{List of linear solver functions usage by {\cvode} code modules}\label{t:sunlinsoluse}
\medskip
\begin{tabular}{|r|c|c|c|} \hline
                                             & 
\begin{sideways}{Matrix-Based}      \end{sideways} & 
\begin{sideways}{Matrix-Free}       \end{sideways} & 
\begin{sideways}{Iterative}         \end{sideways} \\ \hline\hline
%                                 mat-based    mat-free   iterative
\id{SUNLinSolGetType}           &    \cm    &    \cm    &           \\ \hline
\id{SUNLinSolSetATimes}         &           &    \cm    &           \\ \hline
\id{SUNLinSolSetPreconditioner} &           &           & $\dagger$ \\ \hline
\id{SUNLinSolSetScalingVectors} & $\dagger$ & $\dagger$ &           \\ \hline
\id{SUNLinSolInitialize}        &    \cm    &    \cm    &           \\ \hline
\id{SUNLinSolSetup}             &    \cm    &    \cm    &           \\ \hline
\id{SUNLinSolSolve}             &    \cm    &    \cm    &           \\ \hline
$^1$\id{SUNLinSolNumIters}      &           &           & $\dagger$ \\ \hline
$^2$\id{SUNLinSolLastFlag}      &           &           &           \\ \hline
\id{SUNLinSolFree}              &    \cm    &    \cm    &           \\ \hline
\id{SUNLinSolSpace}             & $\dagger$ & $\dagger$ &           \\ \hline
\end{tabular}
\end{table}

\begin{itemize}
\item[1.] \id{SUNLinSolNumIters} is only used to accumulate overall
  iterative linear solver statistics.  If it is not implemented by
  the {\sunlinsol} module, then {\cvls} will consider all solves as
  requiring zero iterations.
\item[2.] Although {\cvls} does not call \id{SUNLinSolLastFlag}
  directly, this routine is available for users to query linear solver
  issues directly.
\end{itemize}

