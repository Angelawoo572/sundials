%===================================================================================
\chapter{Description of the SUNMatrix module}\label{s:sunmatrix}
%===================================================================================
\index{SUNMatrix@\texttt{SUNMatrix} module}
\input{sunmatrix_generic}


%---------------------------------------------------------------------------
\section{SUNMatrix functions used by CVODE}

In Table \ref{t:sunmatuse} below, we list the matrix functions in the 
{\sunmatrix} module used within the {\cvode} package.
The table also shows, for each function, which of the code modules uses
the function. Neither the main {\cvode} integrator or the {\cvspils}
interface call {\sunmatrix} functions directly, so the table columns
are specific to the {\cvdls} direct solver interface and the
{\cvbandpre} and {\cvbbdpre} preconditioner modules.

At this point, we should emphasize that the {\cvode} user does not need to know 
anything about the usage of matrix functions by the {\cvode} code modules in order 
to use {\cvode}. The information is presented as an implementation detail for the 
interested reader.

\begin{table}[htb]
\centering
\caption{List of matrix functions usage by {\cvode} code modules}\label{t:sunmatuse}
\medskip
\begin{tabular}{|r|c|c|c|} \hline
                                             & 
\begin{sideways}{\cvdls}      \end{sideways} & 
\begin{sideways}{\cvbandpre}  \end{sideways} &
\begin{sideways}{\cvbbdpre}   \end{sideways} \\ \hline\hline
%                         DLS   BPRE   BBD
\id{SUNMatGetID}         & \cm &     &     \\ \hline
\id{SUNMatClone}         & \cm &     &     \\ \hline
\id{SUNMatDestroy}       & \cm & \cm & \cm \\ \hline
\id{SUNMatZero}          & \cm & \cm & \cm \\ \hline
\id{SUNMatCopy}          & \cm & \cm & \cm \\ \hline
\id{SUNMatScaleAddI}     & \cm & \cm & \cm \\ \hline
\id{SUNMatSpace}         & \cm & \cm & \cm \\ \hline
\end{tabular}
\end{table}

The matrix functions listed in Table \ref{t:sunmatops} that are {\em not} used by
{\cvode} are: \id{SUNMatScaleAdd} and \id{SUNMatMatvec}.
Therefore a user-supplied {\sunmatrix} module for {\cvode} could omit
these functions.

