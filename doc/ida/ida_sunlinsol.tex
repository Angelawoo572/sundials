%===================================================================================
\chapter{Description of the SUNLinearSolver module}\label{s:sunlinsol}
%===================================================================================
\index{SUNLinearSolver@\texttt{SUNLinearSolver} module}
\input{sunlinsol_generic}


%---------------------------------------------------------------------------
\section{SUNLinearSolver functions used by IDA}

In Table \ref{t:sunlinsoluse} below, we list the linear solver
functions in the {\sunlinsol} module used within the {\ida} package.
The table also shows, for each function, which of the code modules uses
the function.  In general, the main {\ida} integrator considers
three categories of linear solvers, \emph{direct}, \emph{iterative}
and \emph{custom}, with interfaces accessible in the {\ida} header
files \id{ida\_direct.h} ({\idadls}), \id{ida\_spils.h}
({\idaspils}) and \id{ida\_customls.h} ({\idacls}), respectively.
Hence, the table columns reference the use of {\sunlinsol}
functions by each of these solver interfaces.

As with the {\sunmatrix} module, we emphasize that the {\ida} user
does not need to know detailed usage of linear solver functions by the
{\ida} code modules in order to use {\ida}. This information is
presented as an implementation detail for the interested reader.

\begin{table}[htb]
\centering
\caption{List of linear solver function usage by {\ida} code modules}\label{t:sunlinsoluse}
\medskip
\begin{tabular}{|r|c|c|c|} \hline
                                             & 
\begin{sideways}{\idadls}      \end{sideways} & 
\begin{sideways}{\idaspils}    \end{sideways} & 
\begin{sideways}{\idacls}      \end{sideways} \\ \hline\hline
%                                    DLS        SPILS       CLS
\id{SUNLinSolGetType}           &    \cm    &    \cm    & $\dagger$ \\ \hline
\id{SUNLinSolSetATimes}         &           &    \cm    & $\dagger$ \\ \hline
\id{SUNLinSolSetPreconditioner} &           &    \cm    & $\dagger$ \\ \hline
\id{SUNLinSolSetScalingVectors} &           &    \cm    & $\dagger$ \\ \hline
\id{SUNLinSolInitialize}        &    \cm    &    \cm    &    \cm    \\ \hline
\id{SUNLinSolSetup}             &    \cm    &    \cm    &    \cm    \\ \hline
\id{SUNLinSolSolve}             &    \cm    &    \cm    &    \cm    \\ \hline
\id{SUNLinSolNumIters}          &           &    \cm    & $\dagger$ \\ \hline
\id{SUNLinSolResNorm}           &           &    \cm    & $\dagger$ \\ \hline
\id{SUNLinSolResid}             &           &    \cm    & $\dagger$ \\ \hline
\id{SUNLinSolLastFlag}          &           &           &           \\ \hline
\id{SUNLinSolFree}              &           &           &           \\ \hline
\id{SUNLinSolSpace}             & $\dagger$ & $\dagger$ & $\dagger$ \\ \hline
\end{tabular}
\end{table}

The linear solver functions listed in Table \ref{t:sunlinsolops} with
a $\dagger$ symbol are optionally used, in that these are only called
if they are implemented in the {\sunlinsol} module that is being used
(i.e.~their function pointers are non-\id{NULL}).  Also, although
{\ida} does not call the \id{SUNLinSolLastFlag} or \id{SUNLinSolFree}
routines directly, these are available for users to query linear
solver issues and free linear solver memory directly. 

