<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: [sundials&#45;users] Two Questions &#45; about CVODES and SundialsTB -->
<!--X-From-R13: Dnqh Ereona <enqhNyyay.tbi> -->
<!--X-Date: Fri, 09 Mar 2007 16:03:31 &#45;0800 -->
<!--X-Message-Id: 45F1F5B5.7010604@llnl.gov -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: fb31b0a70703091433j656a2e7bw92e4ca557513f04c@mail.gmail.com -->
<!--X-Head-End-->
<html>
<head>
<title>Re: [sundials-users] Two Questions - about CVODES and SundialsTB</title>
<meta name="author" content="Radu Serban">
<meta name="description" content="suite of nonlinear differential algebraic equation solvers">
<meta name="keywords" content="SUNDIALS, CVODE, CVODES, IDA, KINSOL">
<meta name="keywords" content="ODE, DAE, sensitivity">
<meta name="keywords" content="differential, algebraic">
<link REL="SHORTCUT ICON" HREF="img/favicon.ico" type="image/x-icon">
<link REL="ICON" HREF="img/favicon.ico" type="image/x-icon">
<link href="../../sundials_styles.css" rel="stylesheet" type="text/css">
<script language="JavaScript">
<!--
homeon = new Image();           homeon.src = "../../graphics/home_buttonH.png";
homeoff = new Image();          homeoff.src = "../../graphics/home_button.png";
descriptionon = new Image();    descriptionon.src = "../../graphics/description_buttonH.png";
descriptionoff = new Image();   descriptionoff.src = "../../graphics/description_button.png";
documentationon = new Image();  documentationon.src = "../../graphics/documentation_buttonH.png";
documentationoff = new Image(); documentationoff.src = "../../graphics/documentation_button.png";
downloadon = new Image();       downloadon.src = "../../graphics/download_buttonH.png";
downloadoff = new Image();      downloadoff.src = "../../graphics/download_button.png";
supporton = new Image();        supporton.src = "../../graphics/support_buttonH.png";
supportoff = new Image();       supportoff.src = "../../graphics/support_button.png";
//-->
</script>
<script src="../../sunjs.js" type="text/javascript" language="javascript1.2"></script>
</head>
<!-- ******************************************************************************** -->
<body>
<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
  <td height="60" background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  <td width="116"><img SRC="../../graphics/head_top_left.png" height="60" width="116" border="0"></td>
  <td width="720"><img SRC="../../graphics/head_mail_top_right.png" height="60" width="720" border="0"></td>
  <td background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  </tr>
  <tr valign="top">
  <td height="127" background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  <td width="116">
    <a href="../../main.html" onMouseOver="img_act('home'); return true;" onMouseOut="img_inact('home'); return true;"><img src="../../graphics/home_button.png" border="0" name="home"></a><br>
    <a href="../../description/description.html" onMouseOver="img_act('description'); return true;" onMouseOut="img_inact('description'); return true;"><img src="../../graphics/description_button.png" border="0" name="description"></a><br>
    <a href="../../documentation/documentation.html" onMouseOver="img_act('documentation'); return true;" onMouseOut="img_inact('documentation'); return true;"><img src="../../graphics/documentation_button.png" border="0" name="documentation"></a><br>
    <a href="../../download/download.html" onMouseOver="img_act('download'); return true;" onMouseOut="img_inact('download'); return true;"><img src="../../graphics/download_button.png" border="0" name="download"></a><br>
    <a href="../../support/support.html" onMouseOver="img_act('support'); return true;" onMouseOut="img_inact('support'); return true;"><img src="../../graphics/support_button.png" border="0" name="support"></a><br>
    <img SRC="../../graphics/line_tl.gif" height="7" width="116" border="0"></td>
  <td width="720">
      <img SRC="../../graphics/head_bottom_right.png" height="120" width="720" border="0"><br>
      <img SRC="../../graphics/line_tr.gif" height="7" width="720" border="0"></td>
  <td background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  </tr>
  <tr valign="top">
  <td background="../../graphics/table_bck3.gif"></td>
  <td width="116" valign="bottom" align="center" background="../../graphics/table_bck5.gif"><img SRC="../../graphics/logo.png" border="0"></td>
  <td width="720" bgcolor="#ffffff">
  <div id="content">   
<!-- Start content for this page -->
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<p class="links">
[<a href="msg00905.html">Date Prev</a>] [<a href="msg00907.html">Date Next</a>] [<a href="msg00903.html">Thread Prev</a>] [<a href="msg00912.html">Thread Next</a>]<br>
[<b><a href="maillist.html#00906">Date Index</a></b>]
[<b><a href="threads.html#00906">Thread Index</a></b>]
</p>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [sundials-users] Two Questions - about CVODES and SundialsTB</h1>
<div class="frame">
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<table border=0 cellpadding=2 cellspacing=0>
<tr>
<td align="right"><b>
<em>From</em></b></td>
<td align="left">
Radu Serban &lt;<a href="mailto:radu%40llnl.gov">radu@llnl.gov</a>&gt;</td>
</tr>

<tr>
<td align="right"><b>
<em>Date</em></b></td>
<td align="left">
Fri, 09 Mar 2007 16:03:01 -0800</td>
</tr>

</table>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div>
<div class="container">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Hi Ayesha,</pre><br>
<tt>Ayesha Kalra wrote:
</tt><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">Hi Sundials Users</pre><br>
<tt>I started using the Sundials suite around 2 weeks back. I was trying<br>
to calculate Forward Sensitivity of a large, stiff system of ODE<br>
(around 50 species and 100 parameters). So I modified the file<br>
'cvsfwddenx.x' given in the example section of the CVODES to suit my<br>
system. 
</tt></blockquote><tt><br>FSA with respect to 100 parameters is going to be slow (expect the sensitivity 
calculations to be at least 101 times slower than a straight simulation - and 
that's in the best case scenario, when one sensitivity RHS evaluation costs as 
much as one original RHS evaluation). Would ASA make sense for your problem?</tt><br>
<br>
<blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><tt>I also relaxed the relative and absolute tolerances. My
</tt></blockquote><tt><br>That's problem-specific, so you should know better (the truth is that the 
Roberson chemical kinetics problem solved in cvsfwddense does indeed require 
unusually tight tolerances, so you're probably right to relax them for your problem)</tt><br>
<br>
<blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">question is how do I calculate Sensitivites separated by fixed time
intervals (0,10,20,...) instead of time intervals multiplied by a
fixed constant. (0,1,10,100..) as defined by the 'cvsfwddenx.c'. Also,
</pre></blockquote><tt><br>That's just a matter of changing the loop within which CVode and CVodeGetSens 
are called to whatever suits you:<br>
for (iout=1, tout=10; iout &lt;= 5; iout++, tout += 10) {<br>
  flag = CVode(cvode_mem, tout, y, &amp;t, CV_NORMAL);<br>
  flag = CVodeGetSens(cvode_mem, t, yS);<br>
}<br>
will return at t=10,20,30,40,50. (The solution at t=0 is presumably your init. 
cond.)</tt><br>
<br>
<blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">the program crashes after a little while saying the maximum no. of
steps have already been taken. ( I can provide the exact error
message, if required ). Any help will be appreciated.
</pre></blockquote><tt><br>A CV_TOO_MUCH_WORK error is returned if the solver takes more than a prescribed 
number of steps before reaching the current value of tout. This check is 
performed to flag that something may be going wrong. In some situations (the 
problem is genuinely hard to solve, the tolerances are very tight, output is 
required at very far apart output times, etc.) it is possible for CVODES to need 
more than 500 steps. If you're sure that this is OK, simply increase the default 
value by calling CVodeSetMaxNumSteps.</tt><br>
<br>
<tt>In most cases, enabling sensitivity analysis (even with full error control; i.e. 
having the sensitivity variables participate in the error control), will not 
make CVODES take more steps than needed for simply integrating the original 
equations. Therefore, the first thing to do is run the code with FSA disabled. 
Do you still get a CV_TOO_MUCH_WORK error?</tt><br>
<br>
<blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">Secondly, I have a Octave code for a system of ODEs and again I want
to calculate the sensitivities. So, I was thinking instead of writing
a C code, I could use the Sundials TB for MATLAB. I read somewhere on
the internet that the ToolBox can be complied and used under Octave
too. Any help in installing and running the example problems will be
appreciated.
</pre></blockquote><tt><br>The best person to ask this is John Eaton (who is still subscribed to this list 
as far as I know).</tt><br>
<br>
<blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">Thanks
Ayesha
</pre></blockquote><pre style="margin: 0em;"><br>--Radu</pre><br>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<div class="container">
<table width="95%" frame="below"><tr><td></td></table>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00912" href="msg00912.html">Re: [sundials-users] Two Questions - about CVODES and SundialsTB</a></strong>
<ul><li><em>From:</em> &quot;Ayesha Kalra&quot; &lt;ayesha.kalra@gmail.com&gt;</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00903" href="msg00903.html">[sundials-users] Two Questions - about CVODES and SundialsTB</a></strong>
<ul><li><em>From:</em> &quot;Ayesha Kalra&quot; &lt;ayesha.kalra@gmail.com&gt;</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00905.html">Re: [sundials-users] Alternate linear solvers for kinsol</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00907.html">Re: [sundials-users] Alternate linear solvers for kinsol</a></strong>
</li>

<li>Previous by thread:
<strong><a href="msg00903.html">[sundials-users] Two Questions - about CVODES and SundialsTB</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00912.html">Re: [sundials-users] Two Questions - about CVODES and SundialsTB</a></strong>
</li>

<li>Index(es):
<ul>
<li><a href="maillist.html#00906">
<strong>Main</strong></a></li>
<li><a href="threads.html#00906">
<strong>Thread</strong></a></li>
</ul>
</li>
</ul>
</div>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<!-- End content for this page -->
  </div>
  </td>
  <td background="../../graphics/table_bck3.gif"></td>
  </tr>
  <tr valign="top">
  <td height="17" background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  <td width="116"><a HREF="http://www.llnl.gov/disclaimer.html" target="_top"><img SRC="../../graphics/line_bl.gif" height="17" width="116" border="0"></a></td>
  <td width="720"><img SRC="../../graphics/line_br.gif" height="17" width="720" border="0"></td>
  <td background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  </tr>
  </table>
</body>
</html>
