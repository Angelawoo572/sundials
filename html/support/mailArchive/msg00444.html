<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: [sundials&#45;users] Forward sensitivities for initial conditions+number of sensitivities -->
<!--X-From-R13: nangbyvl <nangbylNznb.avxbynri.hn> -->
<!--X-Date: Mon, 01 May 2006 11:27:24 &#45;0700 (PDT) -->
<!--X-Message-Id: 200605012123.34763.anatoly@mao.nikolaev.ua -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 200604241327.09442.anatoly@mao.nikolaev.ua -->
<!--X-Reference: 445242B8.5090103@llnl.gov -->
<!--X-Head-End-->
<html>
<head>
<title>Re: [sundials-users] Forward sensitivities for initial conditions+number of sensitivities</title>
<meta name="author" content="Radu Serban">
<meta name="description" content="suite of nonlinear differential algebraic equation solvers">
<meta name="keywords" content="SUNDIALS, CVODE, CVODES, IDA, KINSOL">
<meta name="keywords" content="ODE, DAE, sensitivity">
<meta name="keywords" content="differential, algebraic">
<link REL="SHORTCUT ICON" HREF="img/favicon.ico" type="image/x-icon">
<link REL="ICON" HREF="img/favicon.ico" type="image/x-icon">
<link href="../../sundials_styles.css" rel="stylesheet" type="text/css">
<script language="JavaScript">
<!--
homeon = new Image();           homeon.src = "../../graphics/home_buttonH.png";
homeoff = new Image();          homeoff.src = "../../graphics/home_button.png";
descriptionon = new Image();    descriptionon.src = "../../graphics/description_buttonH.png";
descriptionoff = new Image();   descriptionoff.src = "../../graphics/description_button.png";
documentationon = new Image();  documentationon.src = "../../graphics/documentation_buttonH.png";
documentationoff = new Image(); documentationoff.src = "../../graphics/documentation_button.png";
downloadon = new Image();       downloadon.src = "../../graphics/download_buttonH.png";
downloadoff = new Image();      downloadoff.src = "../../graphics/download_button.png";
supporton = new Image();        supporton.src = "../../graphics/support_buttonH.png";
supportoff = new Image();       supportoff.src = "../../graphics/support_button.png";
//-->
</script>
<script src="../../sunjs.js" type="text/javascript" language="javascript1.2"></script>
</head>
<!-- ******************************************************************************** -->
<body>
<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
  <td height="60" background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  <td width="116"><img SRC="../../graphics/head_top_left.png" height="60" width="116" border="0"></td>
  <td width="720"><img SRC="../../graphics/head_mail_top_right.png" height="60" width="720" border="0"></td>
  <td background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  </tr>
  <tr valign="top">
  <td height="127" background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  <td width="116">
    <a href="../../main.html" onMouseOver="img_act('home'); return true;" onMouseOut="img_inact('home'); return true;"><img src="../../graphics/home_button.png" border="0" name="home"></a><br>
    <a href="../../description/description.html" onMouseOver="img_act('description'); return true;" onMouseOut="img_inact('description'); return true;"><img src="../../graphics/description_button.png" border="0" name="description"></a><br>
    <a href="../../documentation/documentation.html" onMouseOver="img_act('documentation'); return true;" onMouseOut="img_inact('documentation'); return true;"><img src="../../graphics/documentation_button.png" border="0" name="documentation"></a><br>
    <a href="../../download/download.html" onMouseOver="img_act('download'); return true;" onMouseOut="img_inact('download'); return true;"><img src="../../graphics/download_button.png" border="0" name="download"></a><br>
    <a href="../../support/support.html" onMouseOver="img_act('support'); return true;" onMouseOut="img_inact('support'); return true;"><img src="../../graphics/support_button.png" border="0" name="support"></a><br>
    <img SRC="../../graphics/line_tl.gif" height="7" width="116" border="0"></td>
  <td width="720">
      <img SRC="../../graphics/head_bottom_right.png" height="120" width="720" border="0"><br>
      <img SRC="../../graphics/line_tr.gif" height="7" width="720" border="0"></td>
  <td background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  </tr>
  <tr valign="top">
  <td background="../../graphics/table_bck3.gif"></td>
  <td width="116" valign="bottom" align="center" background="../../graphics/table_bck5.gif"><img SRC="../../graphics/logo.png" border="0"></td>
  <td width="720" bgcolor="#ffffff">
  <div id="content">   
<!-- Start content for this page -->
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<p class="links">
[<a href="msg00443.html">Date Prev</a>] [<a href="msg00445.html">Date Next</a>] [<a href="msg00443.html">Thread Prev</a>] [<a href="msg00445.html">Thread Next</a>]<br>
[<b><a href="maillist.html#00444">Date Index</a></b>]
[<b><a href="threads.html#00444">Thread Index</a></b>]
</p>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [sundials-users] Forward sensitivities for initial conditions+number of sensitivities</h1>
<div class="frame">
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<table border=0 cellpadding=2 cellspacing=0>
<tr>
<td align="right"><b>
<em>From</em></b></td>
<td align="left">
anatoliy &lt;<a href="mailto:anatoly%40mao.nikolaev.ua">anatoly@mao.nikolaev.ua</a>&gt;</td>
</tr>

<tr>
<td align="right"><b>
<em>Date</em></b></td>
<td align="left">
Mon, 01 May 2006 21:23:34 +0300</td>
</tr>

</table>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div>
<div class="container">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>Hi All,

First of all, I wish to thank Dr. Radu Serban for the example code. It removed 
the problem with sensitivities of initial conditions coding.
Firstly the example code showed
[CVODES ERROR] CVode
At t=0 and h=5.59654e-15, the corrector convergence test failed repeatedly or 
with |h|=hmin.
I turned off the analytical Jacobi matrix, and the example works. The 
analytical Jacobi matrix looks pretty correct. Any ideas of misbehavior?

Are there any limits on the number of sensitivities (sensitivity parameters)? 
Can the number of sensitivities be greater than the number of equations?
E.g., I have some dynamical problem, where the solution components (NEQ) 
depend on their initial conditions and some masses in the equations of 
motions. Here the number of sensitivities is greater, than the NEQ.
I have a segmentation fault when I try to set initial conditions in such a 
case. Here is a short code, where it is (NS&gt;NEQ and y is N_Vector of NEQ 
dimension).
  yS=N_VCloneVectorArray_Serial(NS, y);
  if(check_flag((void *)yS, &quot;N_VCloneVectorArray_Serial&quot;, 0)) return(1);
  for(i=0;i&lt;NS;i++){
    N_VConst(ZERO, yS[i]);
    if(i%7-6) Ith(yS[i],i)=ONE;
    printf(&quot;%lf\n&quot;, Ith(yS[i],i));}
The allocation gives no errors. But when I tried to print assigned values out, 
it gave me the lesser list of values and segmentation fault. Is it a problem 
of my compilation?
Regards,
Anatoliy

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<div class="container">
<table width="95%" frame="below"><tr><td></td></table>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00445" href="msg00445.html">Re: [sundials-users] Forward sensitivities for initial conditions+number of sensitivities</a></strong>
<ul><li><em>From:</em> Radu Serban &lt;serban1@llnl.gov&gt;</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00440" href="msg00440.html">[sundials-users] Forward sensitivities for initial conditions</a></strong>
<ul><li><em>From:</em> anatoliy &lt;anatoly@mao.nikolaev.ua&gt;</li></ul></li>
<li><strong><a name="00443" href="msg00443.html">Re: [sundials-users] Forward sensitivities for initial conditions</a></strong>
<ul><li><em>From:</em> Radu Serban &lt;serban1@llnl.gov&gt;</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00443.html">Re: [sundials-users] Forward sensitivities for initial conditions</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00445.html">Re: [sundials-users] Forward sensitivities for initial conditions+number of sensitivities</a></strong>
</li>

<li>Previous by thread:
<strong><a href="msg00443.html">Re: [sundials-users] Forward sensitivities for initial conditions</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00445.html">Re: [sundials-users] Forward sensitivities for initial conditions+number of sensitivities</a></strong>
</li>

<li>Index(es):
<ul>
<li><a href="maillist.html#00444">
<strong>Main</strong></a></li>
<li><a href="threads.html#00444">
<strong>Thread</strong></a></li>
</ul>
</li>
</ul>
</div>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<!-- End content for this page -->
  </div>
  </td>
  <td background="../../graphics/table_bck3.gif"></td>
  </tr>
  <tr valign="top">
  <td height="17" background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  <td width="116"><a HREF="http://www.llnl.gov/disclaimer.html" target="_top"><img SRC="../../graphics/line_bl.gif" height="17" width="116" border="0"></a></td>
  <td width="720"><img SRC="../../graphics/line_br.gif" height="17" width="720" border="0"></td>
  <td background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  </tr>
  </table>
</body>
</html>
