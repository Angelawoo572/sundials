<!-- MHonArc v2.6.10 -->
<!--X-Subject: [sundials&#45;users] [Pkg&#45;octave&#45;devel] Sundials -->
<!--X-From-R13: Dnsnry Znobvffvrer <ensnryNqrovna.bet> -->
<!--X-Date: Thu, 08 Jun 2006 16:17:39 &#45;0700 -->
<!--X-Message-Id: 20060608231525.GC28278@laboiss2 -->
<!--X-Content-Type: multipart/mixed -->
<!--X-Head-End-->
<html>
<head>
<title>[sundials-users] [Pkg-octave-devel] Sundials</title>
<meta name="author" content="Radu Serban">
<meta name="description" content="suite of nonlinear differential algebraic equation solvers">
<meta name="keywords" content="SUNDIALS, CVODE, CVODES, IDA, KINSOL">
<meta name="keywords" content="ODE, DAE, sensitivity">
<meta name="keywords" content="differential, algebraic">
<link REL="SHORTCUT ICON" HREF="img/favicon.ico" type="image/x-icon">
<link REL="ICON" HREF="img/favicon.ico" type="image/x-icon">
<link href="../../sundials_styles.css" rel="stylesheet" type="text/css">
<script language="JavaScript">
<!--
homeon = new Image();           homeon.src = "../../graphics/home_buttonH.png";
homeoff = new Image();          homeoff.src = "../../graphics/home_button.png";
descriptionon = new Image();    descriptionon.src = "../../graphics/description_buttonH.png";
descriptionoff = new Image();   descriptionoff.src = "../../graphics/description_button.png";
documentationon = new Image();  documentationon.src = "../../graphics/documentation_buttonH.png";
documentationoff = new Image(); documentationoff.src = "../../graphics/documentation_button.png";
downloadon = new Image();       downloadon.src = "../../graphics/download_buttonH.png";
downloadoff = new Image();      downloadoff.src = "../../graphics/download_button.png";
supporton = new Image();        supporton.src = "../../graphics/support_buttonH.png";
supportoff = new Image();       supportoff.src = "../../graphics/support_button.png";
//-->
</script>
<script src="../../sunjs.js" type="text/javascript" language="javascript1.2"></script>
</head>
<!-- ******************************************************************************** -->
<body>
<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
  <td height="60" background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  <td width="116"><img SRC="../../graphics/head_top_left.png" height="60" width="116" border="0"></td>
  <td width="720"><img SRC="../../graphics/head_mail_top_right.png" height="60" width="720" border="0"></td>
  <td background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  </tr>
  <tr valign="top">
  <td height="127" background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  <td width="116">
    <a href="../../main.html" onMouseOver="img_act('home'); return true;" onMouseOut="img_inact('home'); return true;"><img src="../../graphics/home_button.png" border="0" name="home"></a><br>
    <a href="../../description/description.html" onMouseOver="img_act('description'); return true;" onMouseOut="img_inact('description'); return true;"><img src="../../graphics/description_button.png" border="0" name="description"></a><br>
    <a href="../../documentation/documentation.html" onMouseOver="img_act('documentation'); return true;" onMouseOut="img_inact('documentation'); return true;"><img src="../../graphics/documentation_button.png" border="0" name="documentation"></a><br>
    <a href="../../download/download.html" onMouseOver="img_act('download'); return true;" onMouseOut="img_inact('download'); return true;"><img src="../../graphics/download_button.png" border="0" name="download"></a><br>
    <a href="../../support/support.html" onMouseOver="img_act('support'); return true;" onMouseOut="img_inact('support'); return true;"><img src="../../graphics/support_button.png" border="0" name="support"></a><br>
    <img SRC="../../graphics/line_tl.gif" height="7" width="116" border="0"></td>
  <td width="720">
      <img SRC="../../graphics/head_bottom_right.png" height="120" width="720" border="0"><br>
      <img SRC="../../graphics/line_tr.gif" height="7" width="720" border="0"></td>
  <td background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  </tr>
  <tr valign="top">
  <td background="../../graphics/table_bck3.gif"></td>
  <td width="116" valign="bottom" align="center" background="../../graphics/table_bck5.gif"><img SRC="../../graphics/logo.png" border="0"></td>
  <td width="720" bgcolor="#ffffff">
  <div id="content">   
<!-- Start content for this page -->
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<p class="links">
[<a href="msg00488.html">Date Prev</a>] [<a href="msg00490.html">Date Next</a>] [<a href="msg00486.html">Thread Prev</a>] [Thread Next]<br>
[<b><a href="maillist.html#00489">Date Index</a></b>]
[<b><a href="threads.html#00489">Thread Index</a></b>]
</p>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>[sundials-users] [Pkg-octave-devel] Sundials</h1>
<div class="frame">
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<table border=0 cellpadding=2 cellspacing=0>
<tr>
<td align="right"><b>
<em>From</em></b></td>
<td align="left">
Rafael Laboissiere &lt;<a href="mailto:rafael%40debian.org">rafael@debian.org</a>&gt;</td>
</tr>

<tr>
<td align="right"><b>
<em>Date</em></b></td>
<td align="left">
Fri, 9 Jun 2006 01:15:25 +0200</td>
</tr>

</table>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div>
<div class="container">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>Dear SUNDIALS developers,

First of all, let me introduce myself: I am a member of the Debian Octave
Group, which is currently maintaining the sundials package in Debian. I
am contacting you about a compilation issue that has been recently
raised.

The Debian project decided to switch to gcc-4.1 as the default version of
the GCC compiler [1].  Due to the more strict checks, many packages
generate warnings about casts from integer to pointer (and vice-versa)
with incompatible sizes.  The build logs can be found in [2] and the
sundials package (version 2.1.1-6) is listed there.

For sundials, the warnings appear all in file cvodea.c.  I checked the
sources for version 2.2.0 and noticed that the problematic code was moved
into file cvodea_io.c.  The problem comes from the fact that the
&quot;unsinged int&quot; type is not large enough to hold a pointer in 64-bit
architectures (e.g. alpha, amd64, and ia64).  One should instead use
intptr_t, defined in stdint.h, probably by doing conditional compilation
on HAVE_STDINT_H.

I prepared a patch for fixing the problem, which is attached below.  This
patch was successfully tested on both i386 and amd64 architectures with
stdint.h present.  It is slightly convoluted, because the topdir config.h
file need to be #include'd in cvodea.h.  This file is generated by
configure, but is not included by any other source file.

Best regards,

Rafael


[1] <a  href="http://lists.debian.org/debian-devel-announce/2006/06/msg00004.html">http://lists.debian.org/debian-devel-announce/2006/06/msg00004.html</a>
[2] <a  href="http://people.debian.org/~tbm/logs/pointer/">http://people.debian.org/~tbm/logs/pointer/</a>
</pre><pre>--- sundials-2.2.0.orig/cvodes/include/cvodea.h
+++ sundials-2.2.0/cvodes/include/cvodea.h
@@ -44,6 +44,13 @@
 #include &quot;cvodes.h&quot;
 #include &quot;sundials_nvector.h&quot;
 
+#include &quot;../../config.h&quot;
+#ifdef HAVE_STDINT_H
+#include &lt;stdint.h&gt;
+#else
+#define intptr_t unsigned int
+#endif
+
   /* 
    * ===============================================================
    * DEFINITIONS OF CVODEA INPUTS
--- sundials-2.2.0.orig/cvodes/source/cvodea_io.c
+++ sundials-2.2.0/cvodes/source/cvodea_io.c
@@ -422,8 +422,8 @@
 
   while (ck_mem != NULL) {
 
-    ckpnt[i].my_addr = (unsigned int) ck_mem;
-    ckpnt[i].next_addr = (unsigned int) next_;
+    ckpnt[i].my_addr = (intptr_t) ck_mem;
+    ckpnt[i].next_addr = (intptr_t) next_;
     ckpnt[i].t0 = t0_;
     ckpnt[i].t1 = t1_;
     ckpnt[i].nstep = nst_;
@@ -445,7 +445,7 @@
  *  Returns the address of the 'active' check point.
  */
 
-int CVadjGetCurrentCheckPoint(void *cvadj_mem, unsigned int *addr)
+int CVadjGetCurrentCheckPoint(void *cvadj_mem, intptr_t *addr)
 {
   CVadjMem ca_mem;
 
@@ -455,7 +455,7 @@
   }
   ca_mem = (CVadjMem) cvadj_mem;
 
-  *addr = (unsigned int) ckpntData;
+  *addr = (intptr_t) ckpntData;
 
   return(CV_SUCCESS);
 }
--- sundials-2.2.0.orig/kinsol/source/kinsol.c
+++ sundials-2.2.0/kinsol/source/kinsol.c
@@ -1737,7 +1737,7 @@
 
     /* If info_code = PRNT_RETVAL, decode the numeric value */
 
-    ret = (int) (va_arg(ap, int *));
+    ret = va_arg(ap, int);
 
     switch(ret) {
     case KIN_SUCCESS:
</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<div class="container">
<table width="95%" frame="below"><tr><td></td></table>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00488.html">Re: [sundials-users] Sundials installation...</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00490.html">Re: [sundials-users] The lighter side of SUNDIALS</a></strong>
</li>

<li>Previous by thread:
<strong><a href="msg00486.html">[sundials-users] The lighter side of SUNDIALS</a></strong>
</li>

<li>Index(es):
<ul>
<li><a href="maillist.html#00489">
<strong>Main</strong></a></li>
<li><a href="threads.html#00489">
<strong>Thread</strong></a></li>
</ul>
</li>
</ul>
</div>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<!-- End content for this page -->
  </div>
  </td>
  <td background="../../graphics/table_bck3.gif"></td>
  </tr>
  <tr valign="top">
  <td height="17" background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  <td width="116"><a HREF="http://www.llnl.gov/disclaimer.html" target="_top"><img SRC="../../graphics/line_bl.gif" height="17" width="116" border="0"></a></td>
  <td width="720"><img SRC="../../graphics/line_br.gif" height="17" width="720" border="0"></td>
  <td background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  </tr>
  </table>
</body>
</html>
