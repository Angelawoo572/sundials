<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: Scalar relative tolerance and vector absolute tolerance in CVODE -->
<!--X-From-R13: Oyna Vvaqznefu <nynauNyyay.tbi> -->
<!--X-Date: Tue, 19 Jul 2005 16:31:26 &#45;0700 (PDT) -->
<!--X-Message-Id: Pine.LNX.4.58.0507191615250.30906@tux64.llnl.gov -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 793D7D892DCFD441972F743EB40C9CE60A1665@icex3.ic.ac.uk -->
<!--X-Head-End-->
<html>
<head>
<title>Re: Scalar relative tolerance and vector absolute tolerance in CVODE</title>
<meta name="author" content="Radu Serban">
<meta name="description" content="suite of nonlinear differential algebraic equation solvers">
<meta name="keywords" content="SUNDIALS, CVODE, CVODES, IDA, KINSOL">
<meta name="keywords" content="ODE, DAE, sensitivity">
<meta name="keywords" content="differential, algebraic">
<link REL="SHORTCUT ICON" HREF="img/favicon.ico" type="image/x-icon">
<link REL="ICON" HREF="img/favicon.ico" type="image/x-icon">
<link href="../../sundials_styles.css" rel="stylesheet" type="text/css">
<script language="JavaScript">
<!--
homeon = new Image();           homeon.src = "../../graphics/home_buttonH.png";
homeoff = new Image();          homeoff.src = "../../graphics/home_button.png";
descriptionon = new Image();    descriptionon.src = "../../graphics/description_buttonH.png";
descriptionoff = new Image();   descriptionoff.src = "../../graphics/description_button.png";
documentationon = new Image();  documentationon.src = "../../graphics/documentation_buttonH.png";
documentationoff = new Image(); documentationoff.src = "../../graphics/documentation_button.png";
downloadon = new Image();       downloadon.src = "../../graphics/download_buttonH.png";
downloadoff = new Image();      downloadoff.src = "../../graphics/download_button.png";
supporton = new Image();        supporton.src = "../../graphics/support_buttonH.png";
supportoff = new Image();       supportoff.src = "../../graphics/support_button.png";
//-->
</script>
<script src="../../sunjs.js" type="text/javascript" language="javascript1.2"></script>
</head>
<!-- ******************************************************************************** -->
<body>
<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
  <td height="60" background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  <td width="116"><img SRC="../../graphics/head_top_left.png" height="60" width="116" border="0"></td>
  <td width="720"><img SRC="../../graphics/head_mail_top_right.png" height="60" width="720" border="0"></td>
  <td background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  </tr>
  <tr valign="top">
  <td height="127" background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  <td width="116">
    <a href="../../main.html" onMouseOver="img_act('home'); return true;" onMouseOut="img_inact('home'); return true;"><img src="../../graphics/home_button.png" border="0" name="home"></a><br>
    <a href="../../description/description.html" onMouseOver="img_act('description'); return true;" onMouseOut="img_inact('description'); return true;"><img src="../../graphics/description_button.png" border="0" name="description"></a><br>
    <a href="../../documentation/documentation.html" onMouseOver="img_act('documentation'); return true;" onMouseOut="img_inact('documentation'); return true;"><img src="../../graphics/documentation_button.png" border="0" name="documentation"></a><br>
    <a href="../../download/download.html" onMouseOver="img_act('download'); return true;" onMouseOut="img_inact('download'); return true;"><img src="../../graphics/download_button.png" border="0" name="download"></a><br>
    <a href="../../support/support.html" onMouseOver="img_act('support'); return true;" onMouseOut="img_inact('support'); return true;"><img src="../../graphics/support_button.png" border="0" name="support"></a><br>
    <img SRC="../../graphics/line_tl.gif" height="7" width="116" border="0"></td>
  <td width="720">
      <img SRC="../../graphics/head_bottom_right.png" height="120" width="720" border="0"><br>
      <img SRC="../../graphics/line_tr.gif" height="7" width="720" border="0"></td>
  <td background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  </tr>
  <tr valign="top">
  <td background="../../graphics/table_bck3.gif"></td>
  <td width="116" valign="bottom" align="center" background="../../graphics/table_bck5.gif"><img SRC="../../graphics/logo.png" border="0"></td>
  <td width="720" bgcolor="#ffffff">
  <div id="content">   
<!-- Start content for this page -->
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<p class="links">
[<a href="msg00093.html">Date Prev</a>] [<a href="msg00095.html">Date Next</a>] [<a href="msg00093.html">Thread Prev</a>] [<a href="msg00099.html">Thread Next</a>]<br>
[<b><a href="maillist.html#00094">Date Index</a></b>]
[<b><a href="threads.html#00094">Thread Index</a></b>]
</p>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: Scalar relative tolerance and vector absolute tolerance in CVODE</h1>
<div class="frame">
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<table border=0 cellpadding=2 cellspacing=0>
<tr>
<td align="right"><b>
<em>From</em></b></td>
<td align="left">
Alan Hindmarsh &lt;<a href="mailto:alanh%40llnl.gov">alanh@llnl.gov</a>&gt;</td>
</tr>

<tr>
<td align="right"><b>
<em>Date</em></b></td>
<td align="left">
Tue, 19 Jul 2005 16:16:18 -0700 (PDT)</td>
</tr>

</table>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div>
<div class="container">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>
Hello Rhodri Nelson,

The scalar relative tolerance RELTOL is to be set to control relative
errors.  So RELTOL = 1.0e-4 means error is controlled to .01%.

The absolute tolerances ABSTOL (whether scalar or vector) need to be set to
control absolute errors when any components of y may be so small that
pure relative error control is meaningless.  For example, if y_1 starts
at about 1, but in time decays to zero, then pure relative error control
on y_1 makes no sense (and is overly costly) after y_1 is below some
noise level.  Then ABSTOL (if scalar) or ABSTOL[1] (if a vector) needs to
be set to that noise level.  If the different components have different
noise levels, then ABSTOL should be a vector.  See the example cvdx in the
CVODE package, and the discussion of it in the CVODE Examples document.
There the three components vary betwen 0 and 1, and have different
noise levels; hence the ABSTOL vector.

Finally, it is important to pick all the tolerance values conservately,
because they control the error committed on each individual time step.
The final (global) error may be some sort of accumulation of those
per-step errors.  A good rule of thumb is to reduce the tolerances by a
factor of .01 from the actual desired limits on errors.  So if you
really want .01% accuracy (globally), best set RELTOL = 1.0e-6.

Other than that, it is hard to give any general advice, especially
about the absolute tolerances, because the appropriate values depend
on what the noise levels are.  As the modeler, you probably know that
better than anyone else.  But some experimentation may be needed
to see how global errors vary with tolerances.

I hope this helps.

-Alan


On Tue, 19 Jul 2005, Nelson, Rhodri wrote:

&gt;<i></i>
&gt;<i> Dear Dr. Hindmarsh,</i>
&gt;<i></i>
&gt;<i> I am an currently studying an MSc in Mathematics at Imperial College and am </i>
&gt;<i> using the CVODE package in my project. But I do not quite understand the </i>
&gt;<i> scalar relative tolerance and vector absolute tolerance components and how to </i>
&gt;<i> calculate there value for specific cases. I was wondering if it would be </i>
&gt;<i> possible for you to point me towards and explanation of these parameters and </i>
&gt;<i> how they should be set for a specific system of equations.</i>
&gt;<i></i>
&gt;<i> Many thanks,</i>
&gt;<i> Rhodri Nelson</i>
&gt;<i></i>

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<div class="container">
<table width="95%" frame="below"><tr><td></td></table>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00093.html">Scalar relative tolerance and vector absolute tolerance in CVODE (fwd)</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00095.html">Re: CVODE with Delphi</a></strong>
</li>

<li>Previous by thread:
<strong><a href="msg00093.html">Scalar relative tolerance and vector absolute tolerance in CVODE (fwd)</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00099.html">odepack-&gt;cvode(s)</a></strong>
</li>

<li>Index(es):
<ul>
<li><a href="maillist.html#00094">
<strong>Main</strong></a></li>
<li><a href="threads.html#00094">
<strong>Thread</strong></a></li>
</ul>
</li>
</ul>
</div>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<!-- End content for this page -->
  </div>
  </td>
  <td background="../../graphics/table_bck3.gif"></td>
  </tr>
  <tr valign="top">
  <td height="17" background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  <td width="116"><a HREF="http://www.llnl.gov/disclaimer.html" target="_top"><img SRC="../../graphics/line_bl.gif" height="17" width="116" border="0"></a></td>
  <td width="720"><img SRC="../../graphics/line_br.gif" height="17" width="720" border="0"></td>
  <td background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  </tr>
  </table>
</body>
</html>
