<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: [sundials&#45;users] Offline Manipulation of y values -->
<!--X-From-R13: Dnqh Ereona <freona1Nyyay.tbi> -->
<!--X-Date: Tue, 21 Mar 2006 15:30:33 &#45;0800 (PST) -->
<!--X-Message-Id: 44208BDA.6010905@llnl.gov -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 20060316041330.92829.qmail@web37013.mail.mud.yahoo.com -->
<!--X-Reference: 200603171410.38296.andrey@enginum.com -->
<!--X-Reference: 44202541.6050205@llnl.gov -->
<!--X-Reference: 200603212301.49442.andrey@enginum.com -->
<!--X-Head-End-->
<html>
<head>
<title>Re: [sundials-users] Offline Manipulation of y values</title>
<meta name="author" content="Radu Serban">
<meta name="description" content="suite of nonlinear differential algebraic equation solvers">
<meta name="keywords" content="SUNDIALS, CVODE, CVODES, IDA, KINSOL">
<meta name="keywords" content="ODE, DAE, sensitivity">
<meta name="keywords" content="differential, algebraic">
<link REL="SHORTCUT ICON" HREF="img/favicon.ico" type="image/x-icon">
<link REL="ICON" HREF="img/favicon.ico" type="image/x-icon">
<link href="../../sundials_styles.css" rel="stylesheet" type="text/css">
<script language="JavaScript">
<!--
homeon = new Image();           homeon.src = "../../graphics/home_buttonH.png";
homeoff = new Image();          homeoff.src = "../../graphics/home_button.png";
descriptionon = new Image();    descriptionon.src = "../../graphics/description_buttonH.png";
descriptionoff = new Image();   descriptionoff.src = "../../graphics/description_button.png";
documentationon = new Image();  documentationon.src = "../../graphics/documentation_buttonH.png";
documentationoff = new Image(); documentationoff.src = "../../graphics/documentation_button.png";
downloadon = new Image();       downloadon.src = "../../graphics/download_buttonH.png";
downloadoff = new Image();      downloadoff.src = "../../graphics/download_button.png";
supporton = new Image();        supporton.src = "../../graphics/support_buttonH.png";
supportoff = new Image();       supportoff.src = "../../graphics/support_button.png";
//-->
</script>
<script src="../../sunjs.js" type="text/javascript" language="javascript1.2"></script>
</head>
<!-- ******************************************************************************** -->
<body>
<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
  <td height="60" background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  <td width="116"><img SRC="../../graphics/head_top_left.png" height="60" width="116" border="0"></td>
  <td width="720"><img SRC="../../graphics/head_mail_top_right.png" height="60" width="720" border="0"></td>
  <td background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  </tr>
  <tr valign="top">
  <td height="127" background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  <td width="116">
    <a href="../../main.html" onMouseOver="img_act('home'); return true;" onMouseOut="img_inact('home'); return true;"><img src="../../graphics/home_button.png" border="0" name="home"></a><br>
    <a href="../../description/description.html" onMouseOver="img_act('description'); return true;" onMouseOut="img_inact('description'); return true;"><img src="../../graphics/description_button.png" border="0" name="description"></a><br>
    <a href="../../documentation/documentation.html" onMouseOver="img_act('documentation'); return true;" onMouseOut="img_inact('documentation'); return true;"><img src="../../graphics/documentation_button.png" border="0" name="documentation"></a><br>
    <a href="../../download/download.html" onMouseOver="img_act('download'); return true;" onMouseOut="img_inact('download'); return true;"><img src="../../graphics/download_button.png" border="0" name="download"></a><br>
    <a href="../../support/support.html" onMouseOver="img_act('support'); return true;" onMouseOut="img_inact('support'); return true;"><img src="../../graphics/support_button.png" border="0" name="support"></a><br>
    <img SRC="../../graphics/line_tl.gif" height="7" width="116" border="0"></td>
  <td width="720">
      <img SRC="../../graphics/head_bottom_right.png" height="120" width="720" border="0"><br>
      <img SRC="../../graphics/line_tr.gif" height="7" width="720" border="0"></td>
  <td background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  </tr>
  <tr valign="top">
  <td background="../../graphics/table_bck3.gif"></td>
  <td width="116" valign="bottom" align="center" background="../../graphics/table_bck5.gif"><img SRC="../../graphics/logo.png" border="0"></td>
  <td width="720" bgcolor="#ffffff">
  <div id="content">   
<!-- Start content for this page -->
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<p class="links">
[<a href="msg00389.html">Date Prev</a>] [Date Next] [<a href="msg00389.html">Thread Prev</a>] [<a href="msg00382.html">Thread Next</a>]<br>
[<b><a href="maillist.html#00390">Date Index</a></b>]
[<b><a href="threads.html#00390">Thread Index</a></b>]
</p>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [sundials-users] Offline Manipulation of y values</h1>
<div class="frame">
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<table border=0 cellpadding=2 cellspacing=0>
<tr>
<td align="right"><b>
<em>From</em></b></td>
<td align="left">
Radu Serban &lt;<a href="mailto:serban1%40llnl.gov">serban1@llnl.gov</a>&gt;</td>
</tr>

<tr>
<td align="right"><b>
<em>Date</em></b></td>
<td align="left">
Tue, 21 Mar 2006 15:27:22 -0800</td>
</tr>

</table>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div>
<div class="container">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
Andrey Romanenko wrote:
<blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">Hi!</pre><br>
<pre style="margin: 0em;">On Tuesday 21 March 2006 16:09, Radu Serban wrote:</pre><br>
<br>
<blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">What exactly do you mean by a lighter version of CVodeReInit? CVodeReInit
does not do a lot of computation in itself (a few input error checks, a
vector copy to load the initial conditions, and, possibly, a vector copy to
load the absolute tolerances). What I meant by my comment was that
reinitialization adds to the computational expense, no matter how
lightweight the reinitialization function itself is, the reason being that
the method order and step size MUST be reset when reinitializing the
problem.
</pre></blockquote><pre style="margin: 0em;"><br></pre><br>
Thank you very much for the explanation. Guess I was not very clear. What I 
was wondering was whether it would be possible to somehow &quot;warm start&quot; the 
solver exploiting the fact that it is used in the context of multiple 
shooting and to taylor it for this particular use. <br>
<br>
Obviously, the computational burden of the reinitialization function itself is 
negligible when compared to that of the &quot;cold started&quot; method.
</blockquote><br>Well, you do have to pay a price for the added robustness of the multiple shooting over single shooting :-) and that means a larger 
optimization problem plus the cost of restarting the integrator at the interfaces between shooting intervals.<br>
<br>
I cannot think how you could exploit the fact that you are solving the same ODE over the different shooting intervals. As long as you have a 
discontinuity in the solution (which you do) the solver MUST be restarted (See my lengthier post of a couple of weeks ago on this issue. 
Also, on the new SUNDIALS website which will be up at the same time with the next release, I will provide more information on this issue in 
a FAQ and some Usage Notes).<br>
<br>
Moreover, even if you come up with a way of avoiding restarts in the context of multiple shooting (which, as I mentioned before, I doubt is 
even possible) that would probably be not a general enough case to warrant adding it to CVODES.<br>
<br>
<blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">In multiple shooting, you have to reinitialize the problem as you have a
discontinuity in your solution vector (see my previous post).
</pre></blockquote><pre style="margin: 0em;"><br></pre><br>
Yes, that is what I do and I am glad to report that CVODES works very well, 
including the sensitivity analysis feature. Thanks a lot!
</blockquote><pre style="margin: 0em;"><br>Glad to hear that.</pre><br>
<blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">P.S. I'd be curious to hear more about your multiple shooting code based on
CVODES. Before joining LLNL, I wrote a couple of optimal control codes
using direct multiple shooting (cooptFM and cooptAM, based on DASPK3.0)
</pre></blockquote><pre style="margin: 0em;"><br></pre><br>
I'll send you more info on this off-list as it may be offtopic here :)
</blockquote><pre style="margin: 0em;"><br>Thanks.</pre><br>
<blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">Andrey</pre><br>
</blockquote><pre style="margin: 0em;"><br>--Radu</pre><br>
<pre style="margin: 0em;">--
   Radu Serban
   Center for Applied Scientific Computing   [email] radu@llnl.gov
   Lawrence Livermore National Laboratory    [phone] 925-424-4852
   P.O. Box 808, L-560                       [fax]   925-422-6287
   Livermore, CA 94551</pre><br>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<div class="container">
<table width="95%" frame="below"><tr><td></td></table>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00376" href="msg00376.html">[sundials-users] Offline Manipulation of y values</a></strong>
<ul><li><em>From:</em> raj duffy &lt;raj_duffy@yahoo.com&gt;</li></ul></li>
<li><strong><a name="00381" href="msg00381.html">Re: [sundials-users] Offline Manipulation of y values</a></strong>
<ul><li><em>From:</em> Andrey Romanenko &lt;andrey@enginum.com&gt;</li></ul></li>
<li><strong><a name="00385" href="msg00385.html">Re: [sundials-users] Offline Manipulation of y values</a></strong>
<ul><li><em>From:</em> Radu Serban &lt;serban1@llnl.gov&gt;</li></ul></li>
<li><strong><a name="00389" href="msg00389.html">Re: [sundials-users] Offline Manipulation of y values</a></strong>
<ul><li><em>From:</em> Andrey Romanenko &lt;andrey@enginum.com&gt;</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00389.html">Re: [sundials-users] Offline Manipulation of y values</a></strong>
</li>

<li>Previous by thread:
<strong><a href="msg00389.html">Re: [sundials-users] Offline Manipulation of y values</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00382.html">[sundials-users] memory leaks</a></strong>
</li>

<li>Index(es):
<ul>
<li><a href="maillist.html#00390">
<strong>Main</strong></a></li>
<li><a href="threads.html#00390">
<strong>Thread</strong></a></li>
</ul>
</li>
</ul>
</div>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<!-- End content for this page -->
  </div>
  </td>
  <td background="../../graphics/table_bck3.gif"></td>
  </tr>
  <tr valign="top">
  <td height="17" background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  <td width="116"><a HREF="http://www.llnl.gov/disclaimer.html" target="_top"><img SRC="../../graphics/line_bl.gif" height="17" width="116" border="0"></a></td>
  <td width="720"><img SRC="../../graphics/line_br.gif" height="17" width="720" border="0"></td>
  <td background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  </tr>
  </table>
</body>
</html>
