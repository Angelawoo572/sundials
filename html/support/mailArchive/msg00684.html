<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: [sundials&#45;users] Problem with IDACalcIC in IDA solver -->
<!--X-From-R13: Dnqh Ereona <enqhNyyay.tbi> -->
<!--X-Date: Fri, 15 Sep 2006 08:55:50 &#45;0700 -->
<!--X-Message-Id: 450ACD10.6070600@llnl.gov -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: c600b5b40609082151q7d634b08jf8a6318cbbdb6126@mail.gmail.com -->
<!--X-Reference: 48445.86.56.0.53.1158171127.squirrel@86.56.0.53 -->
<!--X-Reference: c600b5b40609140147u25bac79cs83b869078f43aaa9@mail.gmail.com -->
<!--X-Head-End-->
<html>
<head>
<title>Re: [sundials-users] Problem with IDACalcIC in IDA solver</title>
<meta name="author" content="Radu Serban">
<meta name="description" content="suite of nonlinear differential algebraic equation solvers">
<meta name="keywords" content="SUNDIALS, CVODE, CVODES, IDA, KINSOL">
<meta name="keywords" content="ODE, DAE, sensitivity">
<meta name="keywords" content="differential, algebraic">
<link REL="SHORTCUT ICON" HREF="img/favicon.ico" type="image/x-icon">
<link REL="ICON" HREF="img/favicon.ico" type="image/x-icon">
<link href="../../sundials_styles.css" rel="stylesheet" type="text/css">
<script language="JavaScript">
<!--
homeon = new Image();           homeon.src = "../../graphics/home_buttonH.png";
homeoff = new Image();          homeoff.src = "../../graphics/home_button.png";
descriptionon = new Image();    descriptionon.src = "../../graphics/description_buttonH.png";
descriptionoff = new Image();   descriptionoff.src = "../../graphics/description_button.png";
documentationon = new Image();  documentationon.src = "../../graphics/documentation_buttonH.png";
documentationoff = new Image(); documentationoff.src = "../../graphics/documentation_button.png";
downloadon = new Image();       downloadon.src = "../../graphics/download_buttonH.png";
downloadoff = new Image();      downloadoff.src = "../../graphics/download_button.png";
supporton = new Image();        supporton.src = "../../graphics/support_buttonH.png";
supportoff = new Image();       supportoff.src = "../../graphics/support_button.png";
//-->
</script>
<script src="../../sunjs.js" type="text/javascript" language="javascript1.2"></script>
</head>
<!-- ******************************************************************************** -->
<body>
<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
  <td height="60" background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  <td width="116"><img SRC="../../graphics/head_top_left.png" height="60" width="116" border="0"></td>
  <td width="720"><img SRC="../../graphics/head_mail_top_right.png" height="60" width="720" border="0"></td>
  <td background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  </tr>
  <tr valign="top">
  <td height="127" background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  <td width="116">
    <a href="../../main.html" onMouseOver="img_act('home'); return true;" onMouseOut="img_inact('home'); return true;"><img src="../../graphics/home_button.png" border="0" name="home"></a><br>
    <a href="../../description/description.html" onMouseOver="img_act('description'); return true;" onMouseOut="img_inact('description'); return true;"><img src="../../graphics/description_button.png" border="0" name="description"></a><br>
    <a href="../../documentation/documentation.html" onMouseOver="img_act('documentation'); return true;" onMouseOut="img_inact('documentation'); return true;"><img src="../../graphics/documentation_button.png" border="0" name="documentation"></a><br>
    <a href="../../download/download.html" onMouseOver="img_act('download'); return true;" onMouseOut="img_inact('download'); return true;"><img src="../../graphics/download_button.png" border="0" name="download"></a><br>
    <a href="../../support/support.html" onMouseOver="img_act('support'); return true;" onMouseOut="img_inact('support'); return true;"><img src="../../graphics/support_button.png" border="0" name="support"></a><br>
    <img SRC="../../graphics/line_tl.gif" height="7" width="116" border="0"></td>
  <td width="720">
      <img SRC="../../graphics/head_bottom_right.png" height="120" width="720" border="0"><br>
      <img SRC="../../graphics/line_tr.gif" height="7" width="720" border="0"></td>
  <td background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  </tr>
  <tr valign="top">
  <td background="../../graphics/table_bck3.gif"></td>
  <td width="116" valign="bottom" align="center" background="../../graphics/table_bck5.gif"><img SRC="../../graphics/logo.png" border="0"></td>
  <td width="720" bgcolor="#ffffff">
  <div id="content">   
<!-- Start content for this page -->
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<p class="links">
[<a href="msg00683.html">Date Prev</a>] [<a href="msg00685.html">Date Next</a>] [<a href="msg00677.html">Thread Prev</a>] [<a href="msg00689.html">Thread Next</a>]<br>
[<b><a href="maillist.html#00684">Date Index</a></b>]
[<b><a href="threads.html#00684">Thread Index</a></b>]
</p>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [sundials-users] Problem with IDACalcIC in IDA solver</h1>
<div class="frame">
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<table border=0 cellpadding=2 cellspacing=0>
<tr>
<td align="right"><b>
<em>From</em></b></td>
<td align="left">
Radu Serban &lt;<a href="mailto:radu%40llnl.gov">radu@llnl.gov</a>&gt;</td>
</tr>

<tr>
<td align="right"><b>
<em>Date</em></b></td>
<td align="left">
Fri, 15 Sep 2006 08:56:00 -0700</td>
</tr>

</table>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div>
<div class="container">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
The bug mentioned by Jens had to do with the internal DQ Jacobian calculation. 
However, you seem to use your own dense Jacobian function (since you call 
IDADenseSetJacFn), so applying the patch may not solve your problem.<br>
<br>
First of all, you need to make sure that the user-supplied functions (Jacobian 
and rhs) return a value of 0 if successful. Secondly, you'll need to find out 
which function exactly failed, as the flag  IDA_NO_RECOVERY (-19) does not 
differentiate between several possibilities. Could you add a print statement in 
both the rhs and Jacobian functions and see which is the last one to be called 
before the error?<br>
<br>
<pre style="margin: 0em;">--Radu</pre><br>
Vinayak Kumar wrote:
<blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em">Thank you, Jens. I will make the changes and try to get the solution of 
the problem.<br>
<br>
<pre style="margin: 0em;">Vinayak</pre><br>
On 9/13/06, *Jens Bastian* &lt; Jens.Bastian@eas.iis.fraunhofer.de 
&lt;<a  href="mailto:Jens.Bastian@eas.iis.fraunhofer.de">mailto:Jens.Bastian@eas.iis.fraunhofer.de</a>&gt;&gt; wrote:<br>
<br>
<pre style="margin: 0em;">    Hi Vinayak,</pre><br>
<pre style="margin: 0em;">    this sounds to me like the problems I encountered a few months ago.</pre><br>
<pre style="margin: 0em;">    Have you applied the patch described in
    <a  href="http://www.llnl.gov/casc/sundials/support/mailArchive/msg00461.html">http://www.llnl.gov/casc/sundials/support/mailArchive/msg00461.html</a>
    ?</pre><br>
<pre style="margin: 0em;">    Change the line
        inc = srur*MAX(ABS(yj),MAX( ABS(hh*ypj), ONE/ewt_data[j]));
    in ida_dense.c into
        inc = MAX(srur*(ABS(yj), ABS(hh*ypj)), ONE/ewt_data[j]);</pre><br>
<pre style="margin: 0em;">    Perhaps this solves your problems.</pre><br>
<pre style="margin: 0em;">    Best regards + HTH
    Jens</pre><br>
<pre style="margin: 0em;">    Vinayak Kumar sagte:
     &gt; Hi All,
     &gt;
     &gt; I am trying to solve an electrical circuit having 33 DAEs. But I
    am not
     &gt; able
     &gt; to initialize the variables and their derivatives becuase
    IDACalcIC() is
     &gt; not
     &gt; working. I am using IDACreate(), IDAMalloc(), IDADense() and
     &gt; IDADenseSetJacFn() before using IDACalcIC(). After that I am using
     &gt; IDASolve() to solve the DAEs.
     &gt;
     &gt; I am getting the following error.
     &gt;
     &gt; IDACalcIC-- The residual routine or the linear setup or solve
    routine had
     &gt; a
     &gt; recoverable error, but IDACalcIC was unable to recover.
     &gt;
     &gt;
     &gt; SUNDIALS_ERROR: IDACalcIC() failed with flag = -19
     &gt;
     &gt;
     &gt; Please advise me something on it. It's very important
     &gt;
     &gt;
     &gt; Thanks,
     &gt;
     &gt; Vinayak
     &gt;</pre><br>
<pre style="margin: 0em;"><br></pre><br>
<br>
</blockquote><pre style="margin: 0em;"><br></pre><br>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<div class="container">
<table width="95%" frame="below"><tr><td></td></table>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00658" href="msg00658.html">[sundials-users] Problem with IDACalcIC in IDA solver</a></strong>
<ul><li><em>From:</em> &quot;Vinayak Kumar&quot; &lt;vinayak.kumar@gmail.com&gt;</li></ul></li>
<li><strong><a name="00668" href="msg00668.html">Re: [sundials-users] Problem with IDACalcIC in IDA solver</a></strong>
<ul><li><em>From:</em> &quot;Jens Bastian&quot; &lt;Jens.Bastian@eas.iis.fraunhofer.de&gt;</li></ul></li>
<li><strong><a name="00677" href="msg00677.html">Re: [sundials-users] Problem with IDACalcIC in IDA solver</a></strong>
<ul><li><em>From:</em> &quot;Vinayak Kumar&quot; &lt;vinayak.kumar@gmail.com&gt;</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00683.html">Re: [sundials-users] Performance of CVODE similar to Matlab ode. How to improve?</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00685.html">Re: [sundials-users] Maximum order of 12 in the non-stiff IVP is not reached!</a></strong>
</li>

<li>Previous by thread:
<strong><a href="msg00677.html">Re: [sundials-users] Problem with IDACalcIC in IDA solver</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00689.html">Re: [sundials-users] Problem with IDACalcIC in IDA solver</a></strong>
</li>

<li>Index(es):
<ul>
<li><a href="maillist.html#00684">
<strong>Main</strong></a></li>
<li><a href="threads.html#00684">
<strong>Thread</strong></a></li>
</ul>
</li>
</ul>
</div>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<!-- End content for this page -->
  </div>
  </td>
  <td background="../../graphics/table_bck3.gif"></td>
  </tr>
  <tr valign="top">
  <td height="17" background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  <td width="116"><a HREF="http://www.llnl.gov/disclaimer.html" target="_top"><img SRC="../../graphics/line_bl.gif" height="17" width="116" border="0"></a></td>
  <td width="720"><img SRC="../../graphics/line_br.gif" height="17" width="720" border="0"></td>
  <td background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  </tr>
  </table>
</body>
</html>
