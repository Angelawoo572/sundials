<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: [sundials&#45;users] custom linear solvers for cvodes, and ida -->
<!--X-From-R13: Dnqh Ereona <enqhNyyay.tbi> -->
<!--X-Date: Tue, 18 Jul 2006 17:41:00 &#45;0700 -->
<!--X-Message-Id: 44BD7D9F.3010001@llnl.gov -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 44B6786F.5050906@mit.edu -->
<!--X-Reference: 44BC0C4E.6040603@llnl.gov -->
<!--X-Reference: 20060718170219.230zrhhoys8g0w8o@www.bu.edu -->
<!--X-Head-End-->
<html>
<head>
<title>Re: [sundials-users] custom linear solvers for cvodes, and ida</title>
<meta name="author" content="Radu Serban">
<meta name="description" content="suite of nonlinear differential algebraic equation solvers">
<meta name="keywords" content="SUNDIALS, CVODE, CVODES, IDA, KINSOL">
<meta name="keywords" content="ODE, DAE, sensitivity">
<meta name="keywords" content="differential, algebraic">
<link REL="SHORTCUT ICON" HREF="img/favicon.ico" type="image/x-icon">
<link REL="ICON" HREF="img/favicon.ico" type="image/x-icon">
<link href="../../sundials_styles.css" rel="stylesheet" type="text/css">
<script language="JavaScript">
<!--
homeon = new Image();           homeon.src = "../../graphics/home_buttonH.png";
homeoff = new Image();          homeoff.src = "../../graphics/home_button.png";
descriptionon = new Image();    descriptionon.src = "../../graphics/description_buttonH.png";
descriptionoff = new Image();   descriptionoff.src = "../../graphics/description_button.png";
documentationon = new Image();  documentationon.src = "../../graphics/documentation_buttonH.png";
documentationoff = new Image(); documentationoff.src = "../../graphics/documentation_button.png";
downloadon = new Image();       downloadon.src = "../../graphics/download_buttonH.png";
downloadoff = new Image();      downloadoff.src = "../../graphics/download_button.png";
supporton = new Image();        supporton.src = "../../graphics/support_buttonH.png";
supportoff = new Image();       supportoff.src = "../../graphics/support_button.png";
//-->
</script>
<script src="../../sunjs.js" type="text/javascript" language="javascript1.2"></script>
</head>
<!-- ******************************************************************************** -->
<body>
<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
  <td height="60" background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  <td width="116"><img SRC="../../graphics/head_top_left.png" height="60" width="116" border="0"></td>
  <td width="720"><img SRC="../../graphics/head_mail_top_right.png" height="60" width="720" border="0"></td>
  <td background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  </tr>
  <tr valign="top">
  <td height="127" background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  <td width="116">
    <a href="../../main.html" onMouseOver="img_act('home'); return true;" onMouseOut="img_inact('home'); return true;"><img src="../../graphics/home_button.png" border="0" name="home"></a><br>
    <a href="../../description/description.html" onMouseOver="img_act('description'); return true;" onMouseOut="img_inact('description'); return true;"><img src="../../graphics/description_button.png" border="0" name="description"></a><br>
    <a href="../../documentation/documentation.html" onMouseOver="img_act('documentation'); return true;" onMouseOut="img_inact('documentation'); return true;"><img src="../../graphics/documentation_button.png" border="0" name="documentation"></a><br>
    <a href="../../download/download.html" onMouseOver="img_act('download'); return true;" onMouseOut="img_inact('download'); return true;"><img src="../../graphics/download_button.png" border="0" name="download"></a><br>
    <a href="../../support/support.html" onMouseOver="img_act('support'); return true;" onMouseOut="img_inact('support'); return true;"><img src="../../graphics/support_button.png" border="0" name="support"></a><br>
    <img SRC="../../graphics/line_tl.gif" height="7" width="116" border="0"></td>
  <td width="720">
      <img SRC="../../graphics/head_bottom_right.png" height="120" width="720" border="0"><br>
      <img SRC="../../graphics/line_tr.gif" height="7" width="720" border="0"></td>
  <td background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  </tr>
  <tr valign="top">
  <td background="../../graphics/table_bck3.gif"></td>
  <td width="116" valign="bottom" align="center" background="../../graphics/table_bck5.gif"><img SRC="../../graphics/logo.png" border="0"></td>
  <td width="720" bgcolor="#ffffff">
  <div id="content">   
<!-- Start content for this page -->
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<p class="links">
[<a href="msg00583.html">Date Prev</a>] [<a href="msg00585.html">Date Next</a>] [<a href="msg00586.html">Thread Prev</a>] [<a href="msg00587.html">Thread Next</a>]<br>
[<b><a href="maillist.html#00584">Date Index</a></b>]
[<b><a href="threads.html#00584">Thread Index</a></b>]
</p>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [sundials-users] custom linear solvers for cvodes, and ida</h1>
<div class="frame">
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<table border=0 cellpadding=2 cellspacing=0>
<tr>
<td align="right"><b>
<em>From</em></b></td>
<td align="left">
Radu Serban &lt;<a href="mailto:radu%40llnl.gov">radu@llnl.gov</a>&gt;</td>
</tr>

<tr>
<td align="right"><b>
<em>Date</em></b></td>
<td align="left">
Tue, 18 Jul 2006 17:32:31 -0700</td>
</tr>

</table>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div>
<div class="container">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">ZXD (?),</pre><br>
<pre style="margin: 0em;">I know where such systems appear (hence the use of 'position' and 'velocity' in 
my previous reply).</pre><br>
Anyway, I think you rush a bit in stating that the advantages are &quot;obvious&quot; (even putting aside the generality issue I raised before). 
Indeed, you need to remember that, when solving such problems with one of the SUNDIALS solvers (which work on first order DEs), the problem 
size will still be 2n (in your notation). In other words, the linear solver still needs to return a 2n-dimensional vector as the solution.<br>
<br>
Granted, when using a dense linear solver, this can be done in 2 stages, first trivially obtaining the velocity components solving and then 
solving an n x n system for the position components. This will certainly save memory and efficiency. One could easily modify SUNDIALS's 
dense linear solver to do this, but this will imply an implicit assumption on which variables are 'positions' and which are 'velocities' 
(which is the reason why we will probably not provide such a solver within SUNDIALS).<br>
<br>
However, for the iterative linear solvers all the Jacobian-related information that the linear solver requires is in the form of 
matrix-vector products (with a 2n x 2n matrix and 2n-dimensional vector!) which the user can very easily implement such that it takes into 
account the identity blocks in the Jacobian. Yes, of course, one could make it a little bit more efficient by the same staggered approach as 
for the dense case, but we're only talking now about vector operations (scaling, sum, etc). Moreover, one would have to think twice before 
doing this with an iterative linear solver, as one would need to rethink the stopping criteria for the linear solver (which is related to 
that of the Newton solver for a 2n dimensional nonlinear system). This would now require variable type information outside the linear solver 
itself!<br>
<br>
<pre style="margin: 0em;">--Radu</pre><br>
zxd@bu.edu wrote:
<blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">This is may be specific but it is also very general for a
variety of problems. e.g. for many mechanical system
(each component may be specified by p,v).</pre><br>
In this case, in stead of problem of 2n x 2n, it only need solve the 
problem with n x n size, both for direct linear solver and iterative 
linear solver, so the advantage is obvious.<br>
<br>
This is because the Jac Matrix is very structured:<br>
If this system can be described as Ay'' + By' +Cy = 0.<br>
The Jac matrix for u' and u (u = [p, v] is [I, O; O A], [O I; C B] 
separately. And it is easily to cut the problem size in half.<br>
<br>
<br>
<blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em">Xuedong,<br>
Such a linear solver would require knowledge of the 'type' of variable 
('position' or 'velocity') which is not required otherwise and would<br>
conflict with one of the design principles for the SUNDIALS solvers 
(namely that the solvers are data-independent). Of course, you can write<br>
your own linear solver and interface it to any of the SUNDIALS 
solvers. When using a dense Jacobian, a linear solver like the one you<br>
suggest, would certainly save memory but probably not a whole lot in 
terms of efficiency. For an iterative linear solver I do not see any<br>
advantages.<br>
--Radu<br>
<br>
<pre style="margin: 0em;">--
    Radu Serban
    Center for Applied Scientific Computing   [email] radu@llnl.gov
    Lawrence Livermore National Laboratory    [phone] 925-424-4852
    P.O. Box 808, L-560                       [fax]   925-422-6287
    Livermore, CA 94551</pre><br>
</blockquote><pre style="margin: 0em;"><br></pre><br>
<br>
</blockquote><pre style="margin: 0em;"><br></pre><br>
<pre style="margin: 0em;">--
   Radu Serban
   Center for Applied Scientific Computing   [email] radu@llnl.gov
   Lawrence Livermore National Laboratory    [phone] 925-424-4852
   P.O. Box 808, L-560                       [fax]   925-422-6287
   Livermore, CA 94551</pre><br>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<div class="container">
<table width="95%" frame="below"><tr><td></td></table>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00587" href="msg00587.html">[sundials-users] Question about uinsg sundials for problem will ill-conditinoed Jacobian Matrix</a></strong>
<ul><li><em>From:</em> Xuedong Zhang &lt;zxd@bu.edu&gt;</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00575" href="msg00575.html">[sundials-users] custom linear solvers for cvodes, and ida</a></strong>
<ul><li><em>From:</em> Xuedong Zhang &lt;zxd@MIT.EDU&gt;</li></ul></li>
<li><strong><a name="00578" href="msg00578.html">Re: [sundials-users] custom linear solvers for cvodes, and ida</a></strong>
<ul><li><em>From:</em> Radu Serban &lt;radu@llnl.gov&gt;</li></ul></li>
<li><strong><a name="00582" href="msg00582.html">Re: [sundials-users] custom linear solvers for cvodes, and ida</a></strong>
<ul><li><em>From:</em> zxd@bu.edu</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00583.html">Re: [sundials-users] custom linear solvers for cvodes, and ida</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00585.html">Re: [sundials-users] Problems with IDACalcIC()</a></strong>
</li>

<li>Previous by thread:
<strong><a href="msg00586.html">Re: [sundials-users] custom linear solvers for cvodes, and ida</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00587.html">[sundials-users] Question about uinsg sundials for problem will ill-conditinoed Jacobian Matrix</a></strong>
</li>

<li>Index(es):
<ul>
<li><a href="maillist.html#00584">
<strong>Main</strong></a></li>
<li><a href="threads.html#00584">
<strong>Thread</strong></a></li>
</ul>
</li>
</ul>
</div>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<!-- End content for this page -->
  </div>
  </td>
  <td background="../../graphics/table_bck3.gif"></td>
  </tr>
  <tr valign="top">
  <td height="17" background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  <td width="116"><a HREF="http://www.llnl.gov/disclaimer.html" target="_top"><img SRC="../../graphics/line_bl.gif" height="17" width="116" border="0"></a></td>
  <td width="720"><img SRC="../../graphics/line_br.gif" height="17" width="720" border="0"></td>
  <td background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  </tr>
  </table>
</body>
</html>
