<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: [sundials&#45;users] multiple calls to CVODE in a single program -->
<!--X-From-R13: Oyna Vvaqznefu <nynauNyyay.tbi> -->
<!--X-Date: Wed, 22 Nov 2006 13:32:36 &#45;0800 -->
<!--X-Message-Id: Pine.LNX.4.58.0611221327330.16860@tux64.llnl.gov -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 9157e4a10611142228k52bf483cp32a8187db65a3b77@mail.gmail.com -->
<!--X-Reference: Pine.LNX.4.58.0611151054130.15391@tux64.llnl.gov -->
<!--X-Reference: 9157e4a10611151908y1c660169u64fc441986ca0263@mail.gmail.com -->
<!--X-Head-End-->
<html>
<head>
<title>Re: [sundials-users] multiple calls to CVODE in a single program</title>
<meta name="author" content="Radu Serban">
<meta name="description" content="suite of nonlinear differential algebraic equation solvers">
<meta name="keywords" content="SUNDIALS, CVODE, CVODES, IDA, KINSOL">
<meta name="keywords" content="ODE, DAE, sensitivity">
<meta name="keywords" content="differential, algebraic">
<link REL="SHORTCUT ICON" HREF="img/favicon.ico" type="image/x-icon">
<link REL="ICON" HREF="img/favicon.ico" type="image/x-icon">
<link href="../../sundials_styles.css" rel="stylesheet" type="text/css">
<script language="JavaScript">
<!--
homeon = new Image();           homeon.src = "../../graphics/home_buttonH.png";
homeoff = new Image();          homeoff.src = "../../graphics/home_button.png";
descriptionon = new Image();    descriptionon.src = "../../graphics/description_buttonH.png";
descriptionoff = new Image();   descriptionoff.src = "../../graphics/description_button.png";
documentationon = new Image();  documentationon.src = "../../graphics/documentation_buttonH.png";
documentationoff = new Image(); documentationoff.src = "../../graphics/documentation_button.png";
downloadon = new Image();       downloadon.src = "../../graphics/download_buttonH.png";
downloadoff = new Image();      downloadoff.src = "../../graphics/download_button.png";
supporton = new Image();        supporton.src = "../../graphics/support_buttonH.png";
supportoff = new Image();       supportoff.src = "../../graphics/support_button.png";
//-->
</script>
<script src="../../sunjs.js" type="text/javascript" language="javascript1.2"></script>
</head>
<!-- ******************************************************************************** -->
<body>
<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
  <td height="60" background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  <td width="116"><img SRC="../../graphics/head_top_left.png" height="60" width="116" border="0"></td>
  <td width="720"><img SRC="../../graphics/head_mail_top_right.png" height="60" width="720" border="0"></td>
  <td background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  </tr>
  <tr valign="top">
  <td height="127" background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  <td width="116">
    <a href="../../main.html" onMouseOver="img_act('home'); return true;" onMouseOut="img_inact('home'); return true;"><img src="../../graphics/home_button.png" border="0" name="home"></a><br>
    <a href="../../description/description.html" onMouseOver="img_act('description'); return true;" onMouseOut="img_inact('description'); return true;"><img src="../../graphics/description_button.png" border="0" name="description"></a><br>
    <a href="../../documentation/documentation.html" onMouseOver="img_act('documentation'); return true;" onMouseOut="img_inact('documentation'); return true;"><img src="../../graphics/documentation_button.png" border="0" name="documentation"></a><br>
    <a href="../../download/download.html" onMouseOver="img_act('download'); return true;" onMouseOut="img_inact('download'); return true;"><img src="../../graphics/download_button.png" border="0" name="download"></a><br>
    <a href="../../support/support.html" onMouseOver="img_act('support'); return true;" onMouseOut="img_inact('support'); return true;"><img src="../../graphics/support_button.png" border="0" name="support"></a><br>
    <img SRC="../../graphics/line_tl.gif" height="7" width="116" border="0"></td>
  <td width="720">
      <img SRC="../../graphics/head_bottom_right.png" height="120" width="720" border="0"><br>
      <img SRC="../../graphics/line_tr.gif" height="7" width="720" border="0"></td>
  <td background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  </tr>
  <tr valign="top">
  <td background="../../graphics/table_bck3.gif"></td>
  <td width="116" valign="bottom" align="center" background="../../graphics/table_bck5.gif"><img SRC="../../graphics/logo.png" border="0"></td>
  <td width="720" bgcolor="#ffffff">
  <div id="content">   
<!-- Start content for this page -->
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<p class="links">
[<a href="msg00777.html">Date Prev</a>] [<a href="msg00781.html">Date Next</a>] [<a href="msg00772.html">Thread Prev</a>] [<a href="msg00779.html">Thread Next</a>]<br>
[<b><a href="maillist.html#00778">Date Index</a></b>]
[<b><a href="threads.html#00778">Thread Index</a></b>]
</p>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [sundials-users] multiple calls to CVODE in a single program</h1>
<div class="frame">
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<table border=0 cellpadding=2 cellspacing=0>
<tr>
<td align="right"><b>
<em>From</em></b></td>
<td align="left">
Alan Hindmarsh &lt;<a href="mailto:alanh%40llnl.gov">alanh@llnl.gov</a>&gt;</td>
</tr>

<tr>
<td align="right"><b>
<em>Date</em></b></td>
<td align="left">
Wed, 22 Nov 2006 13:30:34 -0800 (PST)</td>
</tr>

</table>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div>
<div class="container">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>Hi KP,

&gt;<i> Do I change my CVODE setup and initialise it with N1+N2 variables instead?</i>

A resounding YES, assuming that cell1 and cell2 are coupled.  (And you
said earlier that the cells are &quot;communicating with each other through
gap junctions.&quot;)  In that case, you are much better off running the
2-cell system as such, of size N1 + N2.  Likewise for many cells.

Of course, if and when the two cells are not coupled, you can and
should run them separately, and then you don't need to intermix the
various calls for the two problems.

In the many-cell system, if the large total size is a problem, you may
need to look at some ways to economize.  Have you checked to see if
the system is really stiff?  If it is, is the dense treatment going to
be prohibitive?  The Jacobian is almost certainly sparse.  Can you
arrange things so that the coupling is banded?  Also, you should
consider a preconditioned Krylov choice, building a preconditoner
based on cell Jacobians that ignore inter-cell couplings.

-Alan H


On Thu, 16 Nov 2006, kanakapriya kalyanasundaram wrote:

&gt;<i> Hi Alan,</i>
&gt;<i> My confusion starts off at a more basic level.</i>
&gt;<i></i>
&gt;<i> This is how I set up the 2 cell simulator</i>
&gt;<i> 1.  create cell1 - create cvode_mem ptr,  init cvode for cell1 with N1 and</i>
&gt;<i> state1, its state vector</i>
&gt;<i> 2.  create cell2 - create cvode_mem ptr, init cvode for cell2 with N2 and</i>
&gt;<i> state2. its state vector</i>
&gt;<i> 3.  Set up for loop to simulate run</i>
&gt;<i> 4.  call cvode for cell1 with state1;</i>
&gt;<i> 5.  call cvode for cell2 with state2.</i>
&gt;<i></i>
&gt;<i> Do I change my CVODE setup and initialise it with N1+N2 variables instead?</i>
&gt;<i></i>
&gt;<i> Thanks,</i>
&gt;<i> KP</i>

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<div class="container">
<table width="95%" frame="below"><tr><td></td></table>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00779" href="msg00779.html">Re: [sundials-users] multiple calls to CVODE in a single program</a></strong>
<ul><li><em>From:</em> &quot;kanakapriya kalyanasundaram&quot; &lt;kanakapriya@gmail.com&gt;</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00775" href="msg00775.html">[sundials-users] multiple calls to CVODE in a single program</a></strong>
<ul><li><em>From:</em> &quot;kanakapriya kalyanasundaram&quot; &lt;kanakapriya@gmail.com&gt;</li></ul></li>
<li><strong><a name="00772" href="msg00772.html">Re: [sundials-users] multiple calls to CVODE in a single program</a></strong>
<ul><li><em>From:</em> Alan Hindmarsh &lt;alanh@llnl.gov&gt;</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00777.html">[sundials-users] Missing files in sundialsTB</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00781.html">Re: [sundials-users] Compiling ODE with very long equations</a></strong>
</li>

<li>Previous by thread:
<strong><a href="msg00772.html">Re: [sundials-users] multiple calls to CVODE in a single program</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00779.html">Re: [sundials-users] multiple calls to CVODE in a single program</a></strong>
</li>

<li>Index(es):
<ul>
<li><a href="maillist.html#00778">
<strong>Main</strong></a></li>
<li><a href="threads.html#00778">
<strong>Thread</strong></a></li>
</ul>
</li>
</ul>
</div>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<!-- End content for this page -->
  </div>
  </td>
  <td background="../../graphics/table_bck3.gif"></td>
  </tr>
  <tr valign="top">
  <td height="17" background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  <td width="116"><a HREF="http://www.llnl.gov/disclaimer.html" target="_top"><img SRC="../../graphics/line_bl.gif" height="17" width="116" border="0"></a></td>
  <td width="720"><img SRC="../../graphics/line_br.gif" height="17" width="720" border="0"></td>
  <td background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  </tr>
  </table>
</body>
</html>
