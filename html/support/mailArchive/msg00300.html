<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: [sundials&#45;users] Communication between processors within time step -->
<!--X-From-R13: Dnqh Ereona <freona1Nyyay.tbi> -->
<!--X-Date: Fri, 17 Feb 2006 08:15:43 &#45;0800 (PST) -->
<!--X-Message-Id: 43F5F605.9020209@llnl.gov -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 20060217052802.5142.qmail@web37010.mail.mud.yahoo.com -->
<!--X-Head-End-->
<html>
<head>
<title>Re: [sundials-users] Communication between processors within time step</title>
<meta name="author" content="Radu Serban">
<meta name="description" content="suite of nonlinear differential algebraic equation solvers">
<meta name="keywords" content="SUNDIALS, CVODE, CVODES, IDA, KINSOL">
<meta name="keywords" content="ODE, DAE, sensitivity">
<meta name="keywords" content="differential, algebraic">
<link REL="SHORTCUT ICON" HREF="img/favicon.ico" type="image/x-icon">
<link REL="ICON" HREF="img/favicon.ico" type="image/x-icon">
<link href="../../sundials_styles.css" rel="stylesheet" type="text/css">
<script language="JavaScript">
<!--
homeon = new Image();           homeon.src = "../../graphics/home_buttonH.png";
homeoff = new Image();          homeoff.src = "../../graphics/home_button.png";
descriptionon = new Image();    descriptionon.src = "../../graphics/description_buttonH.png";
descriptionoff = new Image();   descriptionoff.src = "../../graphics/description_button.png";
documentationon = new Image();  documentationon.src = "../../graphics/documentation_buttonH.png";
documentationoff = new Image(); documentationoff.src = "../../graphics/documentation_button.png";
downloadon = new Image();       downloadon.src = "../../graphics/download_buttonH.png";
downloadoff = new Image();      downloadoff.src = "../../graphics/download_button.png";
supporton = new Image();        supporton.src = "../../graphics/support_buttonH.png";
supportoff = new Image();       supportoff.src = "../../graphics/support_button.png";
//-->
</script>
<script src="../../sunjs.js" type="text/javascript" language="javascript1.2"></script>
</head>
<!-- ******************************************************************************** -->
<body>
<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
  <td height="60" background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  <td width="116"><img SRC="../../graphics/head_top_left.png" height="60" width="116" border="0"></td>
  <td width="720"><img SRC="../../graphics/head_mail_top_right.png" height="60" width="720" border="0"></td>
  <td background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  </tr>
  <tr valign="top">
  <td height="127" background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  <td width="116">
    <a href="../../main.html" onMouseOver="img_act('home'); return true;" onMouseOut="img_inact('home'); return true;"><img src="../../graphics/home_button.png" border="0" name="home"></a><br>
    <a href="../../description/description.html" onMouseOver="img_act('description'); return true;" onMouseOut="img_inact('description'); return true;"><img src="../../graphics/description_button.png" border="0" name="description"></a><br>
    <a href="../../documentation/documentation.html" onMouseOver="img_act('documentation'); return true;" onMouseOut="img_inact('documentation'); return true;"><img src="../../graphics/documentation_button.png" border="0" name="documentation"></a><br>
    <a href="../../download/download.html" onMouseOver="img_act('download'); return true;" onMouseOut="img_inact('download'); return true;"><img src="../../graphics/download_button.png" border="0" name="download"></a><br>
    <a href="../../support/support.html" onMouseOver="img_act('support'); return true;" onMouseOut="img_inact('support'); return true;"><img src="../../graphics/support_button.png" border="0" name="support"></a><br>
    <img SRC="../../graphics/line_tl.gif" height="7" width="116" border="0"></td>
  <td width="720">
      <img SRC="../../graphics/head_bottom_right.png" height="120" width="720" border="0"><br>
      <img SRC="../../graphics/line_tr.gif" height="7" width="720" border="0"></td>
  <td background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  </tr>
  <tr valign="top">
  <td background="../../graphics/table_bck3.gif"></td>
  <td width="116" valign="bottom" align="center" background="../../graphics/table_bck5.gif"><img SRC="../../graphics/logo.png" border="0"></td>
  <td width="720" bgcolor="#ffffff">
  <div id="content">   
<!-- Start content for this page -->
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<p class="links">
[<a href="msg00299.html">Date Prev</a>] [<a href="msg00301.html">Date Next</a>] [<a href="msg00298.html">Thread Prev</a>] [<a href="msg00301.html">Thread Next</a>]<br>
[<b><a href="maillist.html#00300">Date Index</a></b>]
[<b><a href="threads.html#00300">Thread Index</a></b>]
</p>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [sundials-users] Communication between processors within time step</h1>
<div class="frame">
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<table border=0 cellpadding=2 cellspacing=0>
<tr>
<td align="right"><b>
<em>From</em></b></td>
<td align="left">
Radu Serban &lt;<a href="mailto:serban1%40llnl.gov">serban1@llnl.gov</a>&gt;</td>
</tr>

<tr>
<td align="right"><b>
<em>Date</em></b></td>
<td align="left">
Fri, 17 Feb 2006 08:12:53 -0800</td>
</tr>

</table>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div>
<div class="container">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Raj,</pre><br>
When I said, &quot;All algorithmic decisions are precisely the same on every single processor&quot; it means 
that all processors are in perfect sync. If you think about it, after all, all tests and decisions 
in CVODE (convergence and error tests, order and step size modifications, etc.) are based on some 
scalars obtained from (global!) vector norms. When using the parallel NVECTOR module, each 
processors receives the same norm (coming from a global MPI reduction operation) and therefore all 
processors will take the exact same decision.<br>
<br>
Apparently, you seem to make the wrong assumption that each processor tries to 'solve' its own chunk 
of the ODE equations independently of the other processors! That would be impossible since there is 
coupling through states 'owned' by other processors. The global ODE system is solved simultaneously 
and every single decision in CVODE is based on global information.<br>
<br>
<pre style="margin: 0em;">--Radu</pre><br>
P.S. If you monitor when and how often your f() is called on each processor, you'll see clearly that 
they are called the exact same number of times at the exact same values of t. That is true for all 
user-supplied functions, indeed for all functions (internal or user-supplied) in CVODE.<br>
<br>
<pre style="margin: 0em;">raj duffy wrote:
&gt; Hello Radu
&gt;     Sorry for the confusion. I have switched to newer version of CVODE
&gt; but was using parallelized N_Vector so referred it as PVODE.
&gt;     But still I didn't got the answer. What I was asking in my last post
&gt; was, since we have communication routines inside the function f(), every
&gt; call of CVODE on each processor will basically try to solve f() for
&gt; local system of ODEs. This would be perfectly ok if communication
&gt; routines in f() are only executed after each time step (which will act
&gt; as synchronization point). However when I print my communication data,
&gt; it shows that in each iteration within a particular time step,
&gt; communication routines are executed. Now lets say that the number of
&gt; iterations it takes to converge a local system of ODEs on each processor
&gt; for a particular time step is different, then in proc. 1 communication
&gt; subroutine will be called &quot;a-times&quot; whereas it will be called &quot;b-times&quot;
&gt; on proc. 2. ! So communication will be ok only if number of iterations
&gt; on both the processor are same as each iteration will work as
&gt; synchronization point and will cause problem if iterations are different.
&gt;
&gt; Regards
&gt;
&gt; Raj
&gt;
&gt;
&gt; */Radu Serban &lt;serban1@llnl.gov&gt;/* wrote:
&gt;
&gt;     raj duffy wrote:
&gt;      &gt; Hello
&gt;      &gt;
&gt;      &gt; When I try to solve a system of ODEs on a set of processors, the
&gt;      &gt; communication routine is written inside function f( ).
&gt;      &gt; I was wondering that though I call Cvode(f,) at each time step on
&gt;      &gt; each processor, the number of iterations within a particular time
&gt;     step
&gt;      &gt; on different processors can be different. This will throw the whole
&gt;      &gt; Communication subroutines between processors out of order
&gt;      &gt; (synchronization). Can this be the case,! or PVODE somehow will
&gt;     be forced
&gt;      &gt; to run same number of iterations within particular time steps on
&gt;     each
&gt;      &gt; processor.
&gt;      &gt;
&gt;      &gt; Regards
&gt;      &gt;
&gt;      &gt; Raj
&gt;      &gt;
&gt;
&gt;     Hi Raj,
&gt;
&gt;     Do you really still use PVODE, or you just refer to CVODE + parallel
&gt;     vector module as PVODE?
&gt;
&gt;     In any case, in all SUNDIALS solvers, parallelism is provided only
&gt;     through the vector operations. In
&gt;     other words (and this is reflected in the fact that SUNDIALS does
&gt;     not include both CVODE and PVODE),
&gt;     the exact same solver is used both for serial and parallel
&gt;     computations. All algorithmic decisions
&gt;     are precisely the same on every single processor. If you wish, you
&gt;     can think of each call to an
&gt;     N_Vector operation within CVODE as a synchronization point.
&gt;
&gt;     Hope that this clarifies it.
&gt;
&gt;     --Radu
&gt;</pre><br>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<div class="container">
<table width="95%" frame="below"><tr><td></td></table>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00297" href="msg00297.html">[sundials-users] Communication between processors within time step</a></strong>
<ul><li><em>From:</em> raj duffy &lt;raj_duffy@yahoo.com&gt;</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00299.html">Re: [sundials-users] Interesting rounding error problem...</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00301.html">[sundials-users] value of t during internal steps of CVODE call</a></strong>
</li>

<li>Previous by thread:
<strong><a href="msg00298.html">Re: [sundials-users] Communication between processors within time step</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00301.html">[sundials-users] value of t during internal steps of CVODE call</a></strong>
</li>

<li>Index(es):
<ul>
<li><a href="maillist.html#00300">
<strong>Main</strong></a></li>
<li><a href="threads.html#00300">
<strong>Thread</strong></a></li>
</ul>
</li>
</ul>
</div>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<!-- End content for this page -->
  </div>
  </td>
  <td background="../../graphics/table_bck3.gif"></td>
  </tr>
  <tr valign="top">
  <td height="17" background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  <td width="116"><a HREF="http://www.llnl.gov/disclaimer.html" target="_top"><img SRC="../../graphics/line_bl.gif" height="17" width="116" border="0"></a></td>
  <td width="720"><img SRC="../../graphics/line_br.gif" height="17" width="720" border="0"></td>
  <td background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  </tr>
  </table>
</body>
</html>
