<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: [sundials&#45;users] Eigenvalues of IDA system -->
<!--X-From-R13: Oyna Vvaqznefu <nynauNyyay.tbi> -->
<!--X-Date: Wed, 14 Mar 2007 13:35:17 &#45;0700 -->
<!--X-Message-Id: Pine.LNX.4.58.0703141329300.29004@tux64.llnl.gov -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 45EFAAFE.3060907@anu.edu.au -->
<!--X-Head-End-->
<html>
<head>
<title>Re: [sundials-users] Eigenvalues of IDA system</title>
<meta name="author" content="Radu Serban">
<meta name="description" content="suite of nonlinear differential algebraic equation solvers">
<meta name="keywords" content="SUNDIALS, CVODE, CVODES, IDA, KINSOL">
<meta name="keywords" content="ODE, DAE, sensitivity">
<meta name="keywords" content="differential, algebraic">
<link REL="SHORTCUT ICON" HREF="img/favicon.ico" type="image/x-icon">
<link REL="ICON" HREF="img/favicon.ico" type="image/x-icon">
<link href="../../sundials_styles.css" rel="stylesheet" type="text/css">
<script language="JavaScript">
<!--
homeon = new Image();           homeon.src = "../../graphics/home_buttonH.png";
homeoff = new Image();          homeoff.src = "../../graphics/home_button.png";
descriptionon = new Image();    descriptionon.src = "../../graphics/description_buttonH.png";
descriptionoff = new Image();   descriptionoff.src = "../../graphics/description_button.png";
documentationon = new Image();  documentationon.src = "../../graphics/documentation_buttonH.png";
documentationoff = new Image(); documentationoff.src = "../../graphics/documentation_button.png";
downloadon = new Image();       downloadon.src = "../../graphics/download_buttonH.png";
downloadoff = new Image();      downloadoff.src = "../../graphics/download_button.png";
supporton = new Image();        supporton.src = "../../graphics/support_buttonH.png";
supportoff = new Image();       supportoff.src = "../../graphics/support_button.png";
//-->
</script>
<script src="../../sunjs.js" type="text/javascript" language="javascript1.2"></script>
</head>
<!-- ******************************************************************************** -->
<body>
<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
  <td height="60" background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  <td width="116"><img SRC="../../graphics/head_top_left.png" height="60" width="116" border="0"></td>
  <td width="720"><img SRC="../../graphics/head_mail_top_right.png" height="60" width="720" border="0"></td>
  <td background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  </tr>
  <tr valign="top">
  <td height="127" background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  <td width="116">
    <a href="../../main.html" onMouseOver="img_act('home'); return true;" onMouseOut="img_inact('home'); return true;"><img src="../../graphics/home_button.png" border="0" name="home"></a><br>
    <a href="../../description/description.html" onMouseOver="img_act('description'); return true;" onMouseOut="img_inact('description'); return true;"><img src="../../graphics/description_button.png" border="0" name="description"></a><br>
    <a href="../../documentation/documentation.html" onMouseOver="img_act('documentation'); return true;" onMouseOut="img_inact('documentation'); return true;"><img src="../../graphics/documentation_button.png" border="0" name="documentation"></a><br>
    <a href="../../download/download.html" onMouseOver="img_act('download'); return true;" onMouseOut="img_inact('download'); return true;"><img src="../../graphics/download_button.png" border="0" name="download"></a><br>
    <a href="../../support/support.html" onMouseOver="img_act('support'); return true;" onMouseOut="img_inact('support'); return true;"><img src="../../graphics/support_button.png" border="0" name="support"></a><br>
    <img SRC="../../graphics/line_tl.gif" height="7" width="116" border="0"></td>
  <td width="720">
      <img SRC="../../graphics/head_bottom_right.png" height="120" width="720" border="0"><br>
      <img SRC="../../graphics/line_tr.gif" height="7" width="720" border="0"></td>
  <td background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  </tr>
  <tr valign="top">
  <td background="../../graphics/table_bck3.gif"></td>
  <td width="116" valign="bottom" align="center" background="../../graphics/table_bck5.gif"><img SRC="../../graphics/logo.png" border="0"></td>
  <td width="720" bgcolor="#ffffff">
  <div id="content">   
<!-- Start content for this page -->
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<p class="links">
[<a href="msg00913.html">Date Prev</a>] [<a href="msg00916.html">Date Next</a>] [<a href="msg00901.html">Thread Prev</a>] [<a href="msg00923.html">Thread Next</a>]<br>
[<b><a href="maillist.html#00915">Date Index</a></b>]
[<b><a href="threads.html#00915">Thread Index</a></b>]
</p>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [sundials-users] Eigenvalues of IDA system</h1>
<div class="frame">
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<table border=0 cellpadding=2 cellspacing=0>
<tr>
<td align="right"><b>
<em>From</em></b></td>
<td align="left">
Alan Hindmarsh &lt;<a href="mailto:alanh%40llnl.gov">alanh@llnl.gov</a>&gt;</td>
</tr>

<tr>
<td align="right"><b>
<em>Date</em></b></td>
<td align="left">
Wed, 14 Mar 2007 13:33:06 -0700 (PDT)</td>
</tr>

</table>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div>
<div class="container">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>Hello John,

Just a few thoughts (and questions):

First, I gather that your DAE system is not an ODE system, that is
the time derivative vector y' is not given explicitly in F(t,y,y') = 0.
Is that the case?  If so, you should first look carefuly at the issue
of well-posedness.  For starters, is dF/dy' singular?  If so, can you
identify algebraic equations that are implicit in the system, and are
these uniquely solvable for the algebraic components of y (those for
which time derivatives do not appear)?  If the system is more
complicated than that, have you done anything to convince yourself
that it is well-posed?

The behavior you describe sounds like that of a system like Ay' = f(t,y),
in which the matrix A is nearly singular, and changes in mesh size are
drastically affecting the spectrum of A^{-1} df/dy, even though the
changes in A are numerically small.  In that case, I would try to find
a singluar matrix A0 that A is nearly equal to, and study the system
A0 y' = f instead.  This has a (perhaps implicit) algebraic subsystem
that your original problem is 'trying' to enforce, and if that
subsystem makes sense, it would be better to enforce it directly,
especially if that eliminates the large positive Re(lambda).

Without knowing more about what the matrix is whose eigenvalues
you are studying, it is hard to know if finding some in the right
half-plane is worrisome.  If dF/dy' is singular, have you generated an
equivalent, reduced-size, ODE system (with algebraic components
eliminated), and computed the Jacobian of that system?  If that is the
matrix, then yes you do not want to see those large positive
Re(lambda) values.

The large eigenvalues you see are a little similar to the situation
with central differencing of a diffusion equation, where the eigenvalues
of the Jacobian tend to -infinity as the mesh is refined.  But they
are always negative -- no positive real parts, in conformity with
the continuous operator involved, which has a spectrum stretching
to -infinity.

As to the general question of using eigen-analysis for ODE/DAE
systems, this is sometimes done, but not often, just because it is
usually difficult -- both to obtain the right matrix and to compute
eigenvalues.  Also, doing this for DAEs is considerably more involved
that for ODEs.  For a linearized problem Ay' = By, the eigen-problem
is the generalized one, A lambda v = B v.  You should look at some of
the DAE literature for more on this.

-Alan H.


On Thu, 8 Mar 2007, John Pye wrote:

&gt;<i> Hi all</i>
&gt;<i></i>
&gt;<i> I have been trying to get to the bottom of some problems with modelling</i>
&gt;<i> an advection problem (homogeneous two phase flow) using IDA. I'm a bit</i>
&gt;<i> out of my field here, so perhaps someone could offer me some suggestions?</i>
&gt;<i></i>
&gt;<i> I've managed to create a few different finite-difference schemes and I</i>
&gt;<i> have exported them to IDA for solving, but I find that when I introduce</i>
&gt;<i> an initial peturbation in one of my important variables, I can only make</i>
&gt;<i> the model solve in very limited cases, for example with a specific set</i>
&gt;<i> of flow parameters, and for only fairly few (~10 or 20) nodes.</i>
&gt;<i></i>
&gt;<i> I have worked out a way of calculating the system eigenvalues for the</i>
&gt;<i> DAE system by extracting some derivatives and doing some matrix arithmetic.</i>
&gt;<i></i>
&gt;<i> When I plot these complex eigenvalues, they seem to move around *a lot*</i>
&gt;<i> when I change the numbers of nodes in my spatial discretisation (eg</i>
&gt;<i> max(Re(lambda)) goes from +100 to +10000, and IDA stops converging).</i>
&gt;<i> Also, I have quite a few eigenvalues in the right half plane, which</i>
&gt;<i> presumably I should be quite worried about, too.</i>
&gt;<i></i>
&gt;<i> Can anyone comment on whether this approach of plotting eigenvalues for</i>
&gt;<i> a DAE system sounds like a good idea, and can anyone suggest what this</i>
&gt;<i> sensitivity to the number of spatial nodes could be all about?</i>
&gt;<i></i>
&gt;<i> Cheers</i>
&gt;<i> JP</i>
&gt;<i></i>
&gt;<i> John Pye</i>
&gt;<i> <a  href="http://pye.dyndns.org">http://pye.dyndns.org</a></i>

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<div class="container">
<table width="95%" frame="below"><tr><td></td></table>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00897" href="msg00897.html">[sundials-users] Eigenvalues of IDA system</a></strong>
<ul><li><em>From:</em> John Pye &lt;john.pye@anu.edu.au&gt;</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00913.html">[sundials-users] Two Questions - about CVODES and SundialsTB</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00916.html">Re: [sundials-users] Alternate linear solvers for kinsol</a></strong>
</li>

<li>Previous by thread:
<strong><a href="msg00901.html">Re: [sundials-users] Eigenvalues of IDA system</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00923.html">Re: [sundials-users] Eigenvalues of IDA system</a></strong>
</li>

<li>Index(es):
<ul>
<li><a href="maillist.html#00915">
<strong>Main</strong></a></li>
<li><a href="threads.html#00915">
<strong>Thread</strong></a></li>
</ul>
</li>
</ul>
</div>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<!-- End content for this page -->
  </div>
  </td>
  <td background="../../graphics/table_bck3.gif"></td>
  </tr>
  <tr valign="top">
  <td height="17" background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  <td width="116"><a HREF="http://www.llnl.gov/disclaimer.html" target="_top"><img SRC="../../graphics/line_bl.gif" height="17" width="116" border="0"></a></td>
  <td width="720"><img SRC="../../graphics/line_br.gif" height="17" width="720" border="0"></td>
  <td background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  </tr>
  </table>
</body>
</html>
