<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: How does the solver guarantie accuracy in time? -->
<!--X-From-R13: Dnqh Ereona <freona1Nyyay.tbi> -->
<!--X-Date: Mon, 16 May 2005 18:10:47 &#45;0700 (PDT) -->
<!--X-Message-Id: 42894448.30802@llnl.gov -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: opsquiwflzt8lo91@smtp.kuleuven.ac.be -->
<!--X-Reference: Pine.LNX.4.58.0505161544560.27111@tux64.llnl.gov -->
<!--X-Reference: opsqv7n1wet8lo91@smtp.kuleuven.ac.be -->
<!--X-Head-End-->
<html>
<head>
<title>Re: How does the solver guarantie accuracy in time?</title>
<meta name="author" content="Radu Serban">
<meta name="description" content="suite of nonlinear differential algebraic equation solvers">
<meta name="keywords" content="SUNDIALS, CVODE, CVODES, IDA, KINSOL">
<meta name="keywords" content="ODE, DAE, sensitivity">
<meta name="keywords" content="differential, algebraic">
<link REL="SHORTCUT ICON" HREF="img/favicon.ico" type="image/x-icon">
<link REL="ICON" HREF="img/favicon.ico" type="image/x-icon">
<link href="../../sundials_styles.css" rel="stylesheet" type="text/css">
<script language="JavaScript">
<!--
homeon = new Image();           homeon.src = "../../graphics/home_buttonH.png";
homeoff = new Image();          homeoff.src = "../../graphics/home_button.png";
descriptionon = new Image();    descriptionon.src = "../../graphics/description_buttonH.png";
descriptionoff = new Image();   descriptionoff.src = "../../graphics/description_button.png";
documentationon = new Image();  documentationon.src = "../../graphics/documentation_buttonH.png";
documentationoff = new Image(); documentationoff.src = "../../graphics/documentation_button.png";
downloadon = new Image();       downloadon.src = "../../graphics/download_buttonH.png";
downloadoff = new Image();      downloadoff.src = "../../graphics/download_button.png";
supporton = new Image();        supporton.src = "../../graphics/support_buttonH.png";
supportoff = new Image();       supportoff.src = "../../graphics/support_button.png";
//-->
</script>
<script src="../../sunjs.js" type="text/javascript" language="javascript1.2"></script>
</head>
<!-- ******************************************************************************** -->
<body>
<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
  <td height="60" background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  <td width="116"><img SRC="../../graphics/head_top_left.png" height="60" width="116" border="0"></td>
  <td width="720"><img SRC="../../graphics/head_mail_top_right.png" height="60" width="720" border="0"></td>
  <td background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  </tr>
  <tr valign="top">
  <td height="127" background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  <td width="116">
    <a href="../../main.html" onMouseOver="img_act('home'); return true;" onMouseOut="img_inact('home'); return true;"><img src="../../graphics/home_button.png" border="0" name="home"></a><br>
    <a href="../../description/description.html" onMouseOver="img_act('description'); return true;" onMouseOut="img_inact('description'); return true;"><img src="../../graphics/description_button.png" border="0" name="description"></a><br>
    <a href="../../documentation/documentation.html" onMouseOver="img_act('documentation'); return true;" onMouseOut="img_inact('documentation'); return true;"><img src="../../graphics/documentation_button.png" border="0" name="documentation"></a><br>
    <a href="../../download/download.html" onMouseOver="img_act('download'); return true;" onMouseOut="img_inact('download'); return true;"><img src="../../graphics/download_button.png" border="0" name="download"></a><br>
    <a href="../../support/support.html" onMouseOver="img_act('support'); return true;" onMouseOut="img_inact('support'); return true;"><img src="../../graphics/support_button.png" border="0" name="support"></a><br>
    <img SRC="../../graphics/line_tl.gif" height="7" width="116" border="0"></td>
  <td width="720">
      <img SRC="../../graphics/head_bottom_right.png" height="120" width="720" border="0"><br>
      <img SRC="../../graphics/line_tr.gif" height="7" width="720" border="0"></td>
  <td background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  </tr>
  <tr valign="top">
  <td background="../../graphics/table_bck3.gif"></td>
  <td width="116" valign="bottom" align="center" background="../../graphics/table_bck5.gif"><img SRC="../../graphics/logo.png" border="0"></td>
  <td width="720" bgcolor="#ffffff">
  <div id="content">   
<!-- Start content for this page -->
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<p class="links">
[<a href="msg00055.html">Date Prev</a>] [<a href="msg00057.html">Date Next</a>] [<a href="msg00055.html">Thread Prev</a>] [<a href="msg00057.html">Thread Next</a>]<br>
[<b><a href="maillist.html#00056">Date Index</a></b>]
[<b><a href="threads.html#00056">Thread Index</a></b>]
</p>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: How does the solver guarantie accuracy in time?</h1>
<div class="frame">
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<table border=0 cellpadding=2 cellspacing=0>
<tr>
<td align="right"><b>
<em>From</em></b></td>
<td align="left">
Radu Serban &lt;<a href="mailto:serban1%40llnl.gov">serban1@llnl.gov</a>&gt;</td>
</tr>

<tr>
<td align="right"><b>
<em>Date</em></b></td>
<td align="left">
Mon, 16 May 2005 18:09:28 -0700</td>
</tr>

</table>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div>
<div class="container">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Hello Andreas,</pre><br>
You are talking of the stopping test for the nonlinear iteration (Newton iteration). This is related to the local error 
test which controls the &quot;accuracy in time&quot; (see below). The tolerance with which the nonlinear system is solved is 
selected such that errors in its solution do not affect the local error test. (As a parenthesis, when using an iterative 
linear solver within the Newton iteration - such as SPGMR - the tolerance with which the linear system is solved is also 
related to the local error test).<br>
<br>
Local Error Test:<br>
CVODE controls the local truncation error (LTE) by modifying the step size and/or method order so that the WRMS norm of 
the LTE is less than or equal to 1.0. The LTE is estimated from the asymptotic relations it satisfies. The WRMS 
(weighted root-mean-square) norm uses weights based on the current solution and the relative and absolute tolerances, so 
that any vector representing a perturbation in y (such as the LTE) whose WRMS norm is &lt;= 1 is considered &quot;small&quot; 
(easiest was to see this is to think of the scalar case, in which case ||v||_WRMS = 1 &lt;=&gt; v = rtol*|y| + atol)<br>
<br>
For more details, see the ACM TOMS paper &quot;SUNDIALS: Suite of Nonlinear and Differential/Algebraic Equation Solvers&quot;, 
available as a PDF on the SUNDIALS webpage at
   <a  href="http://www.llnl.gov/CASC/sundials/documentation/documentation.html">http://www.llnl.gov/CASC/sundials/documentation/documentation.html</a><br>
The Cohen-Hindmarsh paper you mention is also available there. If you really want to go to the roots :-) take also a look at<br>
1) G.D. Byrne and A.C. Hindmarsh, &quot;A Polyalgorithm for the numerical solution of Ordinary Differential Equations&quot;, ACM 
TOMS, 1(1), 1975, pp. 71-96<br>
2) K.R. Jackson and R. Sacks-Davis, &quot;An Alternative Implementation of Variable Step-Size Multistep Formulas for Stiff 
ODEs&quot;, ACM TOMS, 6(3), 1980, pp. 295-318<br>
3) P.N. Brown, G.D. Byrne, and A.C. Hindmarsh, &quot;VODE, A Variable-Coefficient ODE Solver&quot;, SIAM J. Sci. Stat. Comp., 10, 
1989, pp. 1038-1051<br>
<br>
<pre style="margin: 0em;">Ragards,
--Radu Serban</pre><br>
<tt>Andreas Nicolai wrote:
</tt><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">Hi again,</pre><br>
I was wondering how CVODE &quot;knows&quot; whether the solution is actually 
accurate in time? As I understand it (for BDF, NEWTON) the iteration is 
performed until the changes of the calculated state variables are within 
the tolerance requirements. After that the solver takes a new step and 
starts iterating for that solution again.<br>
But how can the solver tell, that the linearization/polynomial 
approximation in time is accurate and that the time step wasn't too big?<br>
<br>
Is there a publication where this method is described a bit more in detail?<br>
(could the first publication &quot;CVODE, A Stiff/Nonstiff ODE Solver in C&quot; 
perhaps be made available as PDF on the SUNDIALS webpage?)<br>
<br>
<pre style="margin: 0em;">Thanks,
Andreas</pre><br>
</blockquote><br>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<div class="container">
<table width="95%" frame="below"><tr><td></td></table>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00057" href="msg00057.html">Re: How does the solver guarantie accuracy in time?</a></strong>
<ul><li><em>From:</em> Andreas Nicolai &lt;Andreas.Nicolai@gmx.net&gt;</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00050" href="msg00050.html">Slow performance when solution is not changing</a></strong>
<ul><li><em>From:</em> Andreas Nicolai &lt;Andreas.Nicolai@gmx.net&gt;</li></ul></li>
<li><strong><a name="00051" href="msg00051.html">Re: Slow performance when solution is not changing</a></strong>
<ul><li><em>From:</em> Alan Hindmarsh &lt;alanh@llnl.gov&gt;</li></ul></li>
<li><strong><a name="00055" href="msg00055.html">How does the solver guarantie accuracy in time?</a></strong>
<ul><li><em>From:</em> Andreas Nicolai &lt;Andreas.Nicolai@gmx.net&gt;</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00055.html">How does the solver guarantie accuracy in time?</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00057.html">Re: How does the solver guarantie accuracy in time?</a></strong>
</li>

<li>Previous by thread:
<strong><a href="msg00055.html">How does the solver guarantie accuracy in time?</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00057.html">Re: How does the solver guarantie accuracy in time?</a></strong>
</li>

<li>Index(es):
<ul>
<li><a href="maillist.html#00056">
<strong>Main</strong></a></li>
<li><a href="threads.html#00056">
<strong>Thread</strong></a></li>
</ul>
</li>
</ul>
</div>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<!-- End content for this page -->
  </div>
  </td>
  <td background="../../graphics/table_bck3.gif"></td>
  </tr>
  <tr valign="top">
  <td height="17" background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  <td width="116"><a HREF="http://www.llnl.gov/disclaimer.html" target="_top"><img SRC="../../graphics/line_bl.gif" height="17" width="116" border="0"></a></td>
  <td width="720"><img SRC="../../graphics/line_br.gif" height="17" width="720" border="0"></td>
  <td background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  </tr>
  </table>
</body>
</html>
