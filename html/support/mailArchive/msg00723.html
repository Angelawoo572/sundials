<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: [sundials&#45;users] Re: large stiff ODE system -->
<!--X-From-R13: Oyna Vvaqznefu <nynauNyyay.tbi> -->
<!--X-Date: Wed, 04 Oct 2006 15:21:52 &#45;0700 -->
<!--X-Message-Id: Pine.LNX.4.58.0610041518010.23523@tux64.llnl.gov -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 1158794197.4511cbd57a61a@webmail.nd.edu -->
<!--X-Reference: Pine.LNX.4.58.0609271455270.16395@tux64.llnl.gov -->
<!--X-Reference: 1159837607.4521b7a753675@webmail.nd.edu -->
<!--X-Head-End-->
<html>
<head>
<title>Re: [sundials-users] Re: large stiff ODE system</title>
<meta name="author" content="Radu Serban">
<meta name="description" content="suite of nonlinear differential algebraic equation solvers">
<meta name="keywords" content="SUNDIALS, CVODE, CVODES, IDA, KINSOL">
<meta name="keywords" content="ODE, DAE, sensitivity">
<meta name="keywords" content="differential, algebraic">
<link REL="SHORTCUT ICON" HREF="img/favicon.ico" type="image/x-icon">
<link REL="ICON" HREF="img/favicon.ico" type="image/x-icon">
<link href="../../sundials_styles.css" rel="stylesheet" type="text/css">
<script language="JavaScript">
<!--
homeon = new Image();           homeon.src = "../../graphics/home_buttonH.png";
homeoff = new Image();          homeoff.src = "../../graphics/home_button.png";
descriptionon = new Image();    descriptionon.src = "../../graphics/description_buttonH.png";
descriptionoff = new Image();   descriptionoff.src = "../../graphics/description_button.png";
documentationon = new Image();  documentationon.src = "../../graphics/documentation_buttonH.png";
documentationoff = new Image(); documentationoff.src = "../../graphics/documentation_button.png";
downloadon = new Image();       downloadon.src = "../../graphics/download_buttonH.png";
downloadoff = new Image();      downloadoff.src = "../../graphics/download_button.png";
supporton = new Image();        supporton.src = "../../graphics/support_buttonH.png";
supportoff = new Image();       supportoff.src = "../../graphics/support_button.png";
//-->
</script>
<script src="../../sunjs.js" type="text/javascript" language="javascript1.2"></script>
</head>
<!-- ******************************************************************************** -->
<body>
<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
  <td height="60" background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  <td width="116"><img SRC="../../graphics/head_top_left.png" height="60" width="116" border="0"></td>
  <td width="720"><img SRC="../../graphics/head_mail_top_right.png" height="60" width="720" border="0"></td>
  <td background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  </tr>
  <tr valign="top">
  <td height="127" background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  <td width="116">
    <a href="../../main.html" onMouseOver="img_act('home'); return true;" onMouseOut="img_inact('home'); return true;"><img src="../../graphics/home_button.png" border="0" name="home"></a><br>
    <a href="../../description/description.html" onMouseOver="img_act('description'); return true;" onMouseOut="img_inact('description'); return true;"><img src="../../graphics/description_button.png" border="0" name="description"></a><br>
    <a href="../../documentation/documentation.html" onMouseOver="img_act('documentation'); return true;" onMouseOut="img_inact('documentation'); return true;"><img src="../../graphics/documentation_button.png" border="0" name="documentation"></a><br>
    <a href="../../download/download.html" onMouseOver="img_act('download'); return true;" onMouseOut="img_inact('download'); return true;"><img src="../../graphics/download_button.png" border="0" name="download"></a><br>
    <a href="../../support/support.html" onMouseOver="img_act('support'); return true;" onMouseOut="img_inact('support'); return true;"><img src="../../graphics/support_button.png" border="0" name="support"></a><br>
    <img SRC="../../graphics/line_tl.gif" height="7" width="116" border="0"></td>
  <td width="720">
      <img SRC="../../graphics/head_bottom_right.png" height="120" width="720" border="0"><br>
      <img SRC="../../graphics/line_tr.gif" height="7" width="720" border="0"></td>
  <td background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  </tr>
  <tr valign="top">
  <td background="../../graphics/table_bck3.gif"></td>
  <td width="116" valign="bottom" align="center" background="../../graphics/table_bck5.gif"><img SRC="../../graphics/logo.png" border="0"></td>
  <td width="720" bgcolor="#ffffff">
  <div id="content">   
<!-- Start content for this page -->
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<p class="links">
[<a href="msg00722.html">Date Prev</a>] [<a href="msg00724.html">Date Next</a>] [<a href="msg00715.html">Thread Prev</a>] [<a href="msg00714.html">Thread Next</a>]<br>
[<b><a href="maillist.html#00723">Date Index</a></b>]
[<b><a href="threads.html#00723">Thread Index</a></b>]
</p>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [sundials-users] Re: large stiff ODE system</h1>
<div class="frame">
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<table border=0 cellpadding=2 cellspacing=0>
<tr>
<td align="right"><b>
<em>From</em></b></td>
<td align="left">
Alan Hindmarsh &lt;<a href="mailto:alanh%40llnl.gov">alanh@llnl.gov</a>&gt;</td>
</tr>

<tr>
<td align="right"><b>
<em>Date</em></b></td>
<td align="left">
Wed, 4 Oct 2006 15:20:03 -0700 (PDT)</td>
</tr>

</table>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div>
<div class="container">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>
Hello John,

1. First, operator splitting is not intended to treat the issue of
stiffness (as distinguished by fast and slow reaction times).
Splitting is done to (try to) make the solution more efficient by
treating only one operator at a time.  Unfortunately, when one of the
operators is stiff, each of the partial steps that deal with that
operator must take artificially small steps because the other partial
step(s) have taken the system out of equilibrium.  This is why I
can never recommend (traditional) splitting.  The solutions are
just too expensive, and the extra variation seen is all artificial.

2. If there is indeed a weak coupling between the flow and the
reactions, then a VODPK or CVODE solution with a splitting-based
preconditioner should work well.  For a start, use a preconditioner
that includes only the reaction Jacobian contributions.  If that
fails, it means that the flow Jacobian is important too, and you
need to include a preconditioner factor that uses the flow Jacobian
(but not the reaction).  See our paper for the meaning of that.

3. Solving the whole problem will not give you time step restrictions
due to stiffness, per se.  If there are step size cuts, they are due
to failures of the linear solver.  That is where the effort should go.

-Alan H


On Mon, 2 Oct 2006 jkamel@nd.edu wrote:

&gt;<i> Dear prof. Hindmarsh,</i>
&gt;<i></i>
&gt;<i> I appreciate your advice about not using Strang-splitting approach or any </i>
&gt;<i> other</i>
&gt;<i> operator splitting.  I knew that operator splitting tempoarly decouple </i>
&gt;<i> reaction</i>
&gt;<i> from convection and diffusion and hence helps to solve stiff equations results</i>
&gt;<i> from disparity between fast and slow reaction mechanisms (small and large</i>
&gt;<i> eigenvalues).</i>
&gt;<i></i>
&gt;<i> I have tried to use DASPK to solve the whole system (DAE system), however it</i>
&gt;<i> fails. That's</i>
&gt;<i> why I could not find any other way to solve that problem.  I believe that the</i>
&gt;<i> linear solver failed to find a solution.  I used GMRES which is iterative</i>
&gt;<i> solver to get arround memory issue however it failed.  I have also tried</i>
&gt;<i> UMFPACK (sparse direct solver) which I believe more efficient, however I face </i>
&gt;<i> a</i>
&gt;<i> memory problem in jacobian calculation.</i>
&gt;<i></i>
&gt;<i> I will just clarify more about my problem.  I solve a transient flow inside</i>
&gt;<i> CVD/CVI (chemical vapor deposition/infiltration) using low Mach number</i>
&gt;<i> equations.  I solve for 2 velocity compomponents+pressure+temperature+15</i>
&gt;<i> species.  I have a hydrocarbon that is supplied into the CVD reactor to</i>
&gt;<i> decompose and deposite on porous substrates inside the reactor.  That process</i>
&gt;<i> takes so long.  The reason is that deposition is so slow.</i>
&gt;<i></i>
&gt;<i> Therefore I soved first without surface reaction till I reached steady state</i>
&gt;<i> solution.  Then since deposition time scale is so large I have started</i>
&gt;<i> acounting for deposition (porosity change) using that steady state solution as</i>
&gt;<i> initial condition.</i>
&gt;<i></i>
&gt;<i> So the reason I have selected Strang-splitting is because there is a week</i>
&gt;<i> coupling between fluid flow field and reaction.  Again that because the flow</i>
&gt;<i> field changes very little during porosity change (deposition).</i>
&gt;<i></i>
&gt;<i> So in case I will solve the whole problem as coupled system (without</i>
&gt;<i> Strang-splitting), I will have an extreme restriction on time step for the</i>
&gt;<i> whole system due to stiffness which results from chemical reaction while the</i>
&gt;<i> flow field does not change that much (no stiffness included in it).  On the</i>
&gt;<i> other hand I need to integrate for a faily large time (need to take faily </i>
&gt;<i> large</i>
&gt;<i> time steps) till I reach the required porosity.</i>
&gt;<i></i>
&gt;<i> I appreciate if you can comment on what I have wrote and correct me if I am</i>
&gt;<i> wrong. Also I hope if you can guide me to what the best I can do to solve such</i>
&gt;<i> problem.  How dangerous Strang-splitting can be.</i>
&gt;<i></i>
&gt;<i> Thanks a lot for your help,</i>
&gt;<i> John</i>
&gt;<i></i>
&gt;<i></i>

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<div class="container">
<table width="95%" frame="below"><tr><td></td></table>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00711" href="msg00711.html">[sundials-users] Re: large stiff ODE system</a></strong>
<ul><li><em>From:</em> Alan Hindmarsh &lt;alanh@llnl.gov&gt;</li></ul></li>
<li><strong><a name="00715" href="msg00715.html">[sundials-users] Re: large stiff ODE system</a></strong>
<ul><li><em>From:</em> jkamel@nd.edu</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00722.html">RE: [sundials-users] CV_TOO_MUCH_WORK</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00724.html">[sundials-users] Installation bug report(s)</a></strong>
</li>

<li>Previous by thread:
<strong><a href="msg00715.html">[sundials-users] Re: large stiff ODE system</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00714.html">[sundials-users] how to install</a></strong>
</li>

<li>Index(es):
<ul>
<li><a href="maillist.html#00723">
<strong>Main</strong></a></li>
<li><a href="threads.html#00723">
<strong>Thread</strong></a></li>
</ul>
</li>
</ul>
</div>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<!-- End content for this page -->
  </div>
  </td>
  <td background="../../graphics/table_bck3.gif"></td>
  </tr>
  <tr valign="top">
  <td height="17" background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  <td width="116"><a HREF="http://www.llnl.gov/disclaimer.html" target="_top"><img SRC="../../graphics/line_bl.gif" height="17" width="116" border="0"></a></td>
  <td width="720"><img SRC="../../graphics/line_br.gif" height="17" width="720" border="0"></td>
  <td background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  </tr>
  </table>
</body>
</html>
