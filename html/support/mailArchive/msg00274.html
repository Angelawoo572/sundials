<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: [sundials&#45;users] Re: Error message handling -->
<!--X-From-R13: Dnqh Ereona <freona1Nyyay.tbi> -->
<!--X-Date: Fri, 27 Jan 2006 10:56:45 &#45;0800 (PST) -->
<!--X-Message-Id: 43DA6CA9.4040200@llnl.gov -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 000001c622af$08448fd0$0a01a8c0@pcheartbreak -->
<!--X-Head-End-->
<html>
<head>
<title>Re: [sundials-users] Re: Error message handling</title>
<meta name="author" content="Radu Serban">
<meta name="description" content="suite of nonlinear differential algebraic equation solvers">
<meta name="keywords" content="SUNDIALS, CVODE, CVODES, IDA, KINSOL">
<meta name="keywords" content="ODE, DAE, sensitivity">
<meta name="keywords" content="differential, algebraic">
<link REL="SHORTCUT ICON" HREF="img/favicon.ico" type="image/x-icon">
<link REL="ICON" HREF="img/favicon.ico" type="image/x-icon">
<link href="../../sundials_styles.css" rel="stylesheet" type="text/css">
<script language="JavaScript">
<!--
homeon = new Image();           homeon.src = "../../graphics/home_buttonH.png";
homeoff = new Image();          homeoff.src = "../../graphics/home_button.png";
descriptionon = new Image();    descriptionon.src = "../../graphics/description_buttonH.png";
descriptionoff = new Image();   descriptionoff.src = "../../graphics/description_button.png";
documentationon = new Image();  documentationon.src = "../../graphics/documentation_buttonH.png";
documentationoff = new Image(); documentationoff.src = "../../graphics/documentation_button.png";
downloadon = new Image();       downloadon.src = "../../graphics/download_buttonH.png";
downloadoff = new Image();      downloadoff.src = "../../graphics/download_button.png";
supporton = new Image();        supporton.src = "../../graphics/support_buttonH.png";
supportoff = new Image();       supportoff.src = "../../graphics/support_button.png";
//-->
</script>
<script src="../../sunjs.js" type="text/javascript" language="javascript1.2"></script>
</head>
<!-- ******************************************************************************** -->
<body>
<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
  <td height="60" background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  <td width="116"><img SRC="../../graphics/head_top_left.png" height="60" width="116" border="0"></td>
  <td width="720"><img SRC="../../graphics/head_mail_top_right.png" height="60" width="720" border="0"></td>
  <td background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  </tr>
  <tr valign="top">
  <td height="127" background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  <td width="116">
    <a href="../../main.html" onMouseOver="img_act('home'); return true;" onMouseOut="img_inact('home'); return true;"><img src="../../graphics/home_button.png" border="0" name="home"></a><br>
    <a href="../../description/description.html" onMouseOver="img_act('description'); return true;" onMouseOut="img_inact('description'); return true;"><img src="../../graphics/description_button.png" border="0" name="description"></a><br>
    <a href="../../documentation/documentation.html" onMouseOver="img_act('documentation'); return true;" onMouseOut="img_inact('documentation'); return true;"><img src="../../graphics/documentation_button.png" border="0" name="documentation"></a><br>
    <a href="../../download/download.html" onMouseOver="img_act('download'); return true;" onMouseOut="img_inact('download'); return true;"><img src="../../graphics/download_button.png" border="0" name="download"></a><br>
    <a href="../../support/support.html" onMouseOver="img_act('support'); return true;" onMouseOut="img_inact('support'); return true;"><img src="../../graphics/support_button.png" border="0" name="support"></a><br>
    <img SRC="../../graphics/line_tl.gif" height="7" width="116" border="0"></td>
  <td width="720">
      <img SRC="../../graphics/head_bottom_right.png" height="120" width="720" border="0"><br>
      <img SRC="../../graphics/line_tr.gif" height="7" width="720" border="0"></td>
  <td background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  </tr>
  <tr valign="top">
  <td background="../../graphics/table_bck3.gif"></td>
  <td width="116" valign="bottom" align="center" background="../../graphics/table_bck5.gif"><img SRC="../../graphics/logo.png" border="0"></td>
  <td width="720" bgcolor="#ffffff">
  <div id="content">   
<!-- Start content for this page -->
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<p class="links">
[<a href="msg00273.html">Date Prev</a>] [<a href="msg00275.html">Date Next</a>] [<a href="msg00266.html">Thread Prev</a>] [<a href="msg00275.html">Thread Next</a>]<br>
[<b><a href="maillist.html#00274">Date Index</a></b>]
[<b><a href="threads.html#00274">Thread Index</a></b>]
</p>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [sundials-users] Re: Error message handling</h1>
<div class="frame">
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<table border=0 cellpadding=2 cellspacing=0>
<tr>
<td align="right"><b>
<em>From</em></b></td>
<td align="left">
Radu Serban &lt;<a href="mailto:serban1%40llnl.gov">serban1@llnl.gov</a>&gt;</td>
</tr>

<tr>
<td align="right"><b>
<em>Date</em></b></td>
<td align="left">
Fri, 27 Jan 2006 10:55:37 -0800</td>
</tr>

</table>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div>
<div class="container">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
Alan Garny wrote:
<blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">Here's what I put together. Comments/suggestion?</pre><br>
<pre style="margin: 0em;">/*
 * -----------------------------------------------------------------
 * Type : CVErrHandlerFn
 * -----------------------------------------------------------------
 * A function eh, which handles error messages, must have type
 * CVErrHandlerFn.
 * The function eh takes as input the error code, the name of the
 * module reporting the error, the name of the function in which
 * the error occurred, the error message (with no escape sequences),
 * and a pointer to user data, the same as that passed to
 * CVodeSetErrHandlerFn.
 *
 * All error codes are negative, except CV_WARNING which indicates
 * a warning (the solver continues).
 *
 * A CVErrHandlerFn has no return value.
 * -----------------------------------------------------------------
 */</pre><br>
typedef void (*CVErrHandlerFn)(int error_code,<br>
                               const char *module, const 
char *function,<br>
                               char *msg, void *eh_data);<br>
<br>
<pre style="margin: 0em;">/*
 * -----------------------------------------------------------------
 * CVodeSetErrHandlerFn specifies a user-provided error handler
 * function.
 * -----------------------------------------------------------------
 * If not specified, an internal error handling function is used
 * and error messages are directed to the stream specified through
 * CVodeSetErrFile (default: stderr).
 * -----------------------------------------------------------------
 */</pre><br>
int CVodeSetErrHandlerFn(void *cvode_mem, CVErrHandlerFn 
ehfun, void *eh_data);<br>
<br>
<pre style="margin: 0em;"><br>---------------------------------------</pre><br>
Error messages reporting a NULL (main solver or linear 
solver) memory pointer are automatically 
directed to stderr. As Alan Garny requested, this will not 
happen if the compiler directive 
NO_STDERR_OUTPUT is defined. However, I will NOT provide a 
mechanism to set this directive through 
the configure script. I expect that most users that will use 
the default build system will run their 
applications from a console.
</blockquote><pre style="margin: 0em;"><br></pre><br>
<pre style="margin: 0em;">Looks good to me and thanks for taking my suggestion of a compiler directive
onboard. Having said that, I quite like the idea of an error handler, so I
may end up using such a feature, who knows?! Still, it's good to have that
compiler directive, as it really gives people the liberty to do whatever
they want and it doesn't harm having it. However, since one can define
his/her own error handler, you may want to rename the compiler directive to
something more generic? Maybe NO_ERROR_MESSAGE_OUTPUT? Also, why not have it
set to False in the configure script? To have it in there will make people
aware of it straight away and from there it's completely up to them to
decide whether to change its value or not.</pre><br>
<pre style="margin: 0em;">   Alan.</pre><br>
<br>
</blockquote><pre style="margin: 0em;"><br>Alan,</pre><br>
I certainly would not want to allow for a compiler directive that would make any error message 
output impossible. So there will be no NO_ERROR_MESSAGE_OUTPUT preprocessing macro!<br>
<br>
Right now, I use a preprocessor macro only to decide if error messages that cannot be passed to an 
error handler function (because they indicate that the solver memory is NULL) should be sent to 
stderr (and hence the name NO_STDERR_OUPUT).<br>
Users that want no output whatsoever, besides compiling CVODE with -DNO_STDERR_OUTPUT, should also 
do one of the following:<br>
a) let CVODE use its own error handler function but pass errfp=NULL (through CVodeSetErrFile)<br>
b) define and attach a user-supplied error handler that does nothing.<br>
<br>
I don't want to allow setting this preprocessor macro explicitely through the configure script 
because I think disabling any type of error message output is a bad idea and I want to make it as 
hard as possible to do it :-)<br>
Of course there is always a way as the configure script allows passing additional compiler flags, so 
one could still do:<br>
% configure --with-cflags=-DNO_STDERR_OUTPUT<br>
(Maybe I shouldn't have mentioned that!)<br>
<br>
In a previous email you mentioned that fprintf does not &quot;directly&quot; exist in Delphi. Does that mean 
that you could not link to your Delphi project a code that has any fprintf statements? If that's the 
case, maybe I could rename the preprocessor macro to NO_FPRINTF_OUTPUT and also condition the 
fprintf statements in the default error handler function.<br>
<br>
<pre style="margin: 0em;"><br>--Radu</pre><br>
<pre style="margin: 0em;"><br></pre><br>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<div class="container">
<table width="95%" frame="below"><tr><td></td></table>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00275" href="msg00275.html">RE: [sundials-users] Re: Error message handling</a></strong>
<ul><li><em>From:</em> Alan Garny &lt;agml@hellix.com&gt;</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00266" href="msg00266.html">RE: [sundials-users] Re: Error message handling</a></strong>
<ul><li><em>From:</em> Alan Garny &lt;agml@hellix.com&gt;</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00273.html">Re: R: [sundials-users] Finite difference Jacobian - information to f() when Jacobian is built</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00275.html">RE: [sundials-users] Re: Error message handling</a></strong>
</li>

<li>Previous by thread:
<strong><a href="msg00266.html">RE: [sundials-users] Re: Error message handling</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00275.html">RE: [sundials-users] Re: Error message handling</a></strong>
</li>

<li>Index(es):
<ul>
<li><a href="maillist.html#00274">
<strong>Main</strong></a></li>
<li><a href="threads.html#00274">
<strong>Thread</strong></a></li>
</ul>
</li>
</ul>
</div>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<!-- End content for this page -->
  </div>
  </td>
  <td background="../../graphics/table_bck3.gif"></td>
  </tr>
  <tr valign="top">
  <td height="17" background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  <td width="116"><a HREF="http://www.llnl.gov/disclaimer.html" target="_top"><img SRC="../../graphics/line_bl.gif" height="17" width="116" border="0"></a></td>
  <td width="720"><img SRC="../../graphics/line_br.gif" height="17" width="720" border="0"></td>
  <td background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  </tr>
  </table>
</body>
</html>
