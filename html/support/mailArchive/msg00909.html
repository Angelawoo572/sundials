<!-- MHonArc v2.6.10 -->
<!--X-Subject: [sundials&#45;users] Re: Required  Function/Macro -->
<!--X-From-R13: Dnqh Ereona <enqhNyyay.tbi> -->
<!--X-Date: Fri, 09 Mar 2007 16:57:02 &#45;0800 -->
<!--X-Message-Id: 45F20237.1090905@llnl.gov -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 45DF330C.8090503@craft&#45;tech.com -->
<!--X-Reference: Pine.LNX.4.58.0702281503530.4587@tux64.llnl.gov -->
<!--X-Reference: 45E635F5.5070705@llnl.gov -->
<!--X-Reference: Pine.GSO.4.61.0703050948400.7994@techunix.technion.ac.il -->
<!--X-Head-End-->
<html>
<head>
<title>[sundials-users] Re: Required  Function/Macro</title>
<meta name="author" content="Radu Serban">
<meta name="description" content="suite of nonlinear differential algebraic equation solvers">
<meta name="keywords" content="SUNDIALS, CVODE, CVODES, IDA, KINSOL">
<meta name="keywords" content="ODE, DAE, sensitivity">
<meta name="keywords" content="differential, algebraic">
<link REL="SHORTCUT ICON" HREF="img/favicon.ico" type="image/x-icon">
<link REL="ICON" HREF="img/favicon.ico" type="image/x-icon">
<link href="../../sundials_styles.css" rel="stylesheet" type="text/css">
<script language="JavaScript">
<!--
homeon = new Image();           homeon.src = "../../graphics/home_buttonH.png";
homeoff = new Image();          homeoff.src = "../../graphics/home_button.png";
descriptionon = new Image();    descriptionon.src = "../../graphics/description_buttonH.png";
descriptionoff = new Image();   descriptionoff.src = "../../graphics/description_button.png";
documentationon = new Image();  documentationon.src = "../../graphics/documentation_buttonH.png";
documentationoff = new Image(); documentationoff.src = "../../graphics/documentation_button.png";
downloadon = new Image();       downloadon.src = "../../graphics/download_buttonH.png";
downloadoff = new Image();      downloadoff.src = "../../graphics/download_button.png";
supporton = new Image();        supporton.src = "../../graphics/support_buttonH.png";
supportoff = new Image();       supportoff.src = "../../graphics/support_button.png";
//-->
</script>
<script src="../../sunjs.js" type="text/javascript" language="javascript1.2"></script>
</head>
<!-- ******************************************************************************** -->
<body>
<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
  <td height="60" background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  <td width="116"><img SRC="../../graphics/head_top_left.png" height="60" width="116" border="0"></td>
  <td width="720"><img SRC="../../graphics/head_mail_top_right.png" height="60" width="720" border="0"></td>
  <td background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  </tr>
  <tr valign="top">
  <td height="127" background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  <td width="116">
    <a href="../../main.html" onMouseOver="img_act('home'); return true;" onMouseOut="img_inact('home'); return true;"><img src="../../graphics/home_button.png" border="0" name="home"></a><br>
    <a href="../../description/description.html" onMouseOver="img_act('description'); return true;" onMouseOut="img_inact('description'); return true;"><img src="../../graphics/description_button.png" border="0" name="description"></a><br>
    <a href="../../documentation/documentation.html" onMouseOver="img_act('documentation'); return true;" onMouseOut="img_inact('documentation'); return true;"><img src="../../graphics/documentation_button.png" border="0" name="documentation"></a><br>
    <a href="../../download/download.html" onMouseOver="img_act('download'); return true;" onMouseOut="img_inact('download'); return true;"><img src="../../graphics/download_button.png" border="0" name="download"></a><br>
    <a href="../../support/support.html" onMouseOver="img_act('support'); return true;" onMouseOut="img_inact('support'); return true;"><img src="../../graphics/support_button.png" border="0" name="support"></a><br>
    <img SRC="../../graphics/line_tl.gif" height="7" width="116" border="0"></td>
  <td width="720">
      <img SRC="../../graphics/head_bottom_right.png" height="120" width="720" border="0"><br>
      <img SRC="../../graphics/line_tr.gif" height="7" width="720" border="0"></td>
  <td background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  </tr>
  <tr valign="top">
  <td background="../../graphics/table_bck3.gif"></td>
  <td width="116" valign="bottom" align="center" background="../../graphics/table_bck5.gif"><img SRC="../../graphics/logo.png" border="0"></td>
  <td width="720" bgcolor="#ffffff">
  <div id="content">   
<!-- Start content for this page -->
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<p class="links">
[<a href="msg00908.html">Date Prev</a>] [<a href="msg00910.html">Date Next</a>] [<a href="msg00894.html">Thread Prev</a>] [<a href="msg00893.html">Thread Next</a>]<br>
[<b><a href="maillist.html#00909">Date Index</a></b>]
[<b><a href="threads.html#00909">Thread Index</a></b>]
</p>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>[sundials-users] Re: Required  Function/Macro</h1>
<div class="frame">
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<table border=0 cellpadding=2 cellspacing=0>
<tr>
<td align="right"><b>
<em>From</em></b></td>
<td align="left">
Radu Serban &lt;<a href="mailto:radu%40llnl.gov">radu@llnl.gov</a>&gt;</td>
</tr>

<tr>
<td align="right"><b>
<em>Date</em></b></td>
<td align="left">
Fri, 09 Mar 2007 16:56:23 -0800</td>
</tr>

</table>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div>
<div class="container">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<tt>Rachel Gordon wrote:
</tt><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">Dear Rado,</pre><br>
<tt>We would like to examine 2 iterative solvers within the framework of 
Kinsol; the CGNR algorithm (CG on the normal equations) and another 
solver based on row projections.<br>
It seems that the simplest way to do this is to use sundials_spbcgs.c  
as a basis and introduce changes into it.<br>
In order to implement the CGNR we need a routine (similar to<br>
ATimesFn atimes, ier = atimes(A_data, x, r)) that will calculate 
A_transpose * x. For the second solver we need a macro that will provide 
access to ai - the i-th row of A (for calculating &lt;ai,x&gt;, &lt;ai,ai&gt; and 
const*ai) when calling the solver for the argument A_data.</tt><br>
<br>
<pre style="margin: 0em;">Do you have such routines?
We would greatly appreciate if you could give us such routines.</pre><br>
<pre style="margin: 0em;">Sincerely,</pre><br>
<pre style="margin: 0em;">Rachel</pre><br>
<pre style="margin: 0em;"><br>  Dr.  Rachel Gordon
  Senior Research Associate        Phone: +972-4-8293811
  Dept. of Aerospace Eng.        Fax:   +972 - 4 - 8292030
  The Technion, Haifa 32000, Israel     email: rgordon@tx.technion.ac.il
</pre></blockquote><pre style="margin: 0em;"><br>Dear Rachel,</pre><br>
<tt>First of all, please direct all SUNDIALS-related questions to the sundials-users 
 mailing list (to which you can subscribe by filling up the form at 
<a  href="http://www.llnl.gov/casc/sundials/support/support.html">http://www.llnl.gov/casc/sundials/support/support.html</a>) so that the whole 
project here at LLNL, as well as all the members of that mailing list, can see 
them and have a chance to answer.</tt><br>
<br>
<tt>To answer your question: no we do not have such functions in SUNDIALS. None of 
the linear solvers provided with SUNDIALS require these quantities. In general, 
any Jacobian-related information in SUNDIALS can be obtained either from the 
user or else by internal difference-quotient approximations. I assume you ask 
for functions using DQ.</tt><br>
<br>
<tt>- A^T * v cannot be computed efficiently with directional derivatives (this is 
why we only provide a TFQMR solver in SUNDIALS).  The only way compute this 
quantity with DQ is to compute and store the entire Jacobian (as done in the 
dense linear solver) in which case computing A^T*v is trivial (but expensive). 
The other option is to ask for the user to provide a function (maybe obtained 
with reverse automatic differentiation of the system function).</tt><br>
<br>
<tt>- Obtaining the i-th row of the Jacobian with DQ is the same story: you'll end 
up having to compute the entire Jacobian.</tt><br>
<br>
<tt>Since you ask for a macro to access the i-th row, I suspect you'd be willing to 
work with dense matrices. In that case, if you're going to use the SUNDIALS 
DenseMat type, recall that it stores matrices by columns. Therefore, a function 
for computing A^T*v is trivial to write and can be done efficiently since you'll 
follow columns of A, but a macro/function for getting the i-th row of A will 
necessarily involve copying...</tt><br>
<br>
<pre style="margin: 0em;">--Radu</pre><br>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<div class="container">
<table width="95%" frame="below"><tr><td></td></table>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00892" href="msg00892.html">[sundials-users] Re: CVODES Question</a></strong>
<ul><li><em>From:</em> Alan Hindmarsh &lt;alanh@llnl.gov&gt;</li></ul></li>
<li><strong><a name="00894" href="msg00894.html">Re: [sundials-users] Re: CVODES Question</a></strong>
<ul><li><em>From:</em> Radu Serban &lt;radu@llnl.gov&gt;</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00908.html">Re: [sundials-users] Alternate linear solvers for kinsol</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00910.html">Re: [sundials-users] Alternate linear solvers for kinsol</a></strong>
</li>

<li>Previous by thread:
<strong><a href="msg00894.html">Re: [sundials-users] Re: CVODES Question</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00893.html">[sundials-users] Re: Problems when using sundialsTB toolbox</a></strong>
</li>

<li>Index(es):
<ul>
<li><a href="maillist.html#00909">
<strong>Main</strong></a></li>
<li><a href="threads.html#00909">
<strong>Thread</strong></a></li>
</ul>
</li>
</ul>
</div>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<!-- End content for this page -->
  </div>
  </td>
  <td background="../../graphics/table_bck3.gif"></td>
  </tr>
  <tr valign="top">
  <td height="17" background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  <td width="116"><a HREF="http://www.llnl.gov/disclaimer.html" target="_top"><img SRC="../../graphics/line_bl.gif" height="17" width="116" border="0"></a></td>
  <td width="720"><img SRC="../../graphics/line_br.gif" height="17" width="720" border="0"></td>
  <td background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  </tr>
  </table>
</body>
</html>
