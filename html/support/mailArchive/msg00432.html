<!-- MHonArc v2.6.10 -->
<!--X-Subject: RE: [sundials&#45;users] coordinate projection with CVODE -->
<!--X-From-R13: [vpunry Eurezna <zfureznaNfgnasbeq.rqh> -->
<!--X-Date: Tue, 11 Apr 2006 22:14:07 &#45;0700 (PDT) -->
<!--X-Message-Id: 001001c65def$89486db0$6601a8c0@ShermsNotebook -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 443C3F7E.6000000@llnl.gov -->
<!--X-Head-End-->
<html>
<head>
<title>RE: [sundials-users] coordinate projection with CVODE</title>
<meta name="author" content="Radu Serban">
<meta name="description" content="suite of nonlinear differential algebraic equation solvers">
<meta name="keywords" content="SUNDIALS, CVODE, CVODES, IDA, KINSOL">
<meta name="keywords" content="ODE, DAE, sensitivity">
<meta name="keywords" content="differential, algebraic">
<link REL="SHORTCUT ICON" HREF="img/favicon.ico" type="image/x-icon">
<link REL="ICON" HREF="img/favicon.ico" type="image/x-icon">
<link href="../../sundials_styles.css" rel="stylesheet" type="text/css">
<script language="JavaScript">
<!--
homeon = new Image();           homeon.src = "../../graphics/home_buttonH.png";
homeoff = new Image();          homeoff.src = "../../graphics/home_button.png";
descriptionon = new Image();    descriptionon.src = "../../graphics/description_buttonH.png";
descriptionoff = new Image();   descriptionoff.src = "../../graphics/description_button.png";
documentationon = new Image();  documentationon.src = "../../graphics/documentation_buttonH.png";
documentationoff = new Image(); documentationoff.src = "../../graphics/documentation_button.png";
downloadon = new Image();       downloadon.src = "../../graphics/download_buttonH.png";
downloadoff = new Image();      downloadoff.src = "../../graphics/download_button.png";
supporton = new Image();        supporton.src = "../../graphics/support_buttonH.png";
supportoff = new Image();       supportoff.src = "../../graphics/support_button.png";
//-->
</script>
<script src="../../sunjs.js" type="text/javascript" language="javascript1.2"></script>
</head>
<!-- ******************************************************************************** -->
<body>
<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
  <td height="60" background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  <td width="116"><img SRC="../../graphics/head_top_left.png" height="60" width="116" border="0"></td>
  <td width="720"><img SRC="../../graphics/head_mail_top_right.png" height="60" width="720" border="0"></td>
  <td background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  </tr>
  <tr valign="top">
  <td height="127" background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  <td width="116">
    <a href="../../main.html" onMouseOver="img_act('home'); return true;" onMouseOut="img_inact('home'); return true;"><img src="../../graphics/home_button.png" border="0" name="home"></a><br>
    <a href="../../description/description.html" onMouseOver="img_act('description'); return true;" onMouseOut="img_inact('description'); return true;"><img src="../../graphics/description_button.png" border="0" name="description"></a><br>
    <a href="../../documentation/documentation.html" onMouseOver="img_act('documentation'); return true;" onMouseOut="img_inact('documentation'); return true;"><img src="../../graphics/documentation_button.png" border="0" name="documentation"></a><br>
    <a href="../../download/download.html" onMouseOver="img_act('download'); return true;" onMouseOut="img_inact('download'); return true;"><img src="../../graphics/download_button.png" border="0" name="download"></a><br>
    <a href="../../support/support.html" onMouseOver="img_act('support'); return true;" onMouseOut="img_inact('support'); return true;"><img src="../../graphics/support_button.png" border="0" name="support"></a><br>
    <img SRC="../../graphics/line_tl.gif" height="7" width="116" border="0"></td>
  <td width="720">
      <img SRC="../../graphics/head_bottom_right.png" height="120" width="720" border="0"><br>
      <img SRC="../../graphics/line_tr.gif" height="7" width="720" border="0"></td>
  <td background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  </tr>
  <tr valign="top">
  <td background="../../graphics/table_bck3.gif"></td>
  <td width="116" valign="bottom" align="center" background="../../graphics/table_bck5.gif"><img SRC="../../graphics/logo.png" border="0"></td>
  <td width="720" bgcolor="#ffffff">
  <div id="content">   
<!-- Start content for this page -->
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<p class="links">
[<a href="msg00431.html">Date Prev</a>] [<a href="msg00433.html">Date Next</a>] [<a href="msg00431.html">Thread Prev</a>] [<a href="msg00437.html">Thread Next</a>]<br>
[<b><a href="maillist.html#00432">Date Index</a></b>]
[<b><a href="threads.html#00432">Thread Index</a></b>]
</p>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>RE: [sundials-users] coordinate projection with CVODE</h1>
<div class="frame">
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<table border=0 cellpadding=2 cellspacing=0>
<tr>
<td align="right"><b>
<em>From</em></b></td>
<td align="left">
Michael Sherman &lt;<a href="mailto:msherman%40stanford.edu">msherman@stanford.edu</a>&gt;</td>
</tr>

<tr>
<td align="right"><b>
<em>Date</em></b></td>
<td align="left">
Tue, 11 Apr 2006 22:11:20 -0700</td>
</tr>

</table>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div>
<div class="container">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>
Thanks, Radu. This is intriguing and I would be interested in giving
stabilized index 2 another try, although we still need to put together a
coordinate projection scheme in order to have a &quot;known good&quot; system to
compare with.

Linda did have us take the algebraic variables out of the error test as you
surmised, but there could well be other improvements in IDA that would
change the outcome. The Adams experience is interesting but hard to
interpret. I don't know what Adams is like today since I have been out of
that business for many years, but it was not a relative-coordinates code
last I knew. It was a 6-dofs-per-rigid-body formulation with joints
introduced by constraints. I've never worked with a formulation like that
but I suspect it has very different numerical behavior than a relative
coordinate formulation. For example, they would have a very large number of
barely coupled coordinates and an almost equal number of constraints. Maybe
that accounts for their success with stabilized index 2? Do you know if they
have switched to relative coordinates?

&gt;<i>However, ... modifying CVODE may be the only way to go. But </i>
&gt;<i>that's no mean feat and would result in a solver that</i>
&gt;<i>will not benefit from future SUNDIALS developments...</i>

Well, if we do have to go that route we would certainly try to demonstrate
with concrete results, elegant code and sweet talk that coordinate
projection would be a lovely addition to the CVODE code base :-)

Best regards,
Sherm
 

-----Original Message-----
From: owner-sundials-users@lists.llnl.gov
[<a  href="mailto:owner-sundials-users@lists.llnl.gov">mailto:owner-sundials-users@lists.llnl.gov</a>] On Behalf Of Radu Serban
Sent: Tuesday, April 11, 2006 4:45 PM
To: sundials-users@llnl.gov
Subject: Re: [sundials-users] coordinate projection with CVODE

Hi Sherm,

I don't know what to say, I haven't personally tried the stabilized index-2
formulation on very large systems. However, the version of DASSL 
  that you've tried it with didn't have some features that DASPK3.0 and IDA
now have (such as the option of excluding the algebraic 
variables from the error test - which you may have tried with Linda at that
time). My point is that it shouldn't be all that difficult to 
reconsider it and try it with IDA.

Moreover, knowing that MSC.Adams has this formulation as an option, I called
a friend of mine who used to work for them. He told me that the 
stabilized index-2 formulation never gave them problems and, as a matter of
fact, is the default formulation in Adams/Engine precisely 
because they found it is more accurate and stable! The only reason why it is
not the default in the other Adams products is only because 
this formulation is a bit more expensive (due to the increased number of
variables and equations) and their typical users prefer faster 
solutions.

I'm certainly not advocating this formulation over others. My point is that
it'd be much easier to change the formulation rather than the 
solver. However, if this formulation indeed does not work well for real-life
problems than modifying CVODE may be the only way to go. But 
that's no mean feat and would result in a solver that will not benefit from
future SUNDIALS developments...

--Radu

...


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<div class="container">
<table width="95%" frame="below"><tr><td></td></table>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00437" href="msg00437.html">Re: [sundials-users] coordinate projection with CVODE</a></strong>
<ul><li><em>From:</em> Radu Serban &lt;serban1@llnl.gov&gt;</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00431" href="msg00431.html">Re: [sundials-users] coordinate projection with CVODE</a></strong>
<ul><li><em>From:</em> Radu Serban &lt;serban1@llnl.gov&gt;</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00431.html">Re: [sundials-users] coordinate projection with CVODE</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00433.html">Re: [sundials-users] Arbitrary precision for sundials solvers?</a></strong>
</li>

<li>Previous by thread:
<strong><a href="msg00431.html">Re: [sundials-users] coordinate projection with CVODE</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00437.html">Re: [sundials-users] coordinate projection with CVODE</a></strong>
</li>

<li>Index(es):
<ul>
<li><a href="maillist.html#00432">
<strong>Main</strong></a></li>
<li><a href="threads.html#00432">
<strong>Thread</strong></a></li>
</ul>
</li>
</ul>
</div>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<!-- End content for this page -->
  </div>
  </td>
  <td background="../../graphics/table_bck3.gif"></td>
  </tr>
  <tr valign="top">
  <td height="17" background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  <td width="116"><a HREF="http://www.llnl.gov/disclaimer.html" target="_top"><img SRC="../../graphics/line_bl.gif" height="17" width="116" border="0"></a></td>
  <td width="720"><img SRC="../../graphics/line_br.gif" height="17" width="720" border="0"></td>
  <td background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  </tr>
  </table>
</body>
</html>
