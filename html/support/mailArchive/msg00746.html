<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: [sundials&#45;users] Chemical equilibrium with limitation on the solution... -->
<!--X-From-R13: Dnqh Ereona <enqhNyyay.tbi> -->
<!--X-Date: Tue, 24 Oct 2006 06:02:19 &#45;0700 -->
<!--X-Message-Id: 453E0DC9.5040008@llnl.gov -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: op.thwhhguwt8lo91@helium -->
<!--X-Head-End-->
<html>
<head>
<title>Re: [sundials-users] Chemical equilibrium with limitation on the solution...</title>
<meta name="author" content="Radu Serban">
<meta name="description" content="suite of nonlinear differential algebraic equation solvers">
<meta name="keywords" content="SUNDIALS, CVODE, CVODES, IDA, KINSOL">
<meta name="keywords" content="ODE, DAE, sensitivity">
<meta name="keywords" content="differential, algebraic">
<link REL="SHORTCUT ICON" HREF="img/favicon.ico" type="image/x-icon">
<link REL="ICON" HREF="img/favicon.ico" type="image/x-icon">
<link href="../../sundials_styles.css" rel="stylesheet" type="text/css">
<script language="JavaScript">
<!--
homeon = new Image();           homeon.src = "../../graphics/home_buttonH.png";
homeoff = new Image();          homeoff.src = "../../graphics/home_button.png";
descriptionon = new Image();    descriptionon.src = "../../graphics/description_buttonH.png";
descriptionoff = new Image();   descriptionoff.src = "../../graphics/description_button.png";
documentationon = new Image();  documentationon.src = "../../graphics/documentation_buttonH.png";
documentationoff = new Image(); documentationoff.src = "../../graphics/documentation_button.png";
downloadon = new Image();       downloadon.src = "../../graphics/download_buttonH.png";
downloadoff = new Image();      downloadoff.src = "../../graphics/download_button.png";
supporton = new Image();        supporton.src = "../../graphics/support_buttonH.png";
supportoff = new Image();       supportoff.src = "../../graphics/support_button.png";
//-->
</script>
<script src="../../sunjs.js" type="text/javascript" language="javascript1.2"></script>
</head>
<!-- ******************************************************************************** -->
<body>
<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
  <td height="60" background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  <td width="116"><img SRC="../../graphics/head_top_left.png" height="60" width="116" border="0"></td>
  <td width="720"><img SRC="../../graphics/head_mail_top_right.png" height="60" width="720" border="0"></td>
  <td background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  </tr>
  <tr valign="top">
  <td height="127" background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  <td width="116">
    <a href="../../main.html" onMouseOver="img_act('home'); return true;" onMouseOut="img_inact('home'); return true;"><img src="../../graphics/home_button.png" border="0" name="home"></a><br>
    <a href="../../description/description.html" onMouseOver="img_act('description'); return true;" onMouseOut="img_inact('description'); return true;"><img src="../../graphics/description_button.png" border="0" name="description"></a><br>
    <a href="../../documentation/documentation.html" onMouseOver="img_act('documentation'); return true;" onMouseOut="img_inact('documentation'); return true;"><img src="../../graphics/documentation_button.png" border="0" name="documentation"></a><br>
    <a href="../../download/download.html" onMouseOver="img_act('download'); return true;" onMouseOut="img_inact('download'); return true;"><img src="../../graphics/download_button.png" border="0" name="download"></a><br>
    <a href="../../support/support.html" onMouseOver="img_act('support'); return true;" onMouseOut="img_inact('support'); return true;"><img src="../../graphics/support_button.png" border="0" name="support"></a><br>
    <img SRC="../../graphics/line_tl.gif" height="7" width="116" border="0"></td>
  <td width="720">
      <img SRC="../../graphics/head_bottom_right.png" height="120" width="720" border="0"><br>
      <img SRC="../../graphics/line_tr.gif" height="7" width="720" border="0"></td>
  <td background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  </tr>
  <tr valign="top">
  <td background="../../graphics/table_bck3.gif"></td>
  <td width="116" valign="bottom" align="center" background="../../graphics/table_bck5.gif"><img SRC="../../graphics/logo.png" border="0"></td>
  <td width="720" bgcolor="#ffffff">
  <div id="content">   
<!-- Start content for this page -->
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<p class="links">
[<a href="msg00745.html">Date Prev</a>] [<a href="msg00747.html">Date Next</a>] [<a href="msg00744.html">Thread Prev</a>] [<a href="msg00747.html">Thread Next</a>]<br>
[<b><a href="maillist.html#00746">Date Index</a></b>]
[<b><a href="threads.html#00746">Thread Index</a></b>]
</p>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [sundials-users] Chemical equilibrium with limitation on the solution...</h1>
<div class="frame">
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<table border=0 cellpadding=2 cellspacing=0>
<tr>
<td align="right"><b>
<em>From</em></b></td>
<td align="left">
Radu Serban &lt;<a href="mailto:radu%40llnl.gov">radu@llnl.gov</a>&gt;</td>
</tr>

<tr>
<td align="right"><b>
<em>Date</em></b></td>
<td align="left">
Tue, 24 Oct 2006 05:57:45 -0700</td>
</tr>

</table>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div>
<div class="container">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Andreas,</pre><br>
<pre style="margin: 0em;">I'm no chemist, but something strikes me as odd here.</pre><br>
Andreas Nicolai wrote:
<blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">Hi there,</pre><br>
this is not necessarily a problem with Kinsol or sundials, but since a 
few of the people in this forum know &quot;a bit&quot; about chemistry I hope 
somebody can help me with this problem, also maybe pointing out a 
solution on how to solve this in KinSol.<br>
<br>
Consider a dissolution reaction NaCl -&gt; Na+ + Cl-
</blockquote><br>Presumably, to even talk about equilibrium, the above reaction must be 
reversible, correct?<br>
<br>
<blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em">To calculate the chemical equilibrium I define three equations, using 
the mol numbers as unknown variables:<br>
<br>
<pre style="margin: 0em;">Mass conservation:
1 n(Na+) + 1 n(NaCl) - n(Na+)_0 = 0
1 n(Cl-) + 1 n(NaCl) - n(Cl-)_0 = 0</pre><br>
<pre style="margin: 0em;">(the _0 are the original mol numbers of Na and Cl elements)</pre><br>
<pre style="margin: 0em;">Equilibrium equation:
ln K_NaCl - ln a_Na+ - ln a_Cl- = 0
</pre></blockquote><pre style="margin: 0em;"><br>I assume the above comes from something like K_eq = [Na+][Cl-]/[NaCl].</pre><br>
<blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">Mathematically this corresponds to:</pre><br>
<pre style="margin: 0em;">x + z - x_0 = 0
y + z - y_0 = 0
C - ln a_x - ln a_y = 0</pre><br>
<pre style="margin: 0em;">with a_x = a_x(x,y)  and a_y = a_y(x,y) and  C = const, and x,y,z &gt;= 0</pre><br>
Solving this problem with Kinsol is very easy provided that _enough_ 
NaCl is present. Since negative mol numbers do not make sense the 
solution has to be restricted to positive values. Now when the amount of 
NaCl available is too small, equation 3 can never be fulfilled and thus 
KinSol (or any other iteration algorithm) cannot find a solution.
</blockquote><pre style="margin: 0em;"><br>If the reaction is reversible, does the amount of NaCl matter?</pre><br>
Assuming my simplified equilibrium equation is correct and using the 
conservation equations, then z should be solution of<br>
<br>
<pre style="margin: 0em;">K = (x_0 - z)(y_0 - z)/z  &lt;=&gt;
z^2 - (K+x_0+y_0)*z + x_0*y_0 = 0</pre><br>
<pre style="margin: 0em;">and this quadratic equation always has real solutions for x_0, y_0, K &gt; 0.</pre><br>
<pre style="margin: 0em;">What am I missing? :-)</pre><br>
<pre style="margin: 0em;">--Radu</pre><br>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<div class="container">
<table width="95%" frame="below"><tr><td></td></table>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00747" href="msg00747.html">Re: [sundials-users] Chemical equilibrium with limitation on the solution...</a></strong>
<ul><li><em>From:</em> &quot;Andreas Nicolai&quot; &lt;Andreas.Nicolai@gmx.net&gt;</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00744" href="msg00744.html">[sundials-users] Chemical equilibrium with limitation on the solution...</a></strong>
<ul><li><em>From:</em> &quot;Andreas Nicolai&quot; &lt;Andreas.Nicolai@gmx.net&gt;</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00745.html">Re: [sundials-users] CVodeB and intermediate output</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00747.html">Re: [sundials-users] Chemical equilibrium with limitation on the solution...</a></strong>
</li>

<li>Previous by thread:
<strong><a href="msg00744.html">[sundials-users] Chemical equilibrium with limitation on the solution...</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00747.html">Re: [sundials-users] Chemical equilibrium with limitation on the solution...</a></strong>
</li>

<li>Index(es):
<ul>
<li><a href="maillist.html#00746">
<strong>Main</strong></a></li>
<li><a href="threads.html#00746">
<strong>Thread</strong></a></li>
</ul>
</li>
</ul>
</div>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<!-- End content for this page -->
  </div>
  </td>
  <td background="../../graphics/table_bck3.gif"></td>
  </tr>
  <tr valign="top">
  <td height="17" background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  <td width="116"><a HREF="http://www.llnl.gov/disclaimer.html" target="_top"><img SRC="../../graphics/line_bl.gif" height="17" width="116" border="0"></a></td>
  <td width="720"><img SRC="../../graphics/line_br.gif" height="17" width="720" border="0"></td>
  <td background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  </tr>
  </table>
</body>
</html>
