<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: about your solver CVode -->
<!--X-From-R13: Oyna Vvaqznefu <nynauNyyay.tbi> -->
<!--X-Date: Tue, 20 Dec 2005 14:01:51 &#45;0800 (PST) -->
<!--X-Message-Id: Pine.LNX.4.58.0512201352240.2739@tux64.llnl.gov -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 43A7CDED.7010601@inria.fr -->
<!--X-Head-End-->
<html>
<head>
<title>Re: about your solver CVode</title>
<meta name="author" content="Radu Serban">
<meta name="description" content="suite of nonlinear differential algebraic equation solvers">
<meta name="keywords" content="SUNDIALS, CVODE, CVODES, IDA, KINSOL">
<meta name="keywords" content="ODE, DAE, sensitivity">
<meta name="keywords" content="differential, algebraic">
<link REL="SHORTCUT ICON" HREF="img/favicon.ico" type="image/x-icon">
<link REL="ICON" HREF="img/favicon.ico" type="image/x-icon">
<link href="../../sundials_styles.css" rel="stylesheet" type="text/css">
<script language="JavaScript">
<!--
homeon = new Image();           homeon.src = "../../graphics/home_buttonH.png";
homeoff = new Image();          homeoff.src = "../../graphics/home_button.png";
descriptionon = new Image();    descriptionon.src = "../../graphics/description_buttonH.png";
descriptionoff = new Image();   descriptionoff.src = "../../graphics/description_button.png";
documentationon = new Image();  documentationon.src = "../../graphics/documentation_buttonH.png";
documentationoff = new Image(); documentationoff.src = "../../graphics/documentation_button.png";
downloadon = new Image();       downloadon.src = "../../graphics/download_buttonH.png";
downloadoff = new Image();      downloadoff.src = "../../graphics/download_button.png";
supporton = new Image();        supporton.src = "../../graphics/support_buttonH.png";
supportoff = new Image();       supportoff.src = "../../graphics/support_button.png";
//-->
</script>
<script src="../../sunjs.js" type="text/javascript" language="javascript1.2"></script>
</head>
<!-- ******************************************************************************** -->
<body>
<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
  <td height="60" background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  <td width="116"><img SRC="../../graphics/head_top_left.png" height="60" width="116" border="0"></td>
  <td width="720"><img SRC="../../graphics/head_mail_top_right.png" height="60" width="720" border="0"></td>
  <td background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  </tr>
  <tr valign="top">
  <td height="127" background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  <td width="116">
    <a href="../../main.html" onMouseOver="img_act('home'); return true;" onMouseOut="img_inact('home'); return true;"><img src="../../graphics/home_button.png" border="0" name="home"></a><br>
    <a href="../../description/description.html" onMouseOver="img_act('description'); return true;" onMouseOut="img_inact('description'); return true;"><img src="../../graphics/description_button.png" border="0" name="description"></a><br>
    <a href="../../documentation/documentation.html" onMouseOver="img_act('documentation'); return true;" onMouseOut="img_inact('documentation'); return true;"><img src="../../graphics/documentation_button.png" border="0" name="documentation"></a><br>
    <a href="../../download/download.html" onMouseOver="img_act('download'); return true;" onMouseOut="img_inact('download'); return true;"><img src="../../graphics/download_button.png" border="0" name="download"></a><br>
    <a href="../../support/support.html" onMouseOver="img_act('support'); return true;" onMouseOut="img_inact('support'); return true;"><img src="../../graphics/support_button.png" border="0" name="support"></a><br>
    <img SRC="../../graphics/line_tl.gif" height="7" width="116" border="0"></td>
  <td width="720">
      <img SRC="../../graphics/head_bottom_right.png" height="120" width="720" border="0"><br>
      <img SRC="../../graphics/line_tr.gif" height="7" width="720" border="0"></td>
  <td background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  </tr>
  <tr valign="top">
  <td background="../../graphics/table_bck3.gif"></td>
  <td width="116" valign="bottom" align="center" background="../../graphics/table_bck5.gif"><img SRC="../../graphics/logo.png" border="0"></td>
  <td width="720" bgcolor="#ffffff">
  <div id="content">   
<!-- Start content for this page -->
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<p class="links">
[<a href="msg00208.html">Date Prev</a>] [<a href="msg00210.html">Date Next</a>] [<a href="msg00200.html">Thread Prev</a>] [<a href="msg00210.html">Thread Next</a>]<br>
[<b><a href="maillist.html#00209">Date Index</a></b>]
[<b><a href="threads.html#00209">Thread Index</a></b>]
</p>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: about your solver CVode</h1>
<div class="frame">
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<table border=0 cellpadding=2 cellspacing=0>
<tr>
<td align="right"><b>
<em>From</em></b></td>
<td align="left">
Alan Hindmarsh &lt;<a href="mailto:alanh%40llnl.gov">alanh@llnl.gov</a>&gt;</td>
</tr>

<tr>
<td align="right"><b>
<em>Date</em></b></td>
<td align="left">
Tue, 20 Dec 2005 13:55:50 -0800 (PST)</td>
</tr>

</table>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div>
<div class="container">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>
Hello Pierre-Lin,

Your two solutions are different, but close.  Without knowing the
value of RTOL, I cannot say whether or not they differ by more than
should be expected.  (By the way, your message referred to both
plotted curves as blue, so I don't know which is which, but it does
not matter.)

In any case, for the sake of efficiency, you are much better off
integrating both ODEs together, rather than alternating between the
separate integrations of a single ODE.  Even with careful use of
separate memory blocks, the overhead costs are doubled. For N &gt; 2, the
difference in efficiency is even greater.

Your nearly discontinuous solution (with a big jump around t = .019)
does pose a challenge for accuracy.  You should try a series of RTOL
values that decrease until the change in solution values is acceptably
small.  You may be able to use ATOL = 0, if both components stay well
away from zero (as the plotted one does).

If there is a true discontinuity, you should stop and restart the
solution at that point.  Stopping there would be straightforward if
you know the t value in advance, or would require using the rootfinder
feature otherwise.

By the way, for the sake of letting other users benefit from this
discussion, you should address your messages to sundials-user@llnl.gov.

-Alan Hindmarsh


On Tue, 20 Dec 2005, pommier wrote:

&gt;<i> Hello,</i>
&gt;<i> I am a PhD Student in Natianal Institut of Research in Informatic and</i>
&gt;<i> Automatic (INRIA), France, and I'm working about HCCI combustion. So,</i>
&gt;<i> I'm using your solver CVode in order to solve a differential equation</i>
&gt;<i> y'=f(t,y), y(0)=y0.</i>
&gt;<i> But now, I'd like to solve 2 differential equations y1'=f(t,y1),</i>
&gt;<i> y1(0)=y_{0,1} and y2'=f(t,y2), y2(0)=y_{0,2} every 0.1 crank angle. In</i>
&gt;<i> order to be more precise, I solve the first differential equation on [t1</i>
&gt;<i> t2] then I load y1(t2) in a temporary variable, then I solve the second</i>
&gt;<i> differential equation on [t1 t2] and I load y2(t2) in another temporary</i>
&gt;<i> variable, then I solve the 1st differential equation on [t2 t3] with</i>
&gt;<i> y1(t2) as initial condition and so on.</i>
&gt;<i></i>
&gt;<i> Unfortunately, I haven't got the same solutions if I solve these</i>
&gt;<i> differential equations separetely on [0 tfin] or by this method.</i>
&gt;<i></i>
&gt;<i> I think that my problem comes from a misuse utilisation of your solver</i>
&gt;<i> CVode.</i>
&gt;<i> In enclosure you will find part of my simplified code.</i>
&gt;<i></i>
&gt;<i> With this algorithm, if I have only 1 differential equation, I have the</i>
&gt;<i> same solution as that calculated on [0 tfin], but with this algorithm,</i>
&gt;<i> if I have 2 (or more) differential equations, the solution is different.</i>
&gt;<i></i>
&gt;<i> On figure, the solution blue is that calculated on [0 tfin] and in blue</i>
&gt;<i> is that calculated on [t1 t2] then [t2 t3] and so on.</i>
&gt;<i></i>
&gt;<i> Can you help me please ?</i>
&gt;<i></i>
&gt;<i> Thank you very much of your attention.</i>
&gt;<i></i>
&gt;<i> Cordially,</i>
&gt;<i> Pierre-Lin Pommier</i>

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<div class="container">
<table width="95%" frame="below"><tr><td></td></table>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00208.html">Re: Difficulty building sundials on windows</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00210.html">Debian package of SUNDIALS 2.1.1</a></strong>
</li>

<li>Previous by thread:
<strong><a href="msg00200.html">Difficulty building sundials on windows</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00210.html">Debian package of SUNDIALS 2.1.1</a></strong>
</li>

<li>Index(es):
<ul>
<li><a href="maillist.html#00209">
<strong>Main</strong></a></li>
<li><a href="threads.html#00209">
<strong>Thread</strong></a></li>
</ul>
</li>
</ul>
</div>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<!-- End content for this page -->
  </div>
  </td>
  <td background="../../graphics/table_bck3.gif"></td>
  </tr>
  <tr valign="top">
  <td height="17" background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  <td width="116"><a HREF="http://www.llnl.gov/disclaimer.html" target="_top"><img SRC="../../graphics/line_bl.gif" height="17" width="116" border="0"></a></td>
  <td width="720"><img SRC="../../graphics/line_br.gif" height="17" width="720" border="0"></td>
  <td background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  </tr>
  </table>
</body>
</html>
