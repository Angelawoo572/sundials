<!-- MHonArc v2.6.10 -->
<!--X-Subject: RE: [sundials&#45;users] Question on hangup of Cvodes backward integration -->
<!--X-From-R13: "@nhgn, Y.[." <Y.[.@nhgnNghr.ay> -->
<!--X-Date: Tue, 19 Sep 2006 11:56:01 &#45;0700 -->
<!--X-Message-Id: B636D6447F138C478AA16E69B43CF26C03D20512@elex3.campus.tue.nl -->
<!--X-Content-Type: text/plain -->
<!--X-Head-End-->
<html>
<head>
<title>RE: [sundials-users] Question on hangup of Cvodes backward integration</title>
<meta name="author" content="Radu Serban">
<meta name="description" content="suite of nonlinear differential algebraic equation solvers">
<meta name="keywords" content="SUNDIALS, CVODE, CVODES, IDA, KINSOL">
<meta name="keywords" content="ODE, DAE, sensitivity">
<meta name="keywords" content="differential, algebraic">
<link REL="SHORTCUT ICON" HREF="img/favicon.ico" type="image/x-icon">
<link REL="ICON" HREF="img/favicon.ico" type="image/x-icon">
<link href="../../sundials_styles.css" rel="stylesheet" type="text/css">
<script language="JavaScript">
<!--
homeon = new Image();           homeon.src = "../../graphics/home_buttonH.png";
homeoff = new Image();          homeoff.src = "../../graphics/home_button.png";
descriptionon = new Image();    descriptionon.src = "../../graphics/description_buttonH.png";
descriptionoff = new Image();   descriptionoff.src = "../../graphics/description_button.png";
documentationon = new Image();  documentationon.src = "../../graphics/documentation_buttonH.png";
documentationoff = new Image(); documentationoff.src = "../../graphics/documentation_button.png";
downloadon = new Image();       downloadon.src = "../../graphics/download_buttonH.png";
downloadoff = new Image();      downloadoff.src = "../../graphics/download_button.png";
supporton = new Image();        supporton.src = "../../graphics/support_buttonH.png";
supportoff = new Image();       supportoff.src = "../../graphics/support_button.png";
//-->
</script>
<script src="../../sunjs.js" type="text/javascript" language="javascript1.2"></script>
</head>
<!-- ******************************************************************************** -->
<body>
<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
  <td height="60" background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  <td width="116"><img SRC="../../graphics/head_top_left.png" height="60" width="116" border="0"></td>
  <td width="720"><img SRC="../../graphics/head_mail_top_right.png" height="60" width="720" border="0"></td>
  <td background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  </tr>
  <tr valign="top">
  <td height="127" background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  <td width="116">
    <a href="../../main.html" onMouseOver="img_act('home'); return true;" onMouseOut="img_inact('home'); return true;"><img src="../../graphics/home_button.png" border="0" name="home"></a><br>
    <a href="../../description/description.html" onMouseOver="img_act('description'); return true;" onMouseOut="img_inact('description'); return true;"><img src="../../graphics/description_button.png" border="0" name="description"></a><br>
    <a href="../../documentation/documentation.html" onMouseOver="img_act('documentation'); return true;" onMouseOut="img_inact('documentation'); return true;"><img src="../../graphics/documentation_button.png" border="0" name="documentation"></a><br>
    <a href="../../download/download.html" onMouseOver="img_act('download'); return true;" onMouseOut="img_inact('download'); return true;"><img src="../../graphics/download_button.png" border="0" name="download"></a><br>
    <a href="../../support/support.html" onMouseOver="img_act('support'); return true;" onMouseOut="img_inact('support'); return true;"><img src="../../graphics/support_button.png" border="0" name="support"></a><br>
    <img SRC="../../graphics/line_tl.gif" height="7" width="116" border="0"></td>
  <td width="720">
      <img SRC="../../graphics/head_bottom_right.png" height="120" width="720" border="0"><br>
      <img SRC="../../graphics/line_tr.gif" height="7" width="720" border="0"></td>
  <td background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  </tr>
  <tr valign="top">
  <td background="../../graphics/table_bck3.gif"></td>
  <td width="116" valign="bottom" align="center" background="../../graphics/table_bck5.gif"><img SRC="../../graphics/logo.png" border="0"></td>
  <td width="720" bgcolor="#ffffff">
  <div id="content">   
<!-- Start content for this page -->
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<p class="links">
[<a href="msg00697.html">Date Prev</a>] [<a href="msg00699.html">Date Next</a>] [<a href="msg00697.html">Thread Prev</a>] [<a href="msg00657.html">Thread Next</a>]<br>
[<b><a href="maillist.html#00698">Date Index</a></b>]
[<b><a href="threads.html#00698">Thread Index</a></b>]
</p>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>RE: [sundials-users] Question on hangup of Cvodes backward integration</h1>
<div class="frame">
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<table border=0 cellpadding=2 cellspacing=0>
<tr>
<td align="right"><b>
<em>From</em></b></td>
<td align="left">
&quot;Nauta, K.M.&quot; &lt;<a href="mailto:K.M.Nauta%40tue.nl">K.M.Nauta@tue.nl</a>&gt;</td>
</tr>

<tr>
<td align="right"><b>
<em>Date</em></b></td>
<td align="left">
Tue, 19 Sep 2006 20:54:06 +0200</td>
</tr>

</table>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div>
<div class="container">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>Hi Radu,

I have to use a monitor fn as I need to get the data out (the internal
time series of states). I have managed to circumvent the hangups by
increasing the interpolation points buffer, which works for some reason.

I probably have to go C++ anyway and make something like Henning Schmidt
(this toolbox for biological systems), as I also need the resets to use
for optimization of systems with external inputs (discontinuities), like
Stefan Kerkemeier. I am now using an extra forward pass which is not
very elegant.

Best regards,

Maarten Nauta

-----Original Message-----
From: owner-sundials-users@lists.llnl.gov
[<a  href="mailto:owner-sundials-users@lists.llnl.gov">mailto:owner-sundials-users@lists.llnl.gov</a>] On Behalf Of Radu Serban
Sent: Tuesday, September 19, 2006 6:38 PM
To: sundials-users@llnl.gov
Subject: Re: [sundials-users] Question on hangup of Cvodes backward
integration

Maarten,
I'd also suggest NOT using the monitor function. The implementation
seems to be 
quite fragile and can give trouble, especially on backward runs -- I'll
look 
into it for the next release.
--Radu

Radu Serban wrote:
&gt;<i> Maarten,</i>
&gt;<i> This may be due to the bugs that John Eaton also reported. I've just </i>
&gt;<i> posted a reply to his message with instructions on how to fix these, </i>
&gt;<i> including two patch files, one for CVODE, the other for CVODES. Apply </i>
&gt;<i> the CVODES changes, rebuild sundialsTB, and see if that fixes your</i>
problem.
&gt;<i> --Radu</i>
&gt;<i> </i>
&gt;<i> </i>
&gt;<i> Nauta, K.M. wrote:</i>
&gt;<i>&gt; Hi All,</i>
&gt;<i>&gt;</i>
&gt;<i>&gt;  </i>
&gt;<i>&gt;</i>
&gt;<i>&gt; I have something strange in CVODES + sundialsTB. On some occasions</i>
the 
&gt;<i>&gt; backward integration (cvodeb) gets stuck close to the termination </i>
&gt;<i>&gt; point (not returning from its call). At first I thought it might be </i>
&gt;<i>&gt; some instability or illegal values returned from my ode functions,</i>
but 
&gt;<i>&gt; the behavior is peculiar in the sense that the monitor function </i>
&gt;<i>&gt; continues to be called but no function or Jacobian evaluations are </i>
&gt;<i>&gt; done and the time remains at the same point. My backwards functions </i>
&gt;<i>&gt; are able to generate smooth data beyond the termination point. What </i>
&gt;<i>&gt; could this indicate?. For different trajectories of the same model</i>
the 
&gt;<i>&gt; results are ok, and the forward trajectory is ok as well. I am using </i>
&gt;<i>&gt; the newest versions of cvodes and sundialsTB.    </i>
&gt;<i>&gt;  </i>
&gt;<i>&gt;</i>
&gt;<i>&gt; Maarten Nauta</i>
&gt;<i>&gt;</i>
&gt;<i>&gt; PhD Student</i>
&gt;<i>&gt;</i>
&gt;<i>&gt; Control Systems Group</i>
&gt;<i>&gt;</i>
&gt;<i>&gt; Eindhoven University of Technology</i>
&gt;<i>&gt;</i>
&gt;<i>&gt; Den Dolech 2, 5600 MB Eindhoven</i>
&gt;<i>&gt;</i>
&gt;<i>&gt; Phone: +31 40 2473588</i>
&gt;<i>&gt;</i>
&gt;<i>&gt; Email: k.m.nauta@tue.nl &lt;<a  href="mailto:k.m.nauta@tue.nl">mailto:k.m.nauta@tue.nl</a>&gt;</i>
&gt;<i>&gt;</i>
&gt;<i>&gt;  </i>
&gt;<i>&gt;</i>
&gt;<i> </i>
&gt;<i> </i>
&gt;<i> </i>



</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<div class="container">
<table width="95%" frame="below"><tr><td></td></table>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00697.html">Re: [sundials-users] Question on hangup of Cvodes backward integration</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00699.html">Re: [sundials-users] gamma and preconditioning</a></strong>
</li>

<li>Previous by thread:
<strong><a href="msg00697.html">Re: [sundials-users] Question on hangup of Cvodes backward integration</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00657.html">[sundials-users] sundialsTB questions will be answered ...</a></strong>
</li>

<li>Index(es):
<ul>
<li><a href="maillist.html#00698">
<strong>Main</strong></a></li>
<li><a href="threads.html#00698">
<strong>Thread</strong></a></li>
</ul>
</li>
</ul>
</div>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<!-- End content for this page -->
  </div>
  </td>
  <td background="../../graphics/table_bck3.gif"></td>
  </tr>
  <tr valign="top">
  <td height="17" background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  <td width="116"><a HREF="http://www.llnl.gov/disclaimer.html" target="_top"><img SRC="../../graphics/line_bl.gif" height="17" width="116" border="0"></a></td>
  <td width="720"><img SRC="../../graphics/line_br.gif" height="17" width="720" border="0"></td>
  <td background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  </tr>
  </table>
</body>
</html>
