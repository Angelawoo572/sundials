<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: [sundials&#45;users] Question about uinsg sundials for problem	will ill&#45;conditinoed Jacobian Matrix -->
<!--X-From-R13: Dnqh Ereona <enqhNyyay.tbi> -->
<!--X-Date: Wed, 26 Jul 2006 10:09:41 &#45;0700 -->
<!--X-Message-Id: 44C7A169.6080402@llnl.gov -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 44B6786F.5050906@mit.edu -->
<!--X-Reference: 44BC0C4E.6040603@llnl.gov -->
<!--X-Reference: 20060718170219.230zrhhoys8g0w8o@www.bu.edu -->
<!--X-Reference: 44BD7D9F.3010001@llnl.gov -->
<!--X-Reference: Pine.A41.4.63.0607211034280.116112@acsrs3.bu.edu -->
<!--X-Reference: 44C4EF32.2090209@llnl.gov -->
<!--X-Reference: 20060726113704.q72vzj0f34ccgwcw@www.bu.edu -->
<!--X-Head-End-->
<html>
<head>
<title>Re: [sundials-users] Question about uinsg sundials for problem	will ill-conditinoed Jacobian Matrix</title>
<meta name="author" content="Radu Serban">
<meta name="description" content="suite of nonlinear differential algebraic equation solvers">
<meta name="keywords" content="SUNDIALS, CVODE, CVODES, IDA, KINSOL">
<meta name="keywords" content="ODE, DAE, sensitivity">
<meta name="keywords" content="differential, algebraic">
<link REL="SHORTCUT ICON" HREF="img/favicon.ico" type="image/x-icon">
<link REL="ICON" HREF="img/favicon.ico" type="image/x-icon">
<link href="../../sundials_styles.css" rel="stylesheet" type="text/css">
<script language="JavaScript">
<!--
homeon = new Image();           homeon.src = "../../graphics/home_buttonH.png";
homeoff = new Image();          homeoff.src = "../../graphics/home_button.png";
descriptionon = new Image();    descriptionon.src = "../../graphics/description_buttonH.png";
descriptionoff = new Image();   descriptionoff.src = "../../graphics/description_button.png";
documentationon = new Image();  documentationon.src = "../../graphics/documentation_buttonH.png";
documentationoff = new Image(); documentationoff.src = "../../graphics/documentation_button.png";
downloadon = new Image();       downloadon.src = "../../graphics/download_buttonH.png";
downloadoff = new Image();      downloadoff.src = "../../graphics/download_button.png";
supporton = new Image();        supporton.src = "../../graphics/support_buttonH.png";
supportoff = new Image();       supportoff.src = "../../graphics/support_button.png";
//-->
</script>
<script src="../../sunjs.js" type="text/javascript" language="javascript1.2"></script>
</head>
<!-- ******************************************************************************** -->
<body>
<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
  <td height="60" background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  <td width="116"><img SRC="../../graphics/head_top_left.png" height="60" width="116" border="0"></td>
  <td width="720"><img SRC="../../graphics/head_mail_top_right.png" height="60" width="720" border="0"></td>
  <td background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  </tr>
  <tr valign="top">
  <td height="127" background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  <td width="116">
    <a href="../../main.html" onMouseOver="img_act('home'); return true;" onMouseOut="img_inact('home'); return true;"><img src="../../graphics/home_button.png" border="0" name="home"></a><br>
    <a href="../../description/description.html" onMouseOver="img_act('description'); return true;" onMouseOut="img_inact('description'); return true;"><img src="../../graphics/description_button.png" border="0" name="description"></a><br>
    <a href="../../documentation/documentation.html" onMouseOver="img_act('documentation'); return true;" onMouseOut="img_inact('documentation'); return true;"><img src="../../graphics/documentation_button.png" border="0" name="documentation"></a><br>
    <a href="../../download/download.html" onMouseOver="img_act('download'); return true;" onMouseOut="img_inact('download'); return true;"><img src="../../graphics/download_button.png" border="0" name="download"></a><br>
    <a href="../../support/support.html" onMouseOver="img_act('support'); return true;" onMouseOut="img_inact('support'); return true;"><img src="../../graphics/support_button.png" border="0" name="support"></a><br>
    <img SRC="../../graphics/line_tl.gif" height="7" width="116" border="0"></td>
  <td width="720">
      <img SRC="../../graphics/head_bottom_right.png" height="120" width="720" border="0"><br>
      <img SRC="../../graphics/line_tr.gif" height="7" width="720" border="0"></td>
  <td background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  </tr>
  <tr valign="top">
  <td background="../../graphics/table_bck3.gif"></td>
  <td width="116" valign="bottom" align="center" background="../../graphics/table_bck5.gif"><img SRC="../../graphics/logo.png" border="0"></td>
  <td width="720" bgcolor="#ffffff">
  <div id="content">   
<!-- Start content for this page -->
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<p class="links">
[<a href="msg00594.html">Date Prev</a>] [<a href="msg00596.html">Date Next</a>] [<a href="msg00594.html">Thread Prev</a>] [<a href="msg00596.html">Thread Next</a>]<br>
[<b><a href="maillist.html#00595">Date Index</a></b>]
[<b><a href="threads.html#00595">Thread Index</a></b>]
</p>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [sundials-users] Question about uinsg sundials for problem	will ill-conditinoed Jacobian Matrix</h1>
<div class="frame">
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<table border=0 cellpadding=2 cellspacing=0>
<tr>
<td align="right"><b>
<em>From</em></b></td>
<td align="left">
Radu Serban &lt;<a href="mailto:radu%40llnl.gov">radu@llnl.gov</a>&gt;</td>
</tr>

<tr>
<td align="right"><b>
<em>Date</em></b></td>
<td align="left">
Wed, 26 Jul 2006 10:07:53 -0700</td>
</tr>

</table>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div>
<div class="container">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<tt>zxd@bu.edu wrote:
</tt><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><tt>  I have another question, what is the difference between using implicit 
or direct ODE solver (IDA, CVODE). I mean mathematically<br>
and numerically? I don't need to inverse the matrix A for IDA,<br>
but is IDA (implicit method) will cause more trouble in stability<br>
and errors?</tt><br>
<br>
<pre style="margin: 0em;">  This is not mentioned in IDA user guide, and I guess it is a
basic knowledge for applied math people :(</pre><br>
<tt>Xuedong
</tt></blockquote><pre style="margin: 0em;"><br>Xuedong,</pre><br>
<tt>You must make the distinction between the form (explicit or implicit) of the ODE and the numerical method (explicit or implicit) used to 
solve it. In short, CVODE works for ODE systems in explicit form, while IDA works for ODE systems in implicit form (and DAE systems). 
However, both CVODE and IDA use an implicit integration methods (Adams or BDF for CVODE, BDF only for IDA).</tt><br>
<br>
<tt><br>A first order ODE is in explicit form if the derivative of the dependent variable can be &quot;explicitly&quot; written as a function of the 
independent variable (time) and the dependent variable itself:<br>
   y' = f(t,y)</tt><br>
<br>
<pre style="margin: 0em;">A first order ODE is in implicit form if the above relationship is given in an 
implicit manner:
   F(t,y,y') = 0</pre><br>
<pre style="margin: 0em;">In your case, the original formulation is in implicit form:
   F(t,y,y') == Ay' - By - x(t) = 0
but can be easily converted to an explicit form by multiplying to the left by 
A^{-1} and rearranging terms:
   y' = f(t,y) == A^{-1} ( By+x(t) )</pre><br>
<tt>Note that any ODE in explicit form can be viewed as an ODE in implicit form:<br>
   F(t,y,y') == y' - f(t,y) = 0<br>
and therefore any problem that could be solved with CVODE could also be solved with IDA (but less efficiently since CVODE takes advantage of 
the explicit form of the ODE).</tt><br>
<br>
<tt><br>Any integration method for an ODE initial value problem (IVP) starts from given values of y_0 at time t=t_0 and computes an approximation 
y_n for y(t_n) based on previous value(s) y_{n-1}, y_{n-2}, ... for n=1,2,...</tt><br>
<br>
<pre style="margin: 0em;">An explicit numerical method could in principle be written as
  y_n = g(t_n, t_{n-1}, t_{n-2}, ... , y_{n-1}, y_{n-2}, ...)</pre><br>
<pre style="margin: 0em;">An implicit numerical method will provide the next approximate y_n in an 
implicit manner:
  G(t_n, t_{n-1}, t_{n-2}, ... , y_n, y_{n-1}, y_{n-2}, ...) = 0
Therefore, y_n is obtain by solving the (generally nonlinear) system G=0.</pre><br>
<tt>The simplest example of explicit (implicit) integration scheme is the forward (backward) Euler method. For an ODE in explicit form (you can 
derive them for one in implicit form yourself), y'=f(t,y), these two methods are:</tt><br>
<br>
<tt>Forward Euler is based on a truncated Taylor series expansion of y(t_n) around t_{n-1}. In other words, it uses a first order forward finite 
difference approximation for the derivative at t_{n-1}:<br>
  y'_{n-1} = [ y_n - y_{n-1} ] / [ t_n - t_{n-1} ]<br>
and therefore<br>
  y_n = y_{n-1} + ( t_n - t_{n-1} ) * f(t_{n-1},y_{n-1})<br>
which is an explicit integration scheme.</tt><br>
<br>
<tt>Backward Euler is based on a truncated Taylor series expansion of y(t_{n-1}) around t_n. In other words, it uses a first order backward 
finite difference approximation for the derivative at t_n:<br>
  y'_n = [ y_n - y_{n-1} ] / [ t_n - t_{n-1} ]<br>
and therefore<br>
  y_n = y_{n-1} + ( t_n - t_{n-1} ) * f(t_n, y_n)<br>
which gives y_n in an implicit manner.<br>
One must solve a nonlinear system (linear only if f(t,y) is linear in its second argument) to obtain y_n.</tt><br>
<br>
<pre style="margin: 0em;"><br></pre><br>
<tt>Implicit integration schemes have much better stability properties than explicit ones (in a nutshell they'll allow you to take much larger 
step sizes), but they are more expensive due to the nonlinear systems that must be solved at each step. These systems can be solved with 
various methods, for example function iteration or Newton methods. The latter further require solutions of linear systems which, in turn, 
can be done with direct or iterative linear solvers.</tt><br>
<br>
<tt>As mentioned before, all integrators in SUNDIALS implement ONLY implicit methods (Adams and BDF for CVODE and CVODES and BDF for IDA). These 
are implemented as adaptive methods (i.e., variable-order, variable-step). As such, when deciding whether to use CVODE or IDA on a given 
problem (assuming it can be formulated both as an explicit form ODE and an implicit form ODE) the only considerations (at least from the 
integrator's point of view) are of efficiency and not accuracy and/or stability.</tt><br>
<br>
<pre style="margin: 0em;"><br>I hope this helps.
--Radu</pre><br>
<pre style="margin: 0em;"><br></pre><br>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<div class="container">
<table width="95%" frame="below"><tr><td></td></table>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00596" href="msg00596.html">Re: [sundials-users] Question about uinsg sundials for problem	will ill-conditinoed Jacobian Matrix</a></strong>
<ul><li><em>From:</em> zxd@bu.edu</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00575" href="msg00575.html">[sundials-users] custom linear solvers for cvodes, and ida</a></strong>
<ul><li><em>From:</em> Xuedong Zhang &lt;zxd@MIT.EDU&gt;</li></ul></li>
<li><strong><a name="00578" href="msg00578.html">Re: [sundials-users] custom linear solvers for cvodes, and ida</a></strong>
<ul><li><em>From:</em> Radu Serban &lt;radu@llnl.gov&gt;</li></ul></li>
<li><strong><a name="00582" href="msg00582.html">Re: [sundials-users] custom linear solvers for cvodes, and ida</a></strong>
<ul><li><em>From:</em> zxd@bu.edu</li></ul></li>
<li><strong><a name="00584" href="msg00584.html">Re: [sundials-users] custom linear solvers for cvodes, and ida</a></strong>
<ul><li><em>From:</em> Radu Serban &lt;radu@llnl.gov&gt;</li></ul></li>
<li><strong><a name="00587" href="msg00587.html">[sundials-users] Question about uinsg sundials for problem will ill-conditinoed Jacobian Matrix</a></strong>
<ul><li><em>From:</em> Xuedong Zhang &lt;zxd@bu.edu&gt;</li></ul></li>
<li><strong><a name="00592" href="msg00592.html">Re: [sundials-users] Question about uinsg sundials for problem will ill-conditinoed Jacobian Matrix</a></strong>
<ul><li><em>From:</em> Radu Serban &lt;radu@llnl.gov&gt;</li></ul></li>
<li><strong><a name="00593" href="msg00593.html">Re: [sundials-users] Question about uinsg sundials for problem	will ill-conditinoed Jacobian Matrix</a></strong>
<ul><li><em>From:</em> zxd@bu.edu</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00594.html">Re: [sundials-users] Question about uinsg sundials for problem will ill-conditinoed Jacobian Matrix</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00596.html">Re: [sundials-users] Question about uinsg sundials for problem	will ill-conditinoed Jacobian Matrix</a></strong>
</li>

<li>Previous by thread:
<strong><a href="msg00594.html">Re: [sundials-users] Question about uinsg sundials for problem will ill-conditinoed Jacobian Matrix</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00596.html">Re: [sundials-users] Question about uinsg sundials for problem	will ill-conditinoed Jacobian Matrix</a></strong>
</li>

<li>Index(es):
<ul>
<li><a href="maillist.html#00595">
<strong>Main</strong></a></li>
<li><a href="threads.html#00595">
<strong>Thread</strong></a></li>
</ul>
</li>
</ul>
</div>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<!-- End content for this page -->
  </div>
  </td>
  <td background="../../graphics/table_bck3.gif"></td>
  </tr>
  <tr valign="top">
  <td height="17" background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  <td width="116"><a HREF="http://www.llnl.gov/disclaimer.html" target="_top"><img SRC="../../graphics/line_bl.gif" height="17" width="116" border="0"></a></td>
  <td width="720"><img SRC="../../graphics/line_br.gif" height="17" width="720" border="0"></td>
  <td background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  </tr>
  </table>
</body>
</html>
