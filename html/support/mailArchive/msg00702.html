<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: Re&#45;4: [sundials&#45;users] performance for chemical kinetic problems -->
<!--X-From-R13: Oyna Vvaqznefu <nynauNyyay.tbi> -->
<!--X-Date: Wed, 20 Sep 2006 15:22:28 &#45;0700 -->
<!--X-Message-Id: Pine.LNX.4.58.0609201521260.28545@tux64.llnl.gov -->
<!--X-Content-Type: text/plain -->
<!--X-Head-End-->
<html>
<head>
<title>Re: Re-4: [sundials-users] performance for chemical kinetic problems</title>
<meta name="author" content="Radu Serban">
<meta name="description" content="suite of nonlinear differential algebraic equation solvers">
<meta name="keywords" content="SUNDIALS, CVODE, CVODES, IDA, KINSOL">
<meta name="keywords" content="ODE, DAE, sensitivity">
<meta name="keywords" content="differential, algebraic">
<link REL="SHORTCUT ICON" HREF="img/favicon.ico" type="image/x-icon">
<link REL="ICON" HREF="img/favicon.ico" type="image/x-icon">
<link href="../../sundials_styles.css" rel="stylesheet" type="text/css">
<script language="JavaScript">
<!--
homeon = new Image();           homeon.src = "../../graphics/home_buttonH.png";
homeoff = new Image();          homeoff.src = "../../graphics/home_button.png";
descriptionon = new Image();    descriptionon.src = "../../graphics/description_buttonH.png";
descriptionoff = new Image();   descriptionoff.src = "../../graphics/description_button.png";
documentationon = new Image();  documentationon.src = "../../graphics/documentation_buttonH.png";
documentationoff = new Image(); documentationoff.src = "../../graphics/documentation_button.png";
downloadon = new Image();       downloadon.src = "../../graphics/download_buttonH.png";
downloadoff = new Image();      downloadoff.src = "../../graphics/download_button.png";
supporton = new Image();        supporton.src = "../../graphics/support_buttonH.png";
supportoff = new Image();       supportoff.src = "../../graphics/support_button.png";
//-->
</script>
<script src="../../sunjs.js" type="text/javascript" language="javascript1.2"></script>
</head>
<!-- ******************************************************************************** -->
<body>
<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
  <td height="60" background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  <td width="116"><img SRC="../../graphics/head_top_left.png" height="60" width="116" border="0"></td>
  <td width="720"><img SRC="../../graphics/head_mail_top_right.png" height="60" width="720" border="0"></td>
  <td background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  </tr>
  <tr valign="top">
  <td height="127" background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  <td width="116">
    <a href="../../main.html" onMouseOver="img_act('home'); return true;" onMouseOut="img_inact('home'); return true;"><img src="../../graphics/home_button.png" border="0" name="home"></a><br>
    <a href="../../description/description.html" onMouseOver="img_act('description'); return true;" onMouseOut="img_inact('description'); return true;"><img src="../../graphics/description_button.png" border="0" name="description"></a><br>
    <a href="../../documentation/documentation.html" onMouseOver="img_act('documentation'); return true;" onMouseOut="img_inact('documentation'); return true;"><img src="../../graphics/documentation_button.png" border="0" name="documentation"></a><br>
    <a href="../../download/download.html" onMouseOver="img_act('download'); return true;" onMouseOut="img_inact('download'); return true;"><img src="../../graphics/download_button.png" border="0" name="download"></a><br>
    <a href="../../support/support.html" onMouseOver="img_act('support'); return true;" onMouseOut="img_inact('support'); return true;"><img src="../../graphics/support_button.png" border="0" name="support"></a><br>
    <img SRC="../../graphics/line_tl.gif" height="7" width="116" border="0"></td>
  <td width="720">
      <img SRC="../../graphics/head_bottom_right.png" height="120" width="720" border="0"><br>
      <img SRC="../../graphics/line_tr.gif" height="7" width="720" border="0"></td>
  <td background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  </tr>
  <tr valign="top">
  <td background="../../graphics/table_bck3.gif"></td>
  <td width="116" valign="bottom" align="center" background="../../graphics/table_bck5.gif"><img SRC="../../graphics/logo.png" border="0"></td>
  <td width="720" bgcolor="#ffffff">
  <div id="content">   
<!-- Start content for this page -->
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<p class="links">
[<a href="msg00701.html">Date Prev</a>] [<a href="msg00703.html">Date Next</a>] [<a href="msg00701.html">Thread Prev</a>] [<a href="msg00703.html">Thread Next</a>]<br>
[<b><a href="maillist.html#00702">Date Index</a></b>]
[<b><a href="threads.html#00702">Thread Index</a></b>]
</p>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: Re-4: [sundials-users] performance for chemical kinetic problems</h1>
<div class="frame">
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<table border=0 cellpadding=2 cellspacing=0>
<tr>
<td align="right"><b>
<em>From</em></b></td>
<td align="left">
Alan Hindmarsh &lt;<a href="mailto:alanh%40llnl.gov">alanh@llnl.gov</a>&gt;</td>
</tr>

<tr>
<td align="right"><b>
<em>Date</em></b></td>
<td align="left">
Wed, 20 Sep 2006 15:22:08 -0700 (PDT)</td>
</tr>

</table>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div>
<div class="container">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>
Hello Michael,

See my replies to your comments interspersed below.

&gt;<i> I'm currently using the diagonal elements of my jacobian only with</i>
&gt;<i> chemical kinetic system with only simple reaction like A &lt;=&gt; B.</i>
&gt;<i></i>
&gt;<i> I think this is a good approximation since the diagonal contains the</i>
&gt;<i> sums of the columns.</i>


I would be very surprized to see a chemical kinetics system in which
the Jacobian is diagonally dominant (hence justifying the use of a
diagonal preconditioner).  Typically, if there is a large rate constant
on the diagonal, there is a corresponding one off the diagonal.
But if it really does work, maybe you should stick with it.

&gt;<i> I also tried using a 2x2 block diagonal, but performave decreased and</i>
&gt;<i> the number of linear convergence failures increased.</i>
&gt;<i></i>
&gt;<i> Using every element of the jacobian is even worse. Very bad performance</i>
&gt;<i> with a lot of linear convergence failures.</i>


A preconditioner that includes more of the Jacobian elements is very
likely to perform better than the diagonal preconditioner.
If it includes all the Jacobian elements, it cannot fail to perform
better. So you must have had a bug in that experiment.


&gt;<i> I'm not shure about the correct value of jcurPtr. I'm not recalulating</i>
&gt;<i> jacobian data and returning *jcurPtr = true yields a minimum in</i>
&gt;<i> convergence errors and runtime.</i>

In the preconditioner setup routine, the computation of J and the setting
of jcur should be dictated by the input value of jok.  If jok = TRUE,
you do not need to recompute J, and can set jcur = FALSE.  If jok = FALSE,
you should recompute J and set jcur = TRUE.  If jok tells you to recompute
but you set jcur = FALSE, you may get into an infinite loop in which the
solver thinks that the Jacobian is not current and needs to be recomputed
before giving up on a failed Newton iteration.

-Alan H

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<div class="container">
<table width="95%" frame="below"><tr><td></td></table>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00703" href="msg00703.html">Re: Re-4: [sundials-users] performance for chemical kinetic problems</a></strong>
<ul><li><em>From:</em> Michael Letzgus &lt;michael.letzgus@uni-bielefeld.de&gt;</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00701.html">Re-4: [sundials-users] performance for chemical kinetic problems</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00703.html">Re: Re-4: [sundials-users] performance for chemical kinetic problems</a></strong>
</li>

<li>Previous by thread:
<strong><a href="msg00701.html">Re-4: [sundials-users] performance for chemical kinetic problems</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00703.html">Re: Re-4: [sundials-users] performance for chemical kinetic problems</a></strong>
</li>

<li>Index(es):
<ul>
<li><a href="maillist.html#00702">
<strong>Main</strong></a></li>
<li><a href="threads.html#00702">
<strong>Thread</strong></a></li>
</ul>
</li>
</ul>
</div>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<!-- End content for this page -->
  </div>
  </td>
  <td background="../../graphics/table_bck3.gif"></td>
  </tr>
  <tr valign="top">
  <td height="17" background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  <td width="116"><a HREF="http://www.llnl.gov/disclaimer.html" target="_top"><img SRC="../../graphics/line_bl.gif" height="17" width="116" border="0"></a></td>
  <td width="720"><img SRC="../../graphics/line_br.gif" height="17" width="720" border="0"></td>
  <td background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  </tr>
  </table>
</body>
</html>
