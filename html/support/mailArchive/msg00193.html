<!-- MHonArc v2.6.10 -->
<!--X-Subject: User access to c_j? -->
<!--X-From-R13: Yriva Zbat <xeybatNfnaqvn.tbi> -->
<!--X-Date: Sun, 11 Dec 2005 01:40:36 &#45;0800 (PST) -->
<!--X-Message-Id: 200512110127.34017.krlong@sandia.gov -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 200512091644.04891.krlong@sandia.gov -->
<!--X-Head-End-->
<html>
<head>
<title>User access to c_j?</title>
<meta name="author" content="Radu Serban">
<meta name="description" content="suite of nonlinear differential algebraic equation solvers">
<meta name="keywords" content="SUNDIALS, CVODE, CVODES, IDA, KINSOL">
<meta name="keywords" content="ODE, DAE, sensitivity">
<meta name="keywords" content="differential, algebraic">
<link REL="SHORTCUT ICON" HREF="img/favicon.ico" type="image/x-icon">
<link REL="ICON" HREF="img/favicon.ico" type="image/x-icon">
<link href="../../sundials_styles.css" rel="stylesheet" type="text/css">
<script language="JavaScript">
<!--
homeon = new Image();           homeon.src = "../../graphics/home_buttonH.png";
homeoff = new Image();          homeoff.src = "../../graphics/home_button.png";
descriptionon = new Image();    descriptionon.src = "../../graphics/description_buttonH.png";
descriptionoff = new Image();   descriptionoff.src = "../../graphics/description_button.png";
documentationon = new Image();  documentationon.src = "../../graphics/documentation_buttonH.png";
documentationoff = new Image(); documentationoff.src = "../../graphics/documentation_button.png";
downloadon = new Image();       downloadon.src = "../../graphics/download_buttonH.png";
downloadoff = new Image();      downloadoff.src = "../../graphics/download_button.png";
supporton = new Image();        supporton.src = "../../graphics/support_buttonH.png";
supportoff = new Image();       supportoff.src = "../../graphics/support_button.png";
//-->
</script>
<script src="../../sunjs.js" type="text/javascript" language="javascript1.2"></script>
</head>
<!-- ******************************************************************************** -->
<body>
<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
  <td height="60" background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  <td width="116"><img SRC="../../graphics/head_top_left.png" height="60" width="116" border="0"></td>
  <td width="720"><img SRC="../../graphics/head_mail_top_right.png" height="60" width="720" border="0"></td>
  <td background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  </tr>
  <tr valign="top">
  <td height="127" background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  <td width="116">
    <a href="../../main.html" onMouseOver="img_act('home'); return true;" onMouseOut="img_inact('home'); return true;"><img src="../../graphics/home_button.png" border="0" name="home"></a><br>
    <a href="../../description/description.html" onMouseOver="img_act('description'); return true;" onMouseOut="img_inact('description'); return true;"><img src="../../graphics/description_button.png" border="0" name="description"></a><br>
    <a href="../../documentation/documentation.html" onMouseOver="img_act('documentation'); return true;" onMouseOut="img_inact('documentation'); return true;"><img src="../../graphics/documentation_button.png" border="0" name="documentation"></a><br>
    <a href="../../download/download.html" onMouseOver="img_act('download'); return true;" onMouseOut="img_inact('download'); return true;"><img src="../../graphics/download_button.png" border="0" name="download"></a><br>
    <a href="../../support/support.html" onMouseOver="img_act('support'); return true;" onMouseOut="img_inact('support'); return true;"><img src="../../graphics/support_button.png" border="0" name="support"></a><br>
    <img SRC="../../graphics/line_tl.gif" height="7" width="116" border="0"></td>
  <td width="720">
      <img SRC="../../graphics/head_bottom_right.png" height="120" width="720" border="0"><br>
      <img SRC="../../graphics/line_tr.gif" height="7" width="720" border="0"></td>
  <td background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  </tr>
  <tr valign="top">
  <td background="../../graphics/table_bck3.gif"></td>
  <td width="116" valign="bottom" align="center" background="../../graphics/table_bck5.gif"><img SRC="../../graphics/logo.png" border="0"></td>
  <td width="720" bgcolor="#ffffff">
  <div id="content">   
<!-- Start content for this page -->
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<p class="links">
[<a href="msg00192.html">Date Prev</a>] [<a href="msg00194.html">Date Next</a>] [<a href="msg00192.html">Thread Prev</a>] [<a href="msg00198.html">Thread Next</a>]<br>
[<b><a href="maillist.html#00193">Date Index</a></b>]
[<b><a href="threads.html#00193">Thread Index</a></b>]
</p>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>User access to c_j?</h1>
<div class="frame">
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<table border=0 cellpadding=2 cellspacing=0>
<tr>
<td align="right"><b>
<em>From</em></b></td>
<td align="left">
Kevin Long &lt;<a href="mailto:krlong%40sandia.gov">krlong@sandia.gov</a>&gt;</td>
</tr>

<tr>
<td align="right"><b>
<em>Date</em></b></td>
<td align="left">
Sun, 11 Dec 2005 01:27:33 -0800</td>
</tr>

</table>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div>
<div class="container">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>
Hi,

After a good day's work I've now got SUNDIALS and Trilinos working together 
using the SUNDIALS GMRES solver and the Trilinos abstract vector library. It 
was pretty easy, once I read the documentation carefully enough to realize 
that N_VConstrMask should set w[i]=1 when the constraint test *fails*, not 
when it *passes* as I'd have guessed :-). Congratulations on a well-designed 
and well-documented vector interface; it was quite easy to figure out, and I 
had some simple test problems running with Trilinos/SUNDIALS pretty quickly.

My next job, though, is to write an lsolve() function that talks to Trilinos 
linear solvers, and represents Jacobians as Trilinos linear operators. The 
problem I immediately ran into is that to build a problem's Jacobian I need 
c_j and the current time, which are not supplied directly as arguments in 
either the lsolve() or lsetup() interfaces. They are available as fields in 
the IDAMem struct given as the first to lsolve() and lsetup(), but to compile 
any code referring to IDAMem I need access to the header file ida_impl.h. 
Unfortunately, ida_impl.h lives in the ida source directory and is not among 
those installed into the include directory upon &quot;make install&quot;. 

Thus, I don't see how to do any external solver interface in a clean way. 
There are plenty of hacks that will work -- modifying the SUNDIALS 
configuration to install ida_impl.h for instance, or modifying the Trilinos 
configuration to look for headers in the SUNDIALS source directory in 
addition to the installed include directory -- but while such hacks are 
temporarily OK for me while writing code to test things out, it's not how 
we'd want a production Trilinos (or Petsc, or whatever) SUNDIALS interface to 
work. We *should* be able to configure/make/install SUNDIALS, then have 
Trilinos point to the SUNDIALS installation directory.

I can think of a few solutions:

(1) Install ida_impl.h so that it's accessible to people writing external 
solver interfaces. Or, at least put the declaration of the IDAMem struct in 
the ida.h header.

(2) Provide user-callable functions to access c_j and whatever else is needed 
by an external solver interface writer (one already exists to get the current 
time). This is probably a better solution as it doesn't require the solver 
writer to inspect the guts of IDA's data structures as would be required by 
proposed solution 1 above. 

Any other solutions? Is there some easy way to do this I'm missing? Surely I'm 
not the first person to try writing an interface to an external solver?

There's a good deal of interest at Sandia in using SUNDIALS for time 
integration along with the linear solvers in Trilinos, but to have anyone 
other than me and a few other diehard hackers use such a system, we'll have 
to have it working with SUNDIALS as installed out of the box. So any help you 
can provide with cleaning up this interface will be appreciated.

Thanks,

- kevin



</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<div class="container">
<table width="95%" frame="below"><tr><td></td></table>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00198" href="msg00198.html">Re: User access to c_j?</a></strong>
<ul><li><em>From:</em> Alan Hindmarsh &lt;alanh@llnl.gov&gt;</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00192" href="msg00192.html">N_Vector &amp; solver module unit test suite?</a></strong>
<ul><li><em>From:</em> Kevin Long &lt;krlong@sandia.gov&gt;</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00192.html">N_Vector &amp; solver module unit test suite?</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00194.html">Re: must N_VSpace return an exact result?</a></strong>
</li>

<li>Previous by thread:
<strong><a href="msg00192.html">N_Vector &amp; solver module unit test suite?</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00198.html">Re: User access to c_j?</a></strong>
</li>

<li>Index(es):
<ul>
<li><a href="maillist.html#00193">
<strong>Main</strong></a></li>
<li><a href="threads.html#00193">
<strong>Thread</strong></a></li>
</ul>
</li>
</ul>
</div>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<!-- End content for this page -->
  </div>
  </td>
  <td background="../../graphics/table_bck3.gif"></td>
  </tr>
  <tr valign="top">
  <td height="17" background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  <td width="116"><a HREF="http://www.llnl.gov/disclaimer.html" target="_top"><img SRC="../../graphics/line_bl.gif" height="17" width="116" border="0"></a></td>
  <td width="720"><img SRC="../../graphics/line_br.gif" height="17" width="720" border="0"></td>
  <td background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  </tr>
  </table>
</body>
</html>
