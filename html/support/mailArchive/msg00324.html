<!-- MHonArc v2.6.10 -->
<!--X-Subject: RE: [sundials&#45;users] sundialsTB -->
<!--X-From-R13: "Qnb, Kv" <K.QnbNpenasvryq.np.hx> -->
<!--X-Date: Tue, 28 Feb 2006 10:25:16 &#45;0800 (PST) -->
<!--X-Message-Id: 8B8B9A8EAFB80D4783EC4EE210951B4502621CFD@ccexchange&#45;3.cns.cranfield.ac.uk -->
<!--X-Content-Type: text/plain -->
<!--X-Head-End-->
<html>
<head>
<title>RE: [sundials-users] sundialsTB</title>
<meta name="author" content="Radu Serban">
<meta name="description" content="suite of nonlinear differential algebraic equation solvers">
<meta name="keywords" content="SUNDIALS, CVODE, CVODES, IDA, KINSOL">
<meta name="keywords" content="ODE, DAE, sensitivity">
<meta name="keywords" content="differential, algebraic">
<link REL="SHORTCUT ICON" HREF="img/favicon.ico" type="image/x-icon">
<link REL="ICON" HREF="img/favicon.ico" type="image/x-icon">
<link href="../../sundials_styles.css" rel="stylesheet" type="text/css">
<script language="JavaScript">
<!--
homeon = new Image();           homeon.src = "../../graphics/home_buttonH.png";
homeoff = new Image();          homeoff.src = "../../graphics/home_button.png";
descriptionon = new Image();    descriptionon.src = "../../graphics/description_buttonH.png";
descriptionoff = new Image();   descriptionoff.src = "../../graphics/description_button.png";
documentationon = new Image();  documentationon.src = "../../graphics/documentation_buttonH.png";
documentationoff = new Image(); documentationoff.src = "../../graphics/documentation_button.png";
downloadon = new Image();       downloadon.src = "../../graphics/download_buttonH.png";
downloadoff = new Image();      downloadoff.src = "../../graphics/download_button.png";
supporton = new Image();        supporton.src = "../../graphics/support_buttonH.png";
supportoff = new Image();       supportoff.src = "../../graphics/support_button.png";
//-->
</script>
<script src="../../sunjs.js" type="text/javascript" language="javascript1.2"></script>
</head>
<!-- ******************************************************************************** -->
<body>
<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
  <td height="60" background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  <td width="116"><img SRC="../../graphics/head_top_left.png" height="60" width="116" border="0"></td>
  <td width="720"><img SRC="../../graphics/head_mail_top_right.png" height="60" width="720" border="0"></td>
  <td background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  </tr>
  <tr valign="top">
  <td height="127" background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  <td width="116">
    <a href="../../main.html" onMouseOver="img_act('home'); return true;" onMouseOut="img_inact('home'); return true;"><img src="../../graphics/home_button.png" border="0" name="home"></a><br>
    <a href="../../description/description.html" onMouseOver="img_act('description'); return true;" onMouseOut="img_inact('description'); return true;"><img src="../../graphics/description_button.png" border="0" name="description"></a><br>
    <a href="../../documentation/documentation.html" onMouseOver="img_act('documentation'); return true;" onMouseOut="img_inact('documentation'); return true;"><img src="../../graphics/documentation_button.png" border="0" name="documentation"></a><br>
    <a href="../../download/download.html" onMouseOver="img_act('download'); return true;" onMouseOut="img_inact('download'); return true;"><img src="../../graphics/download_button.png" border="0" name="download"></a><br>
    <a href="../../support/support.html" onMouseOver="img_act('support'); return true;" onMouseOut="img_inact('support'); return true;"><img src="../../graphics/support_button.png" border="0" name="support"></a><br>
    <img SRC="../../graphics/line_tl.gif" height="7" width="116" border="0"></td>
  <td width="720">
      <img SRC="../../graphics/head_bottom_right.png" height="120" width="720" border="0"><br>
      <img SRC="../../graphics/line_tr.gif" height="7" width="720" border="0"></td>
  <td background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  </tr>
  <tr valign="top">
  <td background="../../graphics/table_bck3.gif"></td>
  <td width="116" valign="bottom" align="center" background="../../graphics/table_bck5.gif"><img SRC="../../graphics/logo.png" border="0"></td>
  <td width="720" bgcolor="#ffffff">
  <div id="content">   
<!-- Start content for this page -->
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<p class="links">
[<a href="msg00323.html">Date Prev</a>] [<a href="msg00325.html">Date Next</a>] [<a href="msg00323.html">Thread Prev</a>] [<a href="msg00325.html">Thread Next</a>]<br>
[<b><a href="maillist.html#00324">Date Index</a></b>]
[<b><a href="threads.html#00324">Thread Index</a></b>]
</p>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>RE: [sundials-users] sundialsTB</h1>
<div class="frame">
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<table border=0 cellpadding=2 cellspacing=0>
<tr>
<td align="right"><b>
<em>From</em></b></td>
<td align="left">
&quot;Cao, Yi&quot; &lt;<a href="mailto:Y.Cao%40cranfield.ac.uk">Y.Cao@cranfield.ac.uk</a>&gt;</td>
</tr>

<tr>
<td align="right"><b>
<em>Date</em></b></td>
<td align="left">
Tue, 28 Feb 2006 18:19:52 +0000</td>
</tr>

</table>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div>
<div class="container">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>Here are the results,

1. Yes, I confirm it happens in KinSol.
2.  36 calls before the sigfault.
3. After taking out these two from options, we still have the sigfault. But, 
kindiag_sys gets 167 calls before the sigfaults.

Yi

-----Original Message-----
From: owner-sundials-users@lists.llnl.gov 
[<a  href="mailto:owner-sundials-users@lists.llnl.gov">mailto:owner-sundials-users@lists.llnl.gov</a>] On Behalf Of Radu Serban
Sent: 28 February 2006 16:10
To: sundials-users@llnl.gov
Subject: Re: [sundials-users] sundialsTB

Cao, Yi wrote:
&gt;<i> Thanks. I got it. However, I found another bug with kindiag example. It </i>
&gt;<i> produces segment error as well.</i>
&gt;<i>  </i>

This one I cannot reproduce... I'll need your help in tracing it.

I assume it happens in KINSol (can you confirm?) Can you add a print statement 
in kindiag_sys and check how many times the function gets called before the 
sigfault?
Can you also try to take out the preconditioner setup and solve functions from 
the options structure and see if that fixes it?

--Radu

&gt;<i> Yi Cao</i>
&gt;<i> </i>
&gt;<i> ________________________________</i>
&gt;<i> </i>
&gt;<i> From: owner-sundials-users@lists.llnl.gov on behalf of Radu Serban</i>
&gt;<i> Sent: Mon 27/02/2006 21:13</i>
&gt;<i> To: sundials-users@llnl.gov</i>
&gt;<i> Subject: Re: [sundials-users] sundialsTB</i>
&gt;<i> </i>
&gt;<i> </i>
&gt;<i> </i>
&gt;<i> Cao, Yi wrote:</i>
&gt;<i> </i>
&gt;<i>&gt;Thanks for the suggestion. But I cannot find the cvm_rhsS1.m attached. Did </i>
&gt;<i>&gt;you forget it?</i>
&gt;<i>&gt;</i>
&gt;<i> </i>
&gt;<i> </i>
&gt;<i> Of course! This file just doesn't want to get to the users :-) --Radu</i>
&gt;<i> </i>
&gt;<i> </i>
&gt;<i>&gt;Yi Cao</i>
&gt;<i>&gt;</i>
&gt;<i>&gt;________________________________</i>
&gt;<i>&gt;</i>
&gt;<i>&gt;From: owner-sundials-users@lists.llnl.gov on behalf of Radu Serban</i>
&gt;<i>&gt;Sent: Mon 27/02/2006 19:42</i>
&gt;<i>&gt;To: sundials-users@llnl.gov</i>
&gt;<i>&gt;Subject: Re: [sundials-users] sundialsTB</i>
&gt;<i>&gt;</i>
&gt;<i>&gt;</i>
&gt;<i>&gt;</i>
&gt;<i>&gt;Cao, Yi wrote:</i>
&gt;<i>&gt;</i>
&gt;<i>&gt;</i>
&gt;<i>&gt;&gt;I downloaded and compiled sundialsTB in MATLAB on a Windows XP PC.</i>
&gt;<i>&gt;&gt;Everything looks fine. However, some examples will cause Segmentation </i>
&gt;<i>&gt;&gt;violation error and some examples complain dimensional error or some </i>
&gt;<i>&gt;&gt;function cannot be found (for example, cvm_rhsS1 called from cvfdx). </i>
&gt;<i>&gt;&gt;Is there an bug-free copy around?</i>
&gt;<i>&gt;&gt;</i>
&gt;<i>&gt;&gt;Yi Cao</i>
&gt;<i>&gt;&gt;</i>
&gt;<i>&gt;&gt;</i>
&gt;<i>&gt;</i>
&gt;<i>&gt;</i>
&gt;<i>&gt;</i>
&gt;<i>&gt;sundialsTB has not received a lot of mail, so I did not bother keeping </i>
&gt;<i>&gt;the release CVS branch up-to-date. All bug fixes and updates were done </i>
&gt;<i>&gt;only on the development branch, so they'll be available in the next release </i>
&gt;<i>&gt;only.</i>
&gt;<i>&gt;</i>
&gt;<i>&gt;The cvm_rhsS1.m file was left out of the distribution tarball. It is </i>
&gt;<i>&gt;attached to this message. Save it under sundialsTB/mex/cvm.</i>
&gt;<i>&gt;</i>
&gt;<i>&gt;The segfault error you see is - I assume - in the cvbx example. The </i>
&gt;<i>&gt;reason for that is a buggy implementation of CVodeMonitor which cannot </i>
&gt;<i>&gt;work if other figures are open while CVodeMonitor gets called (notice </i>
&gt;<i>&gt;that no other examples attempt that). The new release will contained a fixed </i>
&gt;<i>&gt;CVodeMonitor function. In the meantime, to make cvbx work, there are two </i>
&gt;<i>&gt;options:</i>
&gt;<i>&gt;</i>
&gt;<i>&gt;a) do not do monitoring; i.e. comment out the line</i>
&gt;<i>&gt;</i>
&gt;<i>&gt;   options = CVodeSetOptions(options,'MonitorFn','CVodeMonitor');</i>
&gt;<i>&gt;</i>
&gt;<i>&gt;b) do not plot additional stuff; i.e. comment out the lines</i>
&gt;<i>&gt;</i>
&gt;<i>&gt;   fig=figure;</i>
&gt;<i>&gt;   hold on;</i>
&gt;<i>&gt;   box</i>
&gt;<i>&gt;</i>
&gt;<i>&gt;and</i>
&gt;<i>&gt;</i>
&gt;<i>&gt;   figure(fig);</i>
&gt;<i>&gt;   plot([t_old t],[uavg_old uavg]);</i>
&gt;<i>&gt;   plot([t0 tout], [q q]/(tout-t0), 'r-');</i>
&gt;<i>&gt;   plot([tout tout], [0 q]/(tout-t0), 'r-');</i>
&gt;<i>&gt;</i>
&gt;<i>&gt;</i>
&gt;<i>&gt;-- Radu</i>
&gt;<i>&gt;</i>
&gt;<i>&gt;</i>
&gt;<i>&gt;</i>
&gt;<i> </i>
&gt;<i> </i>
&gt;<i> </i>
&gt;<i> </i>
&gt;<i> </i>




</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<div class="container">
<table width="95%" frame="below"><tr><td></td></table>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00323.html">Re: [sundials-users] sundialsTB</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00325.html">[sundials-users] Installing/checking sundials 2.1.1</a></strong>
</li>

<li>Previous by thread:
<strong><a href="msg00323.html">Re: [sundials-users] sundialsTB</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00325.html">[sundials-users] Installing/checking sundials 2.1.1</a></strong>
</li>

<li>Index(es):
<ul>
<li><a href="maillist.html#00324">
<strong>Main</strong></a></li>
<li><a href="threads.html#00324">
<strong>Thread</strong></a></li>
</ul>
</li>
</ul>
</div>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<!-- End content for this page -->
  </div>
  </td>
  <td background="../../graphics/table_bck3.gif"></td>
  </tr>
  <tr valign="top">
  <td height="17" background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  <td width="116"><a HREF="http://www.llnl.gov/disclaimer.html" target="_top"><img SRC="../../graphics/line_bl.gif" height="17" width="116" border="0"></a></td>
  <td width="720"><img SRC="../../graphics/line_br.gif" height="17" width="720" border="0"></td>
  <td background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  </tr>
  </table>
</body>
</html>
