<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: [sundials&#45;users] custom linear solvers for cvodes, and ida -->
<!--X-From-R13: Oyna Vvaqznefu <nynauNyyay.tbi> -->
<!--X-Date: Tue, 18 Jul 2006 17:23:43 &#45;0700 -->
<!--X-Message-Id: Pine.LNX.4.58.0607181711210.27337@tux64.llnl.gov -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 44B6786F.5050906@mit.edu -->
<!--X-Reference: 44BC0C4E.6040603@llnl.gov -->
<!--X-Reference: 20060718170219.230zrhhoys8g0w8o@www.bu.edu -->
<!--X-Head-End-->
<html>
<head>
<title>Re: [sundials-users] custom linear solvers for cvodes, and ida</title>
<meta name="author" content="Radu Serban">
<meta name="description" content="suite of nonlinear differential algebraic equation solvers">
<meta name="keywords" content="SUNDIALS, CVODE, CVODES, IDA, KINSOL">
<meta name="keywords" content="ODE, DAE, sensitivity">
<meta name="keywords" content="differential, algebraic">
<link REL="SHORTCUT ICON" HREF="img/favicon.ico" type="image/x-icon">
<link REL="ICON" HREF="img/favicon.ico" type="image/x-icon">
<link href="../../sundials_styles.css" rel="stylesheet" type="text/css">
<script language="JavaScript">
<!--
homeon = new Image();           homeon.src = "../../graphics/home_buttonH.png";
homeoff = new Image();          homeoff.src = "../../graphics/home_button.png";
descriptionon = new Image();    descriptionon.src = "../../graphics/description_buttonH.png";
descriptionoff = new Image();   descriptionoff.src = "../../graphics/description_button.png";
documentationon = new Image();  documentationon.src = "../../graphics/documentation_buttonH.png";
documentationoff = new Image(); documentationoff.src = "../../graphics/documentation_button.png";
downloadon = new Image();       downloadon.src = "../../graphics/download_buttonH.png";
downloadoff = new Image();      downloadoff.src = "../../graphics/download_button.png";
supporton = new Image();        supporton.src = "../../graphics/support_buttonH.png";
supportoff = new Image();       supportoff.src = "../../graphics/support_button.png";
//-->
</script>
<script src="../../sunjs.js" type="text/javascript" language="javascript1.2"></script>
</head>
<!-- ******************************************************************************** -->
<body>
<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
  <td height="60" background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  <td width="116"><img SRC="../../graphics/head_top_left.png" height="60" width="116" border="0"></td>
  <td width="720"><img SRC="../../graphics/head_mail_top_right.png" height="60" width="720" border="0"></td>
  <td background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  </tr>
  <tr valign="top">
  <td height="127" background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  <td width="116">
    <a href="../../main.html" onMouseOver="img_act('home'); return true;" onMouseOut="img_inact('home'); return true;"><img src="../../graphics/home_button.png" border="0" name="home"></a><br>
    <a href="../../description/description.html" onMouseOver="img_act('description'); return true;" onMouseOut="img_inact('description'); return true;"><img src="../../graphics/description_button.png" border="0" name="description"></a><br>
    <a href="../../documentation/documentation.html" onMouseOver="img_act('documentation'); return true;" onMouseOut="img_inact('documentation'); return true;"><img src="../../graphics/documentation_button.png" border="0" name="documentation"></a><br>
    <a href="../../download/download.html" onMouseOver="img_act('download'); return true;" onMouseOut="img_inact('download'); return true;"><img src="../../graphics/download_button.png" border="0" name="download"></a><br>
    <a href="../../support/support.html" onMouseOver="img_act('support'); return true;" onMouseOut="img_inact('support'); return true;"><img src="../../graphics/support_button.png" border="0" name="support"></a><br>
    <img SRC="../../graphics/line_tl.gif" height="7" width="116" border="0"></td>
  <td width="720">
      <img SRC="../../graphics/head_bottom_right.png" height="120" width="720" border="0"><br>
      <img SRC="../../graphics/line_tr.gif" height="7" width="720" border="0"></td>
  <td background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  </tr>
  <tr valign="top">
  <td background="../../graphics/table_bck3.gif"></td>
  <td width="116" valign="bottom" align="center" background="../../graphics/table_bck5.gif"><img SRC="../../graphics/logo.png" border="0"></td>
  <td width="720" bgcolor="#ffffff">
  <div id="content">   
<!-- Start content for this page -->
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<p class="links">
[<a href="msg00582.html">Date Prev</a>] [<a href="msg00584.html">Date Next</a>] [<a href="msg00582.html">Thread Prev</a>] [<a href="msg00586.html">Thread Next</a>]<br>
[<b><a href="maillist.html#00583">Date Index</a></b>]
[<b><a href="threads.html#00583">Thread Index</a></b>]
</p>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [sundials-users] custom linear solvers for cvodes, and ida</h1>
<div class="frame">
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<table border=0 cellpadding=2 cellspacing=0>
<tr>
<td align="right"><b>
<em>From</em></b></td>
<td align="left">
Alan Hindmarsh &lt;<a href="mailto:alanh%40llnl.gov">alanh@llnl.gov</a>&gt;</td>
</tr>

<tr>
<td align="right"><b>
<em>Date</em></b></td>
<td align="left">
Tue, 18 Jul 2006 17:14:19 -0700 (PDT)</td>
</tr>

</table>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div>
<div class="container">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>Hello Xuedong,

To elaborate a little on Radu's reply:

First, if your problem is really y'' = f(y,y',t), it is not an IDA
problem.  It becomes a CVODE problem by defining the vector
z = (y,y').  It is inefficient to use a DAE solver for an ODE system.
However, if your problem is Ay'' = f with a nontrivial matrix A, then
IDA may be the better choice, depending on the complexity of A.
CVODE is still a candidate, with A^{-1}f being evaluated every time
the right-hand side is called for, if you can find an efficient way of
computing that.  If A is constant and not too large, probably a dense
or banded LU treatment is best.

Second, there are a few solvers available that treat such a second
order ODE system directly (not as a first-order system).  But they
are very few.  If you can find one, try it and compare with the
CVODE or IDA solution.  The comparison may be enlightening.

Thirdly, a fundamental issue is whether or not the solution method
needs to be implicit -- that is, whether it needs to make use of the
Jacobian blocks df/dy and df/dy'.  If the system does not have decay
modes with small time constants, the chances are that an implicit
solution method is not needed.  In that case, a solution with CVODE,
with the nonstiff option (Adams method + Functional iteration), makes
the most sense.  Then there is no need for a special linear solver,
only the solver to compute A{-1}f efficiently, in the case Ay'' = f.

The purpose of the various linear solver modules in CVODE etc. is to
exploit the particular sparsity structure of the Jacobian in the cases
where an implicit method is called for.  For y'' = f, defining
z = (y,y'), the Jacobian is the block matrix

    (   0      I    )
J = (               )
    ( df/dy  df/dy' )

If y is a vector of length N, and the 2N-vector z is ordered in a
different way [e.g. z = (y_1, y'_1, y_2, y'_2, ...)], then of course J
is instead a permutation of the above.

But you have said nothing about the sparsity structures of df/dy or
df/dy'.  So a specialized linear solver module for this problem would
have to have two things:
  (a) the knowledge of which components of z are 'positions' (from y) and
  which are 'velocities' (from y'), as Radu pointed out, and
  (b) information about the structure of df/dy and df/dy' to be
  assumed (dense, banded, other sparse, etc. ).
If one of the two natural choices for z is adopted, then the knowledge
in (a) would follow from the knowledge of which of those choices was
made.  The best choice depends on various things.  For example, if N
is large and the blocks df/dy and df/dy' are banded, the second choice
seems best, and the existing banded linear solver would exploit the
structure of J about as well as could be done with any special module.
If N is not large, there is not much to gain, and the existing dense
solver is probably best.  There are many other possibilities, of course.

-Alan Hindmarsh




On Tue, 18 Jul 2006 zxd@bu.edu wrote:

&gt;<i> This is may be specific but it is also very general for a</i>
&gt;<i> variety of problems. e.g. for many mechanical system</i>
&gt;<i> (each component may be specified by p,v).</i>
&gt;<i></i>
&gt;<i> In this case, in stead of problem of 2n x 2n, it only need solve the</i>
&gt;<i> problem with n x n size, both for direct linear solver and iterative</i>
&gt;<i> linear solver, so the advantage is obvious.</i>
&gt;<i></i>
&gt;<i> This is because the Jac Matrix is very structured:</i>
&gt;<i> If this system can be described as Ay'' + By' +Cy = 0.</i>
&gt;<i> The Jac matrix for u' and u (u = [p, v] is [I, O; O A], [O I; C B]</i>
&gt;<i> separately. And it is easily to cut the problem size in half.</i>
&gt;<i></i>
&gt;<i></i>
&gt;<i> &gt; Xuedong,</i>
&gt;<i> &gt; Such a linear solver would require knowledge of the 'type' of</i>
&gt;<i> &gt; variable ('position' or 'velocity') which is not required otherwise</i>
&gt;<i> &gt; and would</i>
&gt;<i> &gt; conflict with one of the design principles for the SUNDIALS solvers</i>
&gt;<i> &gt; (namely that the solvers are data-independent). Of course, you can</i>
&gt;<i> &gt; write</i>
&gt;<i> &gt; your own linear solver and interface it to any of the SUNDIALS</i>
&gt;<i> &gt; solvers. When using a dense Jacobian, a linear solver like the one you</i>
&gt;<i> &gt; suggest, would certainly save memory but probably not a whole lot in</i>
&gt;<i> &gt; terms of efficiency. For an iterative linear solver I do not see any</i>
&gt;<i> &gt; advantages.</i>
&gt;<i> &gt; --Radu</i>
&gt;<i> &gt;</i>
&gt;<i> &gt; --</i>
&gt;<i> &gt;     Radu Serban</i>
&gt;<i> &gt;     Center for Applied Scientific Computing   [email] radu@llnl.gov</i>
&gt;<i> &gt;     Lawrence Livermore National Laboratory    [phone] 925-424-4852</i>
&gt;<i> &gt;     P.O. Box 808, L-560                       [fax]   925-422-6287</i>
&gt;<i> &gt;     Livermore, CA 94551</i>
&gt;<i> &gt;</i>
&gt;<i></i>
&gt;<i></i>
&gt;<i></i>
&gt;<i> --</i>
&gt;<i> Xuedong Zhang</i>
&gt;<i> Research Associate</i>
&gt;<i> Hearing Research Center, Department of Biomedical Engineering</i>
&gt;<i> Boston University</i>
&gt;<i></i>
&gt;<i></i>
&gt;<i></i>

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<div class="container">
<table width="95%" frame="below"><tr><td></td></table>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00586" href="msg00586.html">Re: [sundials-users] custom linear solvers for cvodes, and ida</a></strong>
<ul><li><em>From:</em> Xuedong Zhang &lt;zxd@bu.edu&gt;</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00575" href="msg00575.html">[sundials-users] custom linear solvers for cvodes, and ida</a></strong>
<ul><li><em>From:</em> Xuedong Zhang &lt;zxd@MIT.EDU&gt;</li></ul></li>
<li><strong><a name="00578" href="msg00578.html">Re: [sundials-users] custom linear solvers for cvodes, and ida</a></strong>
<ul><li><em>From:</em> Radu Serban &lt;radu@llnl.gov&gt;</li></ul></li>
<li><strong><a name="00582" href="msg00582.html">Re: [sundials-users] custom linear solvers for cvodes, and ida</a></strong>
<ul><li><em>From:</em> zxd@bu.edu</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00582.html">Re: [sundials-users] custom linear solvers for cvodes, and ida</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00584.html">Re: [sundials-users] custom linear solvers for cvodes, and ida</a></strong>
</li>

<li>Previous by thread:
<strong><a href="msg00582.html">Re: [sundials-users] custom linear solvers for cvodes, and ida</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00586.html">Re: [sundials-users] custom linear solvers for cvodes, and ida</a></strong>
</li>

<li>Index(es):
<ul>
<li><a href="maillist.html#00583">
<strong>Main</strong></a></li>
<li><a href="threads.html#00583">
<strong>Thread</strong></a></li>
</ul>
</li>
</ul>
</div>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<!-- End content for this page -->
  </div>
  </td>
  <td background="../../graphics/table_bck3.gif"></td>
  </tr>
  <tr valign="top">
  <td height="17" background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  <td width="116"><a HREF="http://www.llnl.gov/disclaimer.html" target="_top"><img SRC="../../graphics/line_bl.gif" height="17" width="116" border="0"></a></td>
  <td width="720"><img SRC="../../graphics/line_br.gif" height="17" width="720" border="0"></td>
  <td background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  </tr>
  </table>
</body>
</html>
