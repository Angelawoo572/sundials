<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: [sundials&#45;users] coordinate projection with CVODE -->
<!--X-From-R13: Dnqh Ereona <freona1Nyyay.tbi> -->
<!--X-Date: Wed, 12 Apr 2006 11:53:00 &#45;0700 (PDT) -->
<!--X-Message-Id: 443D4B8A.60508@llnl.gov -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 001001c65def$89486db0$6601a8c0@ShermsNotebook -->
<!--X-Head-End-->
<html>
<head>
<title>Re: [sundials-users] coordinate projection with CVODE</title>
<meta name="author" content="Radu Serban">
<meta name="description" content="suite of nonlinear differential algebraic equation solvers">
<meta name="keywords" content="SUNDIALS, CVODE, CVODES, IDA, KINSOL">
<meta name="keywords" content="ODE, DAE, sensitivity">
<meta name="keywords" content="differential, algebraic">
<link REL="SHORTCUT ICON" HREF="img/favicon.ico" type="image/x-icon">
<link REL="ICON" HREF="img/favicon.ico" type="image/x-icon">
<link href="../../sundials_styles.css" rel="stylesheet" type="text/css">
<script language="JavaScript">
<!--
homeon = new Image();           homeon.src = "../../graphics/home_buttonH.png";
homeoff = new Image();          homeoff.src = "../../graphics/home_button.png";
descriptionon = new Image();    descriptionon.src = "../../graphics/description_buttonH.png";
descriptionoff = new Image();   descriptionoff.src = "../../graphics/description_button.png";
documentationon = new Image();  documentationon.src = "../../graphics/documentation_buttonH.png";
documentationoff = new Image(); documentationoff.src = "../../graphics/documentation_button.png";
downloadon = new Image();       downloadon.src = "../../graphics/download_buttonH.png";
downloadoff = new Image();      downloadoff.src = "../../graphics/download_button.png";
supporton = new Image();        supporton.src = "../../graphics/support_buttonH.png";
supportoff = new Image();       supportoff.src = "../../graphics/support_button.png";
//-->
</script>
<script src="../../sunjs.js" type="text/javascript" language="javascript1.2"></script>
</head>
<!-- ******************************************************************************** -->
<body>
<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
  <td height="60" background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  <td width="116"><img SRC="../../graphics/head_top_left.png" height="60" width="116" border="0"></td>
  <td width="720"><img SRC="../../graphics/head_mail_top_right.png" height="60" width="720" border="0"></td>
  <td background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  </tr>
  <tr valign="top">
  <td height="127" background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  <td width="116">
    <a href="../../main.html" onMouseOver="img_act('home'); return true;" onMouseOut="img_inact('home'); return true;"><img src="../../graphics/home_button.png" border="0" name="home"></a><br>
    <a href="../../description/description.html" onMouseOver="img_act('description'); return true;" onMouseOut="img_inact('description'); return true;"><img src="../../graphics/description_button.png" border="0" name="description"></a><br>
    <a href="../../documentation/documentation.html" onMouseOver="img_act('documentation'); return true;" onMouseOut="img_inact('documentation'); return true;"><img src="../../graphics/documentation_button.png" border="0" name="documentation"></a><br>
    <a href="../../download/download.html" onMouseOver="img_act('download'); return true;" onMouseOut="img_inact('download'); return true;"><img src="../../graphics/download_button.png" border="0" name="download"></a><br>
    <a href="../../support/support.html" onMouseOver="img_act('support'); return true;" onMouseOut="img_inact('support'); return true;"><img src="../../graphics/support_button.png" border="0" name="support"></a><br>
    <img SRC="../../graphics/line_tl.gif" height="7" width="116" border="0"></td>
  <td width="720">
      <img SRC="../../graphics/head_bottom_right.png" height="120" width="720" border="0"><br>
      <img SRC="../../graphics/line_tr.gif" height="7" width="720" border="0"></td>
  <td background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  </tr>
  <tr valign="top">
  <td background="../../graphics/table_bck3.gif"></td>
  <td width="116" valign="bottom" align="center" background="../../graphics/table_bck5.gif"><img SRC="../../graphics/logo.png" border="0"></td>
  <td width="720" bgcolor="#ffffff">
  <div id="content">   
<!-- Start content for this page -->
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<p class="links">
[<a href="msg00436.html">Date Prev</a>] [<a href="msg00438.html">Date Next</a>] [<a href="msg00432.html">Thread Prev</a>] [<a href="msg00422.html">Thread Next</a>]<br>
[<b><a href="maillist.html#00437">Date Index</a></b>]
[<b><a href="threads.html#00437">Thread Index</a></b>]
</p>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [sundials-users] coordinate projection with CVODE</h1>
<div class="frame">
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<table border=0 cellpadding=2 cellspacing=0>
<tr>
<td align="right"><b>
<em>From</em></b></td>
<td align="left">
Radu Serban &lt;<a href="mailto:serban1%40llnl.gov">serban1@llnl.gov</a>&gt;</td>
</tr>

<tr>
<td align="right"><b>
<em>Date</em></b></td>
<td align="left">
Wed, 12 Apr 2006 11:48:42 -0700</td>
</tr>

</table>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div>
<div class="container">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Hi Sherm,</pre><br>
Indeed, Adams still uses Cartesian coordinates and Euler angles with joint-induced constraints for their MBS formalism. I doubt they'll ever 
switch to relative coordinates, but I think they consider switching to Euler parameters for orientation to get rid of the singular 
configurations due to the Euler angles.<br>
<br>
You do raise however an interesting point which, as far as I know, has not been fully investigated: the relationship between the MBS 
formalism and the numerical behavior of the solution method. People (myself included) have looked at taking advantage of the problem 
structure in various formalisms but mostly from an efficiency point of view and I don't know of any study that would help reconcile your 
past experience with stabilized index-2 and relative coordinates and Adam's apparent success with stabilized index-2 and Cartesian coordinates.<br>
<br>
There are also several other methods (which I'm sure you've considered before) that would allow using an off-the-shelf solver such as CVODE 
with no or little modifications: coordinate partitioning (which was successfully used both with Cartesian and relative coordinates), the 
differentiable null space method, coordinate splitting (which actually starts from the stabilized index-2 form), etc. Either the coordinate 
partitioning or the null space method could be (fairly) easy implemented with CVODE to provide a method to compare with.<br>
<br>
<pre style="margin: 0em;">Cheers,
--Radu</pre><br>
Michael Sherman wrote:
<blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">Thanks, Radu. This is intriguing and I would be interested in giving
stabilized index 2 another try, although we still need to put together a
coordinate projection scheme in order to have a &quot;known good&quot; system to
compare with.</pre><br>
<pre style="margin: 0em;">Linda did have us take the algebraic variables out of the error test as you
surmised, but there could well be other improvements in IDA that would
change the outcome. The Adams experience is interesting but hard to
interpret. I don't know what Adams is like today since I have been out of
that business for many years, but it was not a relative-coordinates code
last I knew. It was a 6-dofs-per-rigid-body formulation with joints
introduced by constraints. I've never worked with a formulation like that
but I suspect it has very different numerical behavior than a relative
coordinate formulation. For example, they would have a very large number of
barely coupled coordinates and an almost equal number of constraints. Maybe
that accounts for their success with stabilized index 2? Do you know if they
have switched to relative coordinates?</pre><br>
<br>
<blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em">However, ... modifying CVODE may be the only way to go. But 
that's no mean feat and would result in a solver that<br>
will not benefit from future SUNDIALS developments...
</blockquote><pre style="margin: 0em;"><br></pre><br>
<pre style="margin: 0em;">Well, if we do have to go that route we would certainly try to demonstrate
with concrete results, elegant code and sweet talk that coordinate
projection would be a lovely addition to the CVODE code base :-)</pre><br>
Best regards,<br>
Sherm<br>
 <br>
<br>
<pre style="margin: 0em;">-----Original Message-----
From: owner-sundials-users@lists.llnl.gov
[<a  href="mailto:owner-sundials-users@lists.llnl.gov">mailto:owner-sundials-users@lists.llnl.gov</a>] On Behalf Of Radu Serban
Sent: Tuesday, April 11, 2006 4:45 PM
To: sundials-users@llnl.gov
Subject: Re: [sundials-users] coordinate projection with CVODE</pre><br>
<pre style="margin: 0em;">Hi Sherm,</pre><br>
I don't know what to say, I haven't personally tried the stabilized index-2<br>
formulation on very large systems. However, the version of DASSL 
  that you've tried it with didn't have some features that DASPK3.0 and IDA<br>
now have (such as the option of excluding the algebraic 
variables from the error test - which you may have tried with Linda at that<br>
time). My point is that it shouldn't be all that difficult to 
reconsider it and try it with IDA.<br>
<br>
Moreover, knowing that MSC.Adams has this formulation as an option, I called<br>
a friend of mine who used to work for them. He told me that the 
stabilized index-2 formulation never gave them problems and, as a matter of<br>
fact, is the default formulation in Adams/Engine precisely 
because they found it is more accurate and stable! The only reason why it is<br>
not the default in the other Adams products is only because 
this formulation is a bit more expensive (due to the increased number of<br>
variables and equations) and their typical users prefer faster 
solutions.<br>
<br>
I'm certainly not advocating this formulation over others. My point is that<br>
it'd be much easier to change the formulation rather than the 
solver. However, if this formulation indeed does not work well for real-life<br>
problems than modifying CVODE may be the only way to go. But 
that's no mean feat and would result in a solver that will not benefit from<br>
future SUNDIALS developments...<br>
<br>
<pre style="margin: 0em;">--Radu</pre><br>
<pre style="margin: 0em;">...</pre><br>
<br>
</blockquote><br>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<div class="container">
<table width="95%" frame="below"><tr><td></td></table>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00432" href="msg00432.html">RE: [sundials-users] coordinate projection with CVODE</a></strong>
<ul><li><em>From:</em> Michael Sherman &lt;msherman@stanford.edu&gt;</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00436.html">Re: [sundials-users] Arbitrary precision for sundials solvers?</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00438.html">[sundials-users] KINSOL constraint flag documentation backwards</a></strong>
</li>

<li>Previous by thread:
<strong><a href="msg00432.html">RE: [sundials-users] coordinate projection with CVODE</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00422.html">[sundials-users] problems on examples compiling in vc6.0</a></strong>
</li>

<li>Index(es):
<ul>
<li><a href="maillist.html#00437">
<strong>Main</strong></a></li>
<li><a href="threads.html#00437">
<strong>Thread</strong></a></li>
</ul>
</li>
</ul>
</div>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<!-- End content for this page -->
  </div>
  </td>
  <td background="../../graphics/table_bck3.gif"></td>
  </tr>
  <tr valign="top">
  <td height="17" background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  <td width="116"><a HREF="http://www.llnl.gov/disclaimer.html" target="_top"><img SRC="../../graphics/line_bl.gif" height="17" width="116" border="0"></a></td>
  <td width="720"><img SRC="../../graphics/line_br.gif" height="17" width="720" border="0"></td>
  <td background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  </tr>
  </table>
</body>
</html>
