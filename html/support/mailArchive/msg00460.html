<!-- MHonArc v2.6.10 -->
<!--X-Subject: [sundials&#45;users] Re: Inquiry regarding CVODE -->
<!--X-From-R13: qbgnanNgrpuhavk.grpuavba.np.vy -->
<!--X-Date: Tue, 30 May 2006 13:49:09 &#45;0700 (PDT) -->
<!--X-Message-Id: 1149021746.447cae32de85a@webmail.technion.ac.il -->
<!--X-Content-Type: multipart/mixed -->
<!--X-Reference: 90004056.1148981680079.JavaMail.wwwadmin@phoebe.mathworks.com -->
<!--X-Reference: 447C851C.70405@llnl.gov -->
<!--X-Derived: binJJq44mMnHg.bin -->
<!--X-Head-End-->
<html>
<head>
<title>[sundials-users] Re: Inquiry regarding CVODE</title>
<meta name="author" content="Radu Serban">
<meta name="description" content="suite of nonlinear differential algebraic equation solvers">
<meta name="keywords" content="SUNDIALS, CVODE, CVODES, IDA, KINSOL">
<meta name="keywords" content="ODE, DAE, sensitivity">
<meta name="keywords" content="differential, algebraic">
<link REL="SHORTCUT ICON" HREF="img/favicon.ico" type="image/x-icon">
<link REL="ICON" HREF="img/favicon.ico" type="image/x-icon">
<link href="../../sundials_styles.css" rel="stylesheet" type="text/css">
<script language="JavaScript">
<!--
homeon = new Image();           homeon.src = "../../graphics/home_buttonH.png";
homeoff = new Image();          homeoff.src = "../../graphics/home_button.png";
descriptionon = new Image();    descriptionon.src = "../../graphics/description_buttonH.png";
descriptionoff = new Image();   descriptionoff.src = "../../graphics/description_button.png";
documentationon = new Image();  documentationon.src = "../../graphics/documentation_buttonH.png";
documentationoff = new Image(); documentationoff.src = "../../graphics/documentation_button.png";
downloadon = new Image();       downloadon.src = "../../graphics/download_buttonH.png";
downloadoff = new Image();      downloadoff.src = "../../graphics/download_button.png";
supporton = new Image();        supporton.src = "../../graphics/support_buttonH.png";
supportoff = new Image();       supportoff.src = "../../graphics/support_button.png";
//-->
</script>
<script src="../../sunjs.js" type="text/javascript" language="javascript1.2"></script>
</head>
<!-- ******************************************************************************** -->
<body>
<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
  <td height="60" background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  <td width="116"><img SRC="../../graphics/head_top_left.png" height="60" width="116" border="0"></td>
  <td width="720"><img SRC="../../graphics/head_mail_top_right.png" height="60" width="720" border="0"></td>
  <td background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  </tr>
  <tr valign="top">
  <td height="127" background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  <td width="116">
    <a href="../../main.html" onMouseOver="img_act('home'); return true;" onMouseOut="img_inact('home'); return true;"><img src="../../graphics/home_button.png" border="0" name="home"></a><br>
    <a href="../../description/description.html" onMouseOver="img_act('description'); return true;" onMouseOut="img_inact('description'); return true;"><img src="../../graphics/description_button.png" border="0" name="description"></a><br>
    <a href="../../documentation/documentation.html" onMouseOver="img_act('documentation'); return true;" onMouseOut="img_inact('documentation'); return true;"><img src="../../graphics/documentation_button.png" border="0" name="documentation"></a><br>
    <a href="../../download/download.html" onMouseOver="img_act('download'); return true;" onMouseOut="img_inact('download'); return true;"><img src="../../graphics/download_button.png" border="0" name="download"></a><br>
    <a href="../../support/support.html" onMouseOver="img_act('support'); return true;" onMouseOut="img_inact('support'); return true;"><img src="../../graphics/support_button.png" border="0" name="support"></a><br>
    <img SRC="../../graphics/line_tl.gif" height="7" width="116" border="0"></td>
  <td width="720">
      <img SRC="../../graphics/head_bottom_right.png" height="120" width="720" border="0"><br>
      <img SRC="../../graphics/line_tr.gif" height="7" width="720" border="0"></td>
  <td background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  </tr>
  <tr valign="top">
  <td background="../../graphics/table_bck3.gif"></td>
  <td width="116" valign="bottom" align="center" background="../../graphics/table_bck5.gif"><img SRC="../../graphics/logo.png" border="0"></td>
  <td width="720" bgcolor="#ffffff">
  <div id="content">   
<!-- Start content for this page -->
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<p class="links">
[<a href="msg00459.html">Date Prev</a>] [<a href="msg00461.html">Date Next</a>] [<a href="msg00459.html">Thread Prev</a>] [<a href="msg00463.html">Thread Next</a>]<br>
[<b><a href="maillist.html#00460">Date Index</a></b>]
[<b><a href="threads.html#00460">Thread Index</a></b>]
</p>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>[sundials-users] Re: Inquiry regarding CVODE</h1>
<div class="frame">
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<table border=0 cellpadding=2 cellspacing=0>
<tr>
<td align="right"><b>
<em>From</em></b></td>
<td align="left">
<a href="mailto:dotana%40techunix.technion.ac.il">dotana@techunix.technion.ac.il</a></td>
</tr>

<tr>
<td align="right"><b>
<em>Date</em></b></td>
<td align="left">
Tue, 30 May 2006 23:42:26 +0300</td>
</tr>

</table>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div>
<div class="container">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>Dear Radu,

Thank you for the fast reply.
Actually, my system doesn't arise from PDE discretization. 
Shortly, we developed an analog model for each vessel in the coronary system. It
turns out that the first derivative of the pressure (y') in each vessel depends
(in a non-linear manner) on the pressures of the vessel itself, and of its near
neighbors (2 from each side).
In the attached doc file I illustrated how the matrix A appears for a perfect
tree-like structure (which is a simplification of the real situation). You can
see there that A features non-zero &quot;rays&quot; in 22.5, 45 (diagonal) and 67.5
degrees. I fear it is not a standard banding pattern.
The vector b(t) actually depends on pressure (y) only in the extreme feeding and
draining vessels.

In regards to your reply: 
* How do you overcome the dimensions of the preconditioner (do you supply it in
a dense representation?)
* Is parallelization a must for such a large-scale problem? Can you estimate
roughly how many unknowns can be solved using a PC?

Thanks again, Dotan




Quoting Radu Serban &lt;serban1@llnl.gov&gt;:

&gt;<i> Dotan Algranati wrote:</i>
&gt;<i> &gt; Dear Sir,</i>
&gt;<i> &gt; It is of great honor for me to contact you after reading some of your</i>
&gt;<i> papers.</i>
&gt;<i> &gt; I&#x2019;m a graduate student, investigating the flow in the coronary system (the</i>
&gt;<i> blood vessels feeding the heart). </i>
&gt;<i> &gt; Making it as general as possible, I have a large-scale, stiff, fully</i>
&gt;<i> non-linear ODE system to solve, that can be described as y'=Ay+b, where A and</i>
&gt;<i> b should be updated each time step according to y. A is symmetric, positive</i>
&gt;<i> definite, and sparse (5 elements per row) but poorly banded. The Jacobian</i>
&gt;<i> itself is also sparse and poorly banded. I was able to solve a similar system</i>
&gt;<i> with N~1000 using MATLAB&#x2019;s ode15s, and now I need to solve a system in which</i>
&gt;<i> N is ~ 5*10^6.</i>
&gt;<i> &gt; I thought about trying to solve it with CVODE. In addition, I&#x2019;m not much of</i>
&gt;<i> a programmer, driving me to think about using the MATLAB interface.</i>
&gt;<i> &gt; </i>
&gt;<i> &gt; 1. From your experience, is CVODE the kind of tool I&#x2019;m looking for?</i>
&gt;<i> &gt; 2. How large a problem can I solve with CVODE? I know that ode15s allocates</i>
&gt;<i> an n-by-n Jacobian matrix, restricting me to &#x201C;small&#x201D; systems.</i>
&gt;<i> &gt; 3. What kind of hardware am I looking for?</i>
&gt;<i> &gt; 4. Any other comment would be of great help.</i>
&gt;<i> &gt; </i>
&gt;<i> &gt; Thank you for your time,</i>
&gt;<i> &gt; </i>
&gt;<i> &gt; Dotan Algranati</i>
&gt;<i> &gt; B.Sc. in Biomedical Engineering</i>
&gt;<i> &gt; </i>
&gt;<i> &gt; </i>
&gt;<i> </i>
&gt;<i> Dear Dotan,</i>
&gt;<i> </i>
&gt;<i> Yes, CVODE is the right tool for the type of problem you have. It has been</i>
&gt;<i> routinely used to solve systems with millions of unknowns. That </i>
&gt;<i> being said, the only linear solvers currently provided with SUNDIALS that can</i>
&gt;<i> effectively deal with large-scale systems are the Krylov ones </i>
&gt;<i> which are matrix-free (i.e. never form the Jacobian matrix but rather require</i>
&gt;<i> only Jacobian-vector products) but, for acceptable efficiency, </i>
&gt;<i> require preconditioning. We plan on including a sparse direct linear solver,</i>
&gt;<i> but one is not currently available. There is, of course, the </i>
&gt;<i> option of providing your own linear solver (all SUNDIALS solvers define a</i>
&gt;<i> generic interface to the linear solver module), but that's </i>
&gt;<i> probably more programming that you want.</i>
&gt;<i> </i>
&gt;<i> You say your system is of the form y' = A(y)*y + b(y). While from CVODE's</i>
&gt;<i> point of view this is just y' = f(y) (i.e. for the integration we </i>
&gt;<i> do not assume anything about the structure of the right-hand side), this</i>
&gt;<i> particular form may be useful in building an appropriate </i>
&gt;<i> preconditioner. I suspect your ODE arises from the semi-discretization of</i>
&gt;<i> some PDE. Maybe you can give a few more details on the form of A </i>
&gt;<i> and b? Also, when you say that A (and J) are 'poorly banded', do you mean</i>
&gt;<i> that they are banded but with several sub- and superdiagonals that </i>
&gt;<i> are zero (or could be brought to this form)? If that is the case, you may be</i>
&gt;<i> able to use a modified version of the banded linear solver </i>
&gt;<i> module in CVODE which would explicitly take care of the zero diagonals.</i>
&gt;<i> </i>
&gt;<i> You could certainly use the Matlab interface to CVODES to solve your problem,</i>
&gt;<i> but you need to keep in mind that sundialsTB uses Matlab </i>
&gt;<i> m-files for the main driver and all user-provided functions which will</i>
&gt;<i> negatively impact performance. Moreover, if you want to parallelize </i>
&gt;<i> your code, that will require additional Matlab tools (MPITB) as well as an</i>
&gt;<i> MPI distribution that provides MPI-2 capabilities (LAM or MPICH2).</i>
&gt;<i> </i>
&gt;<i> Finally, SUNDIALS can be built on any platform that provides (at a minimum) a</i>
&gt;<i> C compiler. The easiest installation is on a *NIX platform, </i>
&gt;<i> using the configure script, but SUNDIALS has also been built under Windows</i>
&gt;<i> using various IDEs (look at the FAQ and browse the sundials-users </i>
&gt;<i> mailing list archive for discussions on this topic). For parallel support</i>
&gt;<i> you'll also need an MPI distribution.</i>
&gt;<i> </i>
&gt;<i> --Radu</i>
&gt;<i> </i>
&gt;<i> P.S. I've cc-ed this message to the sundials-users mailing list to which I</i>
&gt;<i> encourage you to post inquiries such as this (you can subscribe </i>
&gt;<i> to the list from the Support page on the SUNDIALS website where you can also</i>
&gt;<i> find an archive of previous messages).</i>
&gt;<i> </i>
&gt;<i> -- </i>
&gt;<i>     Radu Serban</i>
&gt;<i>     Center for Applied Scientific Computing   [email] radu@llnl.gov</i>
&gt;<i>     Lawrence Livermore National Laboratory    [phone] 925-424-4852</i>
&gt;<i>     P.O. Box 808, L-560                       [fax]   925-422-6287</i>
&gt;<i>     Livermore, CA 94551</i>
&gt;<i> </i>


</pre><p><strong>Attachment:
<a href="binJJq44mMnHg.bin" >matrix_representation.doc</a></strong><br>
<em>Description:</em> Binary data</p>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<div class="container">
<table width="95%" frame="below"><tr><td></td></table>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00463" href="msg00463.html">Re: [sundials-users] Re: Inquiry regarding CVODE</a></strong>
<ul><li><em>From:</em> Radu Serban &lt;serban1@llnl.gov&gt;</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00459" href="msg00459.html">[sundials-users] Re: Inquiry regarding CVODE</a></strong>
<ul><li><em>From:</em> Radu Serban &lt;serban1@llnl.gov&gt;</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00459.html">[sundials-users] Re: Inquiry regarding CVODE</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00461.html">[sundials-users] Step sizes for Jacobian approximation</a></strong>
</li>

<li>Previous by thread:
<strong><a href="msg00459.html">[sundials-users] Re: Inquiry regarding CVODE</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00463.html">Re: [sundials-users] Re: Inquiry regarding CVODE</a></strong>
</li>

<li>Index(es):
<ul>
<li><a href="maillist.html#00460">
<strong>Main</strong></a></li>
<li><a href="threads.html#00460">
<strong>Thread</strong></a></li>
</ul>
</li>
</ul>
</div>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<!-- End content for this page -->
  </div>
  </td>
  <td background="../../graphics/table_bck3.gif"></td>
  </tr>
  <tr valign="top">
  <td height="17" background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  <td width="116"><a HREF="http://www.llnl.gov/disclaimer.html" target="_top"><img SRC="../../graphics/line_bl.gif" height="17" width="116" border="0"></a></td>
  <td width="720"><img SRC="../../graphics/line_br.gif" height="17" width="720" border="0"></td>
  <td background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  </tr>
  </table>
</body>
</html>
