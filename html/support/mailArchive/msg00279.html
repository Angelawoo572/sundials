<!-- MHonArc v2.6.10 -->
<!--X-Subject: R: R: [sundials&#45;users] Finite difference Jacobian &#45; information to f() when Jacobian is built -->
<!--X-From-R13: Bnbyb Uerccv 3vB <cnbyb.terccvN3vc.vg> -->
<!--X-Date: Mon, 30 Jan 2006 01:38:57 &#45;0800 (PST) -->
<!--X-Message-Id: 200601300936.k0U9ab4W005176@nospam&#45;3.llnl.gov -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 43DA6374.8030001@llnl.gov -->
<!--X-Head-End-->
<html>
<head>
<title>R: R: [sundials-users] Finite difference Jacobian - information to f() when Jacobian is built</title>
<meta name="author" content="Radu Serban">
<meta name="description" content="suite of nonlinear differential algebraic equation solvers">
<meta name="keywords" content="SUNDIALS, CVODE, CVODES, IDA, KINSOL">
<meta name="keywords" content="ODE, DAE, sensitivity">
<meta name="keywords" content="differential, algebraic">
<link REL="SHORTCUT ICON" HREF="img/favicon.ico" type="image/x-icon">
<link REL="ICON" HREF="img/favicon.ico" type="image/x-icon">
<link href="../../sundials_styles.css" rel="stylesheet" type="text/css">
<script language="JavaScript">
<!--
homeon = new Image();           homeon.src = "../../graphics/home_buttonH.png";
homeoff = new Image();          homeoff.src = "../../graphics/home_button.png";
descriptionon = new Image();    descriptionon.src = "../../graphics/description_buttonH.png";
descriptionoff = new Image();   descriptionoff.src = "../../graphics/description_button.png";
documentationon = new Image();  documentationon.src = "../../graphics/documentation_buttonH.png";
documentationoff = new Image(); documentationoff.src = "../../graphics/documentation_button.png";
downloadon = new Image();       downloadon.src = "../../graphics/download_buttonH.png";
downloadoff = new Image();      downloadoff.src = "../../graphics/download_button.png";
supporton = new Image();        supporton.src = "../../graphics/support_buttonH.png";
supportoff = new Image();       supportoff.src = "../../graphics/support_button.png";
//-->
</script>
<script src="../../sunjs.js" type="text/javascript" language="javascript1.2"></script>
</head>
<!-- ******************************************************************************** -->
<body>
<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
  <td height="60" background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  <td width="116"><img SRC="../../graphics/head_top_left.png" height="60" width="116" border="0"></td>
  <td width="720"><img SRC="../../graphics/head_mail_top_right.png" height="60" width="720" border="0"></td>
  <td background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  </tr>
  <tr valign="top">
  <td height="127" background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  <td width="116">
    <a href="../../main.html" onMouseOver="img_act('home'); return true;" onMouseOut="img_inact('home'); return true;"><img src="../../graphics/home_button.png" border="0" name="home"></a><br>
    <a href="../../description/description.html" onMouseOver="img_act('description'); return true;" onMouseOut="img_inact('description'); return true;"><img src="../../graphics/description_button.png" border="0" name="description"></a><br>
    <a href="../../documentation/documentation.html" onMouseOver="img_act('documentation'); return true;" onMouseOut="img_inact('documentation'); return true;"><img src="../../graphics/documentation_button.png" border="0" name="documentation"></a><br>
    <a href="../../download/download.html" onMouseOver="img_act('download'); return true;" onMouseOut="img_inact('download'); return true;"><img src="../../graphics/download_button.png" border="0" name="download"></a><br>
    <a href="../../support/support.html" onMouseOver="img_act('support'); return true;" onMouseOut="img_inact('support'); return true;"><img src="../../graphics/support_button.png" border="0" name="support"></a><br>
    <img SRC="../../graphics/line_tl.gif" height="7" width="116" border="0"></td>
  <td width="720">
      <img SRC="../../graphics/head_bottom_right.png" height="120" width="720" border="0"><br>
      <img SRC="../../graphics/line_tr.gif" height="7" width="720" border="0"></td>
  <td background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  </tr>
  <tr valign="top">
  <td background="../../graphics/table_bck3.gif"></td>
  <td width="116" valign="bottom" align="center" background="../../graphics/table_bck5.gif"><img SRC="../../graphics/logo.png" border="0"></td>
  <td width="720" bgcolor="#ffffff">
  <div id="content">   
<!-- Start content for this page -->
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<p class="links">
[<a href="msg00278.html">Date Prev</a>] [<a href="msg00280.html">Date Next</a>] [<a href="msg00273.html">Thread Prev</a>] [<a href="msg00272.html">Thread Next</a>]<br>
[<b><a href="maillist.html#00279">Date Index</a></b>]
[<b><a href="threads.html#00279">Thread Index</a></b>]
</p>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>R: R: [sundials-users] Finite difference Jacobian - information to f() when Jacobian is built</h1>
<div class="frame">
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<table border=0 cellpadding=2 cellspacing=0>
<tr>
<td align="right"><b>
<em>From</em></b></td>
<td align="left">
Paolo Greppi 3iP &lt;<a href="mailto:paolo.greppi%403ip.it">paolo.greppi@3ip.it</a>&gt;</td>
</tr>

<tr>
<td align="right"><b>
<em>Date</em></b></td>
<td align="left">
Mon, 30 Jan 2006 10:36:26 +0100</td>
</tr>

</table>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div>
<div class="container">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>When solving complex problems, one often notices that most of the computing
time is spent in some specific function call, required for the evaluation of
certain parameters which appear in the DAE residual.
For example, if you discretize a flow field, and the viscosity is a function
of temperature and composition, this function gets called many times and
ends up absorbing most of the CPU. That's why in CFD sometimes one resorts
to neglecting the composition- and possibly the temperature- dependency of
the properties.
Between zero (considering these parameters constant) and infinity (tracking
rigorously their dependencies on other variables) there are intermediate
solutions, one is replacing them with piece-wise constant approximations
i.e. tearing or &quot;diakoptics&quot;.

See in particular par. 3.3.2 of: Viatcheslav Kulikov, Heiko Briesen, Robert
Grosch, Aidong Yang, Lars von Wedel, Wolfgang Marquardt &quot;Modular dynamic
simulation for integrated particulate processes by means of tool
integration&quot; Chemical Engineering Science 60 (2005) 2069 - 2083, where
tearing is used to glue together several independent dynamic simulations.
Of course assuming the boundary conditions between the units are constant
during the integration step amounts to solving a different problem.

What you proposed as a solution for Andreas moves the problem to the user
code for the jacobian computation, it is also the approach of B.R. Keeping,
E.M.B. Smith, C.C. Pantelides &quot;Improving the Efficiency of DAE Integrators&quot;
Annual AIChE meeting Nov 1993; they suggest computing one part of the
jacobian analytically and the rest by selective broyden update.
This can ONLY be done in the user code and probably provides the best
results.

On the other hand the integrator knows when the jacobian or residual
evaluation has to be computed rigorously and when approximately. It's not my
topic, but I can imagine for error estimation a lazy evaluation of the
residuals is acceptable. And is the jacobian called more than once for a
single integration step? Do we have different requirements for its
approximation?
My post was intended to find out, with some brainstorming from the user
community and the developers, what kind of support is desirable from CVODE
to allow these techniques to be used seamlessly.

Regards,

        Paolo


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<div class="container">
<table width="95%" frame="below"><tr><td></td></table>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00273" href="msg00273.html">Re: R: [sundials-users] Finite difference Jacobian - information to f() when Jacobian is built</a></strong>
<ul><li><em>From:</em> Radu Serban &lt;serban1@llnl.gov&gt;</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00278.html">Re: [sundials-users] Problem reagring Residual function in IDA</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00280.html">[sundials-users] RE: Avoiding discontinuities in y_dot</a></strong>
</li>

<li>Previous by thread:
<strong><a href="msg00273.html">Re: R: [sundials-users] Finite difference Jacobian - information to f() when Jacobian is built</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00272.html">Re: [sundials-users] Finite difference Jacobian - information to f() when Jacobian is built</a></strong>
</li>

<li>Index(es):
<ul>
<li><a href="maillist.html#00279">
<strong>Main</strong></a></li>
<li><a href="threads.html#00279">
<strong>Thread</strong></a></li>
</ul>
</li>
</ul>
</div>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<!-- End content for this page -->
  </div>
  </td>
  <td background="../../graphics/table_bck3.gif"></td>
  </tr>
  <tr valign="top">
  <td height="17" background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  <td width="116"><a HREF="http://www.llnl.gov/disclaimer.html" target="_top"><img SRC="../../graphics/line_bl.gif" height="17" width="116" border="0"></a></td>
  <td width="720"><img SRC="../../graphics/line_br.gif" height="17" width="720" border="0"></td>
  <td background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  </tr>
  </table>
</body>
</html>
