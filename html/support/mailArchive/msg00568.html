<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: [sundials&#45;users] Dependency of solver success from log interval? -->
<!--X-From-R13: Dnqh Ereona <enqhNyyay.tbi> -->
<!--X-Date: Thu, 06 Jul 2006 08:37:15 &#45;0700 -->
<!--X-Message-Id: 44AD2D93.1000104@llnl.gov -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 44AA32C3.1040900@Uni&#45;Koeln.De -->
<!--X-Reference: Pine.LNX.4.58.0607051358010.30670@tux64.llnl.gov -->
<!--X-Reference: 44ACB842.3050602@Uni&#45;Koeln.De -->
<!--X-Head-End-->
<html>
<head>
<title>Re: [sundials-users] Dependency of solver success from log interval?</title>
<meta name="author" content="Radu Serban">
<meta name="description" content="suite of nonlinear differential algebraic equation solvers">
<meta name="keywords" content="SUNDIALS, CVODE, CVODES, IDA, KINSOL">
<meta name="keywords" content="ODE, DAE, sensitivity">
<meta name="keywords" content="differential, algebraic">
<link REL="SHORTCUT ICON" HREF="img/favicon.ico" type="image/x-icon">
<link REL="ICON" HREF="img/favicon.ico" type="image/x-icon">
<link href="../../sundials_styles.css" rel="stylesheet" type="text/css">
<script language="JavaScript">
<!--
homeon = new Image();           homeon.src = "../../graphics/home_buttonH.png";
homeoff = new Image();          homeoff.src = "../../graphics/home_button.png";
descriptionon = new Image();    descriptionon.src = "../../graphics/description_buttonH.png";
descriptionoff = new Image();   descriptionoff.src = "../../graphics/description_button.png";
documentationon = new Image();  documentationon.src = "../../graphics/documentation_buttonH.png";
documentationoff = new Image(); documentationoff.src = "../../graphics/documentation_button.png";
downloadon = new Image();       downloadon.src = "../../graphics/download_buttonH.png";
downloadoff = new Image();      downloadoff.src = "../../graphics/download_button.png";
supporton = new Image();        supporton.src = "../../graphics/support_buttonH.png";
supportoff = new Image();       supportoff.src = "../../graphics/support_button.png";
//-->
</script>
<script src="../../sunjs.js" type="text/javascript" language="javascript1.2"></script>
</head>
<!-- ******************************************************************************** -->
<body>
<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
  <td height="60" background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  <td width="116"><img SRC="../../graphics/head_top_left.png" height="60" width="116" border="0"></td>
  <td width="720"><img SRC="../../graphics/head_mail_top_right.png" height="60" width="720" border="0"></td>
  <td background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  </tr>
  <tr valign="top">
  <td height="127" background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  <td width="116">
    <a href="../../main.html" onMouseOver="img_act('home'); return true;" onMouseOut="img_inact('home'); return true;"><img src="../../graphics/home_button.png" border="0" name="home"></a><br>
    <a href="../../description/description.html" onMouseOver="img_act('description'); return true;" onMouseOut="img_inact('description'); return true;"><img src="../../graphics/description_button.png" border="0" name="description"></a><br>
    <a href="../../documentation/documentation.html" onMouseOver="img_act('documentation'); return true;" onMouseOut="img_inact('documentation'); return true;"><img src="../../graphics/documentation_button.png" border="0" name="documentation"></a><br>
    <a href="../../download/download.html" onMouseOver="img_act('download'); return true;" onMouseOut="img_inact('download'); return true;"><img src="../../graphics/download_button.png" border="0" name="download"></a><br>
    <a href="../../support/support.html" onMouseOver="img_act('support'); return true;" onMouseOut="img_inact('support'); return true;"><img src="../../graphics/support_button.png" border="0" name="support"></a><br>
    <img SRC="../../graphics/line_tl.gif" height="7" width="116" border="0"></td>
  <td width="720">
      <img SRC="../../graphics/head_bottom_right.png" height="120" width="720" border="0"><br>
      <img SRC="../../graphics/line_tr.gif" height="7" width="720" border="0"></td>
  <td background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  </tr>
  <tr valign="top">
  <td background="../../graphics/table_bck3.gif"></td>
  <td width="116" valign="bottom" align="center" background="../../graphics/table_bck5.gif"><img SRC="../../graphics/logo.png" border="0"></td>
  <td width="720" bgcolor="#ffffff">
  <div id="content">   
<!-- Start content for this page -->
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<p class="links">
[<a href="msg00567.html">Date Prev</a>] [<a href="msg00569.html">Date Next</a>] [<a href="msg00567.html">Thread Prev</a>] [<a href="msg00614.html">Thread Next</a>]<br>
[<b><a href="maillist.html#00568">Date Index</a></b>]
[<b><a href="threads.html#00568">Thread Index</a></b>]
</p>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [sundials-users] Dependency of solver success from log interval?</h1>
<div class="frame">
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<table border=0 cellpadding=2 cellspacing=0>
<tr>
<td align="right"><b>
<em>From</em></b></td>
<td align="left">
Radu Serban &lt;<a href="mailto:radu%40llnl.gov">radu@llnl.gov</a>&gt;</td>
</tr>

<tr>
<td align="right"><b>
<em>Date</em></b></td>
<td align="left">
Thu, 06 Jul 2006 08:34:43 -0700</td>
</tr>

</table>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div>
<div class="container">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
Kai Hartmann wrote:
<blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">Hi Alan, hi all.</pre><br>
<blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">That would indicate either a
bug (perhaps a bad Jacobian), or a genuine very short initial time
scale in your system (which may or may not correspond to a fast
transient in the solution).  In the latter case, we would urge you to
use a log interval that is much nearer to that time scale, so that a
more suitable initial stepsize is chosen (and the reported solution
values resolve that transient).
</pre></blockquote><pre style="margin: 0em;"><br>Yes, I think you are right with the second explanation. Maybe it is
better to change the output mode to CV_ONE_STEP to get a better
resolution in all relevant parts. The value of tout should be irrelevant
in this case, but may be taken for initial stepsize calculation as you
mentioned. Is there any harm in setting it to a very low value, e.g. the
smallest possible double? How can I find out what the initial time scale
t_initial in my system is and how should I adjust the initial tout-t0
w.r.t. the initial timescale? Would tout=t_initial be ok?</pre><br>
<pre style="margin: 0em;">With thanks for your helpful comments,</pre><br>
<pre style="margin: 0em;">Kai</pre><br>
</blockquote><pre style="margin: 0em;"><br>Hi Kai,</pre><br>
As you suspected, even in CV_ONE_STEP mode, the first value tout is used in estimating the initial step size. Also, tout=t_initial will not 
work, as the difference tout-t_initial is used to decide the direction of integration and so, passing tout=t_initial, would result in an error.<br>
<br>
Rather than trying to get the right initial stepsize h0 by finding an appropriate tout value, why don't you just specify it to CVODE through 
CVodeSetInitStep? The appropriate value for h0 is problem dependent (you may want to look at the Jacobian and its eigenvalues at the initial 
time), but even if you cannot determine it a-priori, it's safe to pass a very small value to CVodeSetInitStep (although, if you set h0 to a 
value much smaller than what is actually needed, it'll take some steps until CVODE will increase it to that level). Some experimentation may 
be needed.<br>
<br>
Have you looked at the actual values h0 that CVODE computes for the two different tout values you mentioned in your previous post (1e-17 and 
1e-18)? How different are they? To get these values, you can call CVodeGetActualInitStep anytime after CVode returns from its first call.<br>
<br>
<pre style="margin: 0em;">--Radu</pre><br>
<pre style="margin: 0em;">--
   Radu Serban
   Center for Applied Scientific Computing   [email] radu@llnl.gov
   Lawrence Livermore National Laboratory    [phone] 925-424-4852
   P.O. Box 808, L-560                       [fax]   925-422-6287
   Livermore, CA 94551</pre><br>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<div class="container">
<table width="95%" frame="below"><tr><td></td></table>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00614" href="msg00614.html">Re: [sundials-users] Dependency of solver success from log interval?</a></strong>
<ul><li><em>From:</em> Kai Hartmann &lt;Kai.Hartmann@uni-koeln.de&gt;</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00561" href="msg00561.html">[sundials-users] Dependency of solver success from log interval?</a></strong>
<ul><li><em>From:</em> Kai Hartmann &lt;Kai.Hartmann@uni-koeln.de&gt;</li></ul></li>
<li><strong><a name="00564" href="msg00564.html">Re: [sundials-users] Dependency of solver success from log interval?</a></strong>
<ul><li><em>From:</em> Alan Hindmarsh &lt;alanh@llnl.gov&gt;</li></ul></li>
<li><strong><a name="00567" href="msg00567.html">Re: [sundials-users] Dependency of solver success from log interval?</a></strong>
<ul><li><em>From:</em> Kai Hartmann &lt;Kai.Hartmann@uni-koeln.de&gt;</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00567.html">Re: [sundials-users] Dependency of solver success from log interval?</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00569.html">Re: [sundials-users] IDA under mex interface between SUNDIALS and MATLAB</a></strong>
</li>

<li>Previous by thread:
<strong><a href="msg00567.html">Re: [sundials-users] Dependency of solver success from log interval?</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00614.html">Re: [sundials-users] Dependency of solver success from log interval?</a></strong>
</li>

<li>Index(es):
<ul>
<li><a href="maillist.html#00568">
<strong>Main</strong></a></li>
<li><a href="threads.html#00568">
<strong>Thread</strong></a></li>
</ul>
</li>
</ul>
</div>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<!-- End content for this page -->
  </div>
  </td>
  <td background="../../graphics/table_bck3.gif"></td>
  </tr>
  <tr valign="top">
  <td height="17" background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  <td width="116"><a HREF="http://www.llnl.gov/disclaimer.html" target="_top"><img SRC="../../graphics/line_bl.gif" height="17" width="116" border="0"></a></td>
  <td width="720"><img SRC="../../graphics/line_br.gif" height="17" width="720" border="0"></td>
  <td background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  </tr>
  </table>
</body>
</html>
