<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: [sundials&#45;users] CVODE: Iteration limit and error control... -->
<!--X-From-R13: "Oaqernf @vpbynv" <Oaqernf.@vpbynvNtzk.arg> -->
<!--X-Date: Fri, 25 Aug 2006 05:42:54 &#45;0700 -->
<!--X-Message-Id: op.teuated6t8lo91@smtp.kuleuven.ac.be -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: op.tesj7foft8lo91@smtp.kuleuven.ac.be -->
<!--X-Reference: 44EE23E8.8060600@llnl.gov -->
<!--X-Head-End-->
<html>
<head>
<title>Re: [sundials-users] CVODE: Iteration limit and error control...</title>
<meta name="author" content="Radu Serban">
<meta name="description" content="suite of nonlinear differential algebraic equation solvers">
<meta name="keywords" content="SUNDIALS, CVODE, CVODES, IDA, KINSOL">
<meta name="keywords" content="ODE, DAE, sensitivity">
<meta name="keywords" content="differential, algebraic">
<link REL="SHORTCUT ICON" HREF="img/favicon.ico" type="image/x-icon">
<link REL="ICON" HREF="img/favicon.ico" type="image/x-icon">
<link href="../../sundials_styles.css" rel="stylesheet" type="text/css">
<script language="JavaScript">
<!--
homeon = new Image();           homeon.src = "../../graphics/home_buttonH.png";
homeoff = new Image();          homeoff.src = "../../graphics/home_button.png";
descriptionon = new Image();    descriptionon.src = "../../graphics/description_buttonH.png";
descriptionoff = new Image();   descriptionoff.src = "../../graphics/description_button.png";
documentationon = new Image();  documentationon.src = "../../graphics/documentation_buttonH.png";
documentationoff = new Image(); documentationoff.src = "../../graphics/documentation_button.png";
downloadon = new Image();       downloadon.src = "../../graphics/download_buttonH.png";
downloadoff = new Image();      downloadoff.src = "../../graphics/download_button.png";
supporton = new Image();        supporton.src = "../../graphics/support_buttonH.png";
supportoff = new Image();       supportoff.src = "../../graphics/support_button.png";
//-->
</script>
<script src="../../sunjs.js" type="text/javascript" language="javascript1.2"></script>
</head>
<!-- ******************************************************************************** -->
<body>
<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
  <td height="60" background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  <td width="116"><img SRC="../../graphics/head_top_left.png" height="60" width="116" border="0"></td>
  <td width="720"><img SRC="../../graphics/head_mail_top_right.png" height="60" width="720" border="0"></td>
  <td background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  </tr>
  <tr valign="top">
  <td height="127" background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  <td width="116">
    <a href="../../main.html" onMouseOver="img_act('home'); return true;" onMouseOut="img_inact('home'); return true;"><img src="../../graphics/home_button.png" border="0" name="home"></a><br>
    <a href="../../description/description.html" onMouseOver="img_act('description'); return true;" onMouseOut="img_inact('description'); return true;"><img src="../../graphics/description_button.png" border="0" name="description"></a><br>
    <a href="../../documentation/documentation.html" onMouseOver="img_act('documentation'); return true;" onMouseOut="img_inact('documentation'); return true;"><img src="../../graphics/documentation_button.png" border="0" name="documentation"></a><br>
    <a href="../../download/download.html" onMouseOver="img_act('download'); return true;" onMouseOut="img_inact('download'); return true;"><img src="../../graphics/download_button.png" border="0" name="download"></a><br>
    <a href="../../support/support.html" onMouseOver="img_act('support'); return true;" onMouseOut="img_inact('support'); return true;"><img src="../../graphics/support_button.png" border="0" name="support"></a><br>
    <img SRC="../../graphics/line_tl.gif" height="7" width="116" border="0"></td>
  <td width="720">
      <img SRC="../../graphics/head_bottom_right.png" height="120" width="720" border="0"><br>
      <img SRC="../../graphics/line_tr.gif" height="7" width="720" border="0"></td>
  <td background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  </tr>
  <tr valign="top">
  <td background="../../graphics/table_bck3.gif"></td>
  <td width="116" valign="bottom" align="center" background="../../graphics/table_bck5.gif"><img SRC="../../graphics/logo.png" border="0"></td>
  <td width="720" bgcolor="#ffffff">
  <div id="content">   
<!-- Start content for this page -->
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<p class="links">
[<a href="msg00631.html">Date Prev</a>] [<a href="msg00633.html">Date Next</a>] [<a href="msg00629.html">Thread Prev</a>] [<a href="msg00634.html">Thread Next</a>]<br>
[<b><a href="maillist.html#00632">Date Index</a></b>]
[<b><a href="threads.html#00632">Thread Index</a></b>]
</p>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [sundials-users] CVODE: Iteration limit and error control...</h1>
<div class="frame">
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<table border=0 cellpadding=2 cellspacing=0>
<tr>
<td align="right"><b>
<em>From</em></b></td>
<td align="left">
&quot;Andreas Nicolai&quot; &lt;<a href="mailto:Andreas.Nicolai%40gmx.net">Andreas.Nicolai@gmx.net</a>&gt;</td>
</tr>

<tr>
<td align="right"><b>
<em>Date</em></b></td>
<td align="left">
Fri, 25 Aug 2006 08:40:16 -0400</td>
</tr>

</table>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div>
<div class="container">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Hi again,</pre><br>
<pre style="margin: 0em;">thanks for the remarks.</pre><br>
<blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">The limit on the number of iterations (as well as the test on the ratio of two
consecutive corrections) are there because we do not do any globalization for
the Newton method. Too many iterations are a sign that the predictor value may
be outside the basin of attraction. Reducing the step size will provide a better
initial iterate (a new predicted value). Limiting the number of iterations and
maybe forcing a step-size reduction (before reducing the step size, the solver
looks if the Jacobian is out-of-date and first attempts to resolve the problem
by updating it) is done for efficiency since each iteration implies an
additional function evaluation.
</pre></blockquote><pre style="margin: 0em;"><br>Ok, this makes sense to me, even though the term &quot;Globalization&quot; is new to 
me in this respect.
However, about the efficiency: When considering the total number of iterations 
in a certain integration time interval, wouldn't fewer steps with more 
iterations actually lead a globally smaller number of iterations? At least, 
that was the behavior in my simple Euler solvers. I gain performance, but 
sacrifice accuracy. How does this relate to CVODE?</pre><br>
<blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">The desired accuracy of the solution is ensured by the tolerance with which the
nonlinear system is solved. The stopping test - done on the correction and not
on the residual - is related to the ensuing error test (on the local truncation
error, LTE). Using asymptotic relations for the LTE of both the predictor and
corrector, one can show that the error test can be written in terms of the
predictor-corrector difference (that is the accumulated correction over all
nonlinear iterations, since the initial starting point for the Newton iterations
is the predicted value).
</pre></blockquote><pre style="margin: 0em;"><br>Not sure if I understand this completely. The predictor step is essentially some explicit 
prediction of the solution variables using the history of the past steps. Now, during the iteration 
variables approach the converged solution and may be &quot;swinging&quot; around the target values. 
How do I have to understand the term &quot;accumulated correction&quot;? Is that the absolute 
difference between a state variable at different iteration levels which is then added up to get the 
total correction? Or is it simply the difference between predicted and corrected/final value?</pre><br>
<pre style="margin: 0em;">Also, this asymptotic relation for the LTE (is that the residual which 
asymptotically approaches zero on convergence?) is new to me, I could only 
imagine plotting the residuals over the iteration levels and find such an 
asymptotic behavior for the corrector step. But how do you find such an 
asymptotic behavior for the predictor? Could you recommand a paper/book where I 
can read up something on this?</pre><br>
<pre style="margin: 0em;">Thanks again,
Andreas</pre><br>
<pre style="margin: 0em;">--
Andreas Nicolai                         anicolai@syr.edu
PhD Candidate, M.A.M.E                  (315) 443-2641
Syracuse University
151 Link Hall
Syracuse, NY, 13244</pre><br>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<div class="container">
<table width="95%" frame="below"><tr><td></td></table>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00634" href="msg00634.html">Re: [sundials-users] CVODE: Iteration limit and error control...</a></strong>
<ul><li><em>From:</em> Radu Serban &lt;radu@llnl.gov&gt;</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00627" href="msg00627.html">[sundials-users] CVODE: Iteration limit and error control...</a></strong>
<ul><li><em>From:</em> &quot;Andreas Nicolai&quot; &lt;Andreas.Nicolai@gmx.net&gt;</li></ul></li>
<li><strong><a name="00629" href="msg00629.html">Re: [sundials-users] CVODE: Iteration limit and error control...</a></strong>
<ul><li><em>From:</em> Radu Serban &lt;radu@llnl.gov&gt;</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00631.html">Re: [sundials-users] IDA dense/banded solver</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00633.html">Re: [sundials-users] IDA dense/banded solver</a></strong>
</li>

<li>Previous by thread:
<strong><a href="msg00629.html">Re: [sundials-users] CVODE: Iteration limit and error control...</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00634.html">Re: [sundials-users] CVODE: Iteration limit and error control...</a></strong>
</li>

<li>Index(es):
<ul>
<li><a href="maillist.html#00632">
<strong>Main</strong></a></li>
<li><a href="threads.html#00632">
<strong>Thread</strong></a></li>
</ul>
</li>
</ul>
</div>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<!-- End content for this page -->
  </div>
  </td>
  <td background="../../graphics/table_bck3.gif"></td>
  </tr>
  <tr valign="top">
  <td height="17" background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  <td width="116"><a HREF="http://www.llnl.gov/disclaimer.html" target="_top"><img SRC="../../graphics/line_bl.gif" height="17" width="116" border="0"></a></td>
  <td width="720"><img SRC="../../graphics/line_br.gif" height="17" width="720" border="0"></td>
  <td background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  </tr>
  </table>
</body>
</html>
