<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: changing dependent variable mid&#45;run -->
<!--X-From-R13: Xbeqna Ogynf <ghanznppurrfrNubgznvy.pbz> -->
<!--X-Date: Thu, 17 Mar 2005 12:31:31 &#45;0800 (PST) -->
<!--X-Message-Id: BAY104&#45;F8687741BC5E9C2A7C37F6B3490@phx.gbl -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 3fc0f6d67f82a738e150477467212472@umich.edu -->
<!--X-Head-End-->
<html>
<head>
<title>Re: changing dependent variable mid-run</title>
<meta name="author" content="Radu Serban">
<meta name="description" content="suite of nonlinear differential algebraic equation solvers">
<meta name="keywords" content="SUNDIALS, CVODE, CVODES, IDA, KINSOL">
<meta name="keywords" content="ODE, DAE, sensitivity">
<meta name="keywords" content="differential, algebraic">
<link REL="SHORTCUT ICON" HREF="img/favicon.ico" type="image/x-icon">
<link REL="ICON" HREF="img/favicon.ico" type="image/x-icon">
<link href="../../sundials_styles.css" rel="stylesheet" type="text/css">
<script language="JavaScript">
<!--
homeon = new Image();           homeon.src = "../../graphics/home_buttonH.png";
homeoff = new Image();          homeoff.src = "../../graphics/home_button.png";
descriptionon = new Image();    descriptionon.src = "../../graphics/description_buttonH.png";
descriptionoff = new Image();   descriptionoff.src = "../../graphics/description_button.png";
documentationon = new Image();  documentationon.src = "../../graphics/documentation_buttonH.png";
documentationoff = new Image(); documentationoff.src = "../../graphics/documentation_button.png";
downloadon = new Image();       downloadon.src = "../../graphics/download_buttonH.png";
downloadoff = new Image();      downloadoff.src = "../../graphics/download_button.png";
supporton = new Image();        supporton.src = "../../graphics/support_buttonH.png";
supportoff = new Image();       supportoff.src = "../../graphics/support_button.png";
//-->
</script>
<script src="../../sunjs.js" type="text/javascript" language="javascript1.2"></script>
</head>
<!-- ******************************************************************************** -->
<body>
<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
  <td height="60" background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  <td width="116"><img SRC="../../graphics/head_top_left.png" height="60" width="116" border="0"></td>
  <td width="720"><img SRC="../../graphics/head_mail_top_right.png" height="60" width="720" border="0"></td>
  <td background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  </tr>
  <tr valign="top">
  <td height="127" background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  <td width="116">
    <a href="../../main.html" onMouseOver="img_act('home'); return true;" onMouseOut="img_inact('home'); return true;"><img src="../../graphics/home_button.png" border="0" name="home"></a><br>
    <a href="../../description/description.html" onMouseOver="img_act('description'); return true;" onMouseOut="img_inact('description'); return true;"><img src="../../graphics/description_button.png" border="0" name="description"></a><br>
    <a href="../../documentation/documentation.html" onMouseOver="img_act('documentation'); return true;" onMouseOut="img_inact('documentation'); return true;"><img src="../../graphics/documentation_button.png" border="0" name="documentation"></a><br>
    <a href="../../download/download.html" onMouseOver="img_act('download'); return true;" onMouseOut="img_inact('download'); return true;"><img src="../../graphics/download_button.png" border="0" name="download"></a><br>
    <a href="../../support/support.html" onMouseOver="img_act('support'); return true;" onMouseOut="img_inact('support'); return true;"><img src="../../graphics/support_button.png" border="0" name="support"></a><br>
    <img SRC="../../graphics/line_tl.gif" height="7" width="116" border="0"></td>
  <td width="720">
      <img SRC="../../graphics/head_bottom_right.png" height="120" width="720" border="0"><br>
      <img SRC="../../graphics/line_tr.gif" height="7" width="720" border="0"></td>
  <td background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  </tr>
  <tr valign="top">
  <td background="../../graphics/table_bck3.gif"></td>
  <td width="116" valign="bottom" align="center" background="../../graphics/table_bck5.gif"><img SRC="../../graphics/logo.png" border="0"></td>
  <td width="720" bgcolor="#ffffff">
  <div id="content">   
<!-- Start content for this page -->
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<p class="links">
[<a href="msg00015.html">Date Prev</a>] [<a href="msg00017.html">Date Next</a>] [<a href="msg00015.html">Thread Prev</a>] [<a href="msg00017.html">Thread Next</a>]<br>
[<b><a href="maillist.html#00016">Date Index</a></b>]
[<b><a href="threads.html#00016">Thread Index</a></b>]
</p>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: changing dependent variable mid-run</h1>
<div class="frame">
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<table border=0 cellpadding=2 cellspacing=0>
<tr>
<td align="right"><b>
<em>From</em></b></td>
<td align="left">
Jordan Atlas &lt;<a href="mailto:tunamaccheese%40hotmail.com">tunamaccheese@hotmail.com</a>&gt;</td>
</tr>

<tr>
<td align="right"><b>
<em>Date</em></b></td>
<td align="left">
Thu, 17 Mar 2005 15:28:23 -0500</td>
</tr>

</table>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div>
<div class="container">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">James,</pre><br>
<tt>     As you suggested, I was able to do what I needed by reinitializing the 
solver using CVodeMalloc(...) and calling CVDense(...).  I still have to 
take a look at getting the current step size and using that when I 
reinitialize.  Thanks for the suggestions!</tt><br>
<br>
<pre style="margin: 0em;">--Jordan--</pre><br>
<blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">From: James Holloway &lt;hagar@umich.edu&gt;
Reply-To: sundials-users@llnl.gov
To: sundials-users@llnl.gov
Subject: Re: changing dependent variable mid-run
Date: Thu, 17 Mar 2005 14:16:46 -0500</pre><br>
<tt>As far as I know, in order to do this you have to reinitialize the solver.  
 The vector y returned by your call to CVode(mem, t, y, &amp;treturn, itask) 
is not the state vector internally maintained by the solver.   The solver 
may have proceeded past your integration time t, and is giving you an 
interpolation back to the time requested, so its internal state may already 
be into the future.    You want to change the internal state of the solver, 
and this requires initialization.   You might want to get the current 
internal step size of the solver and use that when you reinitialize.</tt><br>
<br>
<pre style="margin: 0em;">JPH</pre><br>
<pre style="margin: 0em;">On Mar 17, 2005, at 1:41 PM, Jordan Atlas wrote:</pre><br>
<blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;"><br>Hello,</pre><br>
<tt>    Using CVODE integration, is it possible to make step changes in an 
independent variable between between specific time steps?  For example, if 
one of the variables is y0, I would like y0 to automatically double (as a 
step change) every 5 time units, independent of the equation for dy0/dt.</tt><br>
<br>
<tt>    In my loop that calls CVode(...), I tried to do this using something 
like:</tt><br>
<br>
<pre style="margin: 0em;">               // If the time is less than the time for the step change
        if (tout &gt;= stepTime)
        {
                N_VPrint_Serial(y);</pre><br>
<pre style="margin: 0em;">                N_VScale(2, y, y);</pre><br>
<pre style="margin: 0em;">        //      Another way that I tried
        //      NV_Ith_S(y,0) = (NV_Ith_S(y,0)*2.0);
        //      NV_Ith_S(y,1) = (NV_Ith_S(y,1)*2.0);</pre><br>
<pre style="margin: 0em;">                stepTime += stepTime;
                N_VPrint_Serial(y);
        }</pre><br>
<tt>    The print statements show y as doubling, but the changes are not 
reflected in the time course produced by CVode (elsewhere in the code).  
Is there anyway to access the independent variable during the integration 
like this?</tt><br>
<br>
<pre style="margin: 0em;">Thank you,</pre><br>
<pre style="margin: 0em;">--Jordan Atlas--</pre><br>
<tt>_________________________________________________________________<br>
Don?t just search. Find. Check out the new MSN Search! 
<a  href="http://search.msn.click-url.com/go/onm00200636ave/direct/01/">http://search.msn.click-url.com/go/onm00200636ave/direct/01/</a></tt><br>
<br>
<br>
</blockquote><pre style="margin: 0em;">--
James Paul Holloway
hagar@umich.edu
734-936-3126
Preferred Attachment Format: PDF</pre><br>
<br>
</blockquote><tt><br>_________________________________________________________________<br>
Is your PC infected? Get a FREE online computer virus scan from McAfee&#xAE; 
Security. <a  href="http://clinic.mcafee.com/clinic/ibuy/campaign.asp?cid=3963">http://clinic.mcafee.com/clinic/ibuy/campaign.asp?cid=3963</a></tt><br>
<br>
<br>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<div class="container">
<table width="95%" frame="below"><tr><td></td></table>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00017" href="msg00017.html">Re: changing dependent variable mid-run</a></strong>
<ul><li><em>From:</em> Radu Serban &lt;serban1@llnl.gov&gt;</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00015" href="msg00015.html">Re: changing dependent variable mid-run</a></strong>
<ul><li><em>From:</em> James Holloway &lt;hagar@umich.edu&gt;</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00015.html">Re: changing dependent variable mid-run</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00017.html">Re: changing dependent variable mid-run</a></strong>
</li>

<li>Previous by thread:
<strong><a href="msg00015.html">Re: changing dependent variable mid-run</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00017.html">Re: changing dependent variable mid-run</a></strong>
</li>

<li>Index(es):
<ul>
<li><a href="maillist.html#00016">
<strong>Main</strong></a></li>
<li><a href="threads.html#00016">
<strong>Thread</strong></a></li>
</ul>
</li>
</ul>
</div>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<!-- End content for this page -->
  </div>
  </td>
  <td background="../../graphics/table_bck3.gif"></td>
  </tr>
  <tr valign="top">
  <td height="17" background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  <td width="116"><a HREF="http://www.llnl.gov/disclaimer.html" target="_top"><img SRC="../../graphics/line_bl.gif" height="17" width="116" border="0"></a></td>
  <td width="720"><img SRC="../../graphics/line_br.gif" height="17" width="720" border="0"></td>
  <td background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  </tr>
  </table>
</body>
</html>
