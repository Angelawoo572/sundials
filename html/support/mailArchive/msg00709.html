<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: Re&#45;4: [sundials&#45;users] performance for chemical kinetic problems -->
<!--X-From-R13: Oyna Vvaqznefu <nynauNyyay.tbi> -->
<!--X-Date: Wed, 27 Sep 2006 14:19:42 &#45;0700 -->
<!--X-Message-Id: Pine.LNX.4.58.0609271401190.16395@tux64.llnl.gov -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: Pine.LNX.4.58.0609201521260.28545@tux64.llnl.gov -->
<!--X-Reference: 4511C60E.3000405@uni&#45;bielefeld.de -->
<!--X-Head-End-->
<html>
<head>
<title>Re: Re-4: [sundials-users] performance for chemical kinetic problems</title>
<meta name="author" content="Radu Serban">
<meta name="description" content="suite of nonlinear differential algebraic equation solvers">
<meta name="keywords" content="SUNDIALS, CVODE, CVODES, IDA, KINSOL">
<meta name="keywords" content="ODE, DAE, sensitivity">
<meta name="keywords" content="differential, algebraic">
<link REL="SHORTCUT ICON" HREF="img/favicon.ico" type="image/x-icon">
<link REL="ICON" HREF="img/favicon.ico" type="image/x-icon">
<link href="../../sundials_styles.css" rel="stylesheet" type="text/css">
<script language="JavaScript">
<!--
homeon = new Image();           homeon.src = "../../graphics/home_buttonH.png";
homeoff = new Image();          homeoff.src = "../../graphics/home_button.png";
descriptionon = new Image();    descriptionon.src = "../../graphics/description_buttonH.png";
descriptionoff = new Image();   descriptionoff.src = "../../graphics/description_button.png";
documentationon = new Image();  documentationon.src = "../../graphics/documentation_buttonH.png";
documentationoff = new Image(); documentationoff.src = "../../graphics/documentation_button.png";
downloadon = new Image();       downloadon.src = "../../graphics/download_buttonH.png";
downloadoff = new Image();      downloadoff.src = "../../graphics/download_button.png";
supporton = new Image();        supporton.src = "../../graphics/support_buttonH.png";
supportoff = new Image();       supportoff.src = "../../graphics/support_button.png";
//-->
</script>
<script src="../../sunjs.js" type="text/javascript" language="javascript1.2"></script>
</head>
<!-- ******************************************************************************** -->
<body>
<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
  <td height="60" background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  <td width="116"><img SRC="../../graphics/head_top_left.png" height="60" width="116" border="0"></td>
  <td width="720"><img SRC="../../graphics/head_mail_top_right.png" height="60" width="720" border="0"></td>
  <td background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  </tr>
  <tr valign="top">
  <td height="127" background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  <td width="116">
    <a href="../../main.html" onMouseOver="img_act('home'); return true;" onMouseOut="img_inact('home'); return true;"><img src="../../graphics/home_button.png" border="0" name="home"></a><br>
    <a href="../../description/description.html" onMouseOver="img_act('description'); return true;" onMouseOut="img_inact('description'); return true;"><img src="../../graphics/description_button.png" border="0" name="description"></a><br>
    <a href="../../documentation/documentation.html" onMouseOver="img_act('documentation'); return true;" onMouseOut="img_inact('documentation'); return true;"><img src="../../graphics/documentation_button.png" border="0" name="documentation"></a><br>
    <a href="../../download/download.html" onMouseOver="img_act('download'); return true;" onMouseOut="img_inact('download'); return true;"><img src="../../graphics/download_button.png" border="0" name="download"></a><br>
    <a href="../../support/support.html" onMouseOver="img_act('support'); return true;" onMouseOut="img_inact('support'); return true;"><img src="../../graphics/support_button.png" border="0" name="support"></a><br>
    <img SRC="../../graphics/line_tl.gif" height="7" width="116" border="0"></td>
  <td width="720">
      <img SRC="../../graphics/head_bottom_right.png" height="120" width="720" border="0"><br>
      <img SRC="../../graphics/line_tr.gif" height="7" width="720" border="0"></td>
  <td background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  </tr>
  <tr valign="top">
  <td background="../../graphics/table_bck3.gif"></td>
  <td width="116" valign="bottom" align="center" background="../../graphics/table_bck5.gif"><img SRC="../../graphics/logo.png" border="0"></td>
  <td width="720" bgcolor="#ffffff">
  <div id="content">   
<!-- Start content for this page -->
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<p class="links">
[<a href="msg00708.html">Date Prev</a>] [<a href="msg00710.html">Date Next</a>] [<a href="msg00703.html">Thread Prev</a>] [<a href="msg00710.html">Thread Next</a>]<br>
[<b><a href="maillist.html#00709">Date Index</a></b>]
[<b><a href="threads.html#00709">Thread Index</a></b>]
</p>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: Re-4: [sundials-users] performance for chemical kinetic problems</h1>
<div class="frame">
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<table border=0 cellpadding=2 cellspacing=0>
<tr>
<td align="right"><b>
<em>From</em></b></td>
<td align="left">
Alan Hindmarsh &lt;<a href="mailto:alanh%40llnl.gov">alanh@llnl.gov</a>&gt;</td>
</tr>

<tr>
<td align="right"><b>
<em>Date</em></b></td>
<td align="left">
Wed, 27 Sep 2006 14:14:48 -0700 (PDT)</td>
</tr>

</table>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div>
<div class="container">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>
Hello Michael,

See my comments interspersed below.

-Alan H.


On Thu, 21 Sep 2006, Michael Letzgus wrote:

&gt;<i> ...  But as I understood preconditioning so far I have to</i>
&gt;<i> give a kind of &quot;hint&quot; which species changes in time very fast and which</i>
&gt;<i> not, the so called &quot;source of stiffness&quot;.</i>

Stiffness comes from large rate coefficients that correspond to DAMPED
modes, not to very fast changes in species values.


&gt;<i> My first idea was to do this hinting by using only the diagonal elements</i>
&gt;<i> - because a large rate constant will/may be found on this diagonal, too.</i>
&gt;<i></i>

That sounds fine.  But if there is an equally large (or nearly as large)
value off the diagonal, a diagonal preconditioner will not work well.

&gt;<i> Maybe I should rearrange my matrix to get the larges and the smallest</i>
&gt;<i> rate constants into a as small as possible block diagonal matrix.</i>
&gt;<i></i>

Yes that is often a good idea.

&gt;<i> OK, maybe this problem is correlated with my current dealing with my</i>
&gt;<i> time-dependent rate &quot;constants&quot; k(t).</i>
&gt;<i> Unfortunatly I can not recompute my jacobian in the function called by</i>
&gt;<i> the solver because the jacobian strictly depends on an external pulse.</i>
&gt;<i></i>

I don't understand this statement. At any given time (within any given
pulse) you must know what k(t) is, and therefore you can comput the
Jacobian.  See my next comment.


&gt;<i> So I recompute my jacobian after a given stop time:</i>
&gt;<i></i>
&gt;<i> 1) calculate some k(t, pulse(t))</i>
&gt;<i> 2) CVodesetstoptime(tstop);</i>
&gt;<i> 3) Cvode(...., CV_NORMAL_STOP);</i>
&gt;<i> 4) goto 1</i>
&gt;<i></i>

I'm not sure what step 1 here means.  If each pass through these steps
is a pulse, and the function k(t) is different for different pulses,
then you just need to be sure that you communicate to the RHS and
Jacobian functions what pulse is currently being computed.  You can do
that either with global variables or with the f_data pointer.

Otherwise, your 4-step outline looks fine.  Jacobians should be
recomputed (or recalled from storage, depending on jok) within the
CVSpilsPrecSetupFn function when it is called.



</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<div class="container">
<table width="95%" frame="below"><tr><td></td></table>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00710" href="msg00710.html">Re: Re-4: [sundials-users] performance for chemical kinetic problems</a></strong>
<ul><li><em>From:</em> Michael Letzgus &lt;michael.letzgus@uni-bielefeld.de&gt;</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00702" href="msg00702.html">Re: Re-4: [sundials-users] performance for chemical kinetic problems</a></strong>
<ul><li><em>From:</em> Alan Hindmarsh &lt;alanh@llnl.gov&gt;</li></ul></li>
<li><strong><a name="00703" href="msg00703.html">Re: Re-4: [sundials-users] performance for chemical kinetic problems</a></strong>
<ul><li><em>From:</em> Michael Letzgus &lt;michael.letzgus@uni-bielefeld.de&gt;</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00708.html">Re: [sundials-users] ReInit functions in sundialsTB</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00710.html">Re: Re-4: [sundials-users] performance for chemical kinetic problems</a></strong>
</li>

<li>Previous by thread:
<strong><a href="msg00703.html">Re: Re-4: [sundials-users] performance for chemical kinetic problems</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00710.html">Re: Re-4: [sundials-users] performance for chemical kinetic problems</a></strong>
</li>

<li>Index(es):
<ul>
<li><a href="maillist.html#00709">
<strong>Main</strong></a></li>
<li><a href="threads.html#00709">
<strong>Thread</strong></a></li>
</ul>
</li>
</ul>
</div>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<!-- End content for this page -->
  </div>
  </td>
  <td background="../../graphics/table_bck3.gif"></td>
  </tr>
  <tr valign="top">
  <td height="17" background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  <td width="116"><a HREF="http://www.llnl.gov/disclaimer.html" target="_top"><img SRC="../../graphics/line_bl.gif" height="17" width="116" border="0"></a></td>
  <td width="720"><img SRC="../../graphics/line_br.gif" height="17" width="720" border="0"></td>
  <td background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  </tr>
  </table>
</body>
</html>
