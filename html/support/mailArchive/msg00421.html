<!-- MHonArc v2.6.10 -->
<!--X-Subject: [sundials&#45;users] coordinate projection with CVODE -->
<!--X-From-R13: [vpunry Eurezna <zfureznaNfgnasbeq.rqh> -->
<!--X-Date: Sun, 09 Apr 2006 20:19:18 &#45;0700 (PDT) -->
<!--X-Message-Id: 003a01c65c4d$331f3c00$6601a8c0@ShermsNotebook -->
<!--X-Content-Type: text/plain -->
<!--X-Head-End-->
<html>
<head>
<title>[sundials-users] coordinate projection with CVODE</title>
<meta name="author" content="Radu Serban">
<meta name="description" content="suite of nonlinear differential algebraic equation solvers">
<meta name="keywords" content="SUNDIALS, CVODE, CVODES, IDA, KINSOL">
<meta name="keywords" content="ODE, DAE, sensitivity">
<meta name="keywords" content="differential, algebraic">
<link REL="SHORTCUT ICON" HREF="img/favicon.ico" type="image/x-icon">
<link REL="ICON" HREF="img/favicon.ico" type="image/x-icon">
<link href="../../sundials_styles.css" rel="stylesheet" type="text/css">
<script language="JavaScript">
<!--
homeon = new Image();           homeon.src = "../../graphics/home_buttonH.png";
homeoff = new Image();          homeoff.src = "../../graphics/home_button.png";
descriptionon = new Image();    descriptionon.src = "../../graphics/description_buttonH.png";
descriptionoff = new Image();   descriptionoff.src = "../../graphics/description_button.png";
documentationon = new Image();  documentationon.src = "../../graphics/documentation_buttonH.png";
documentationoff = new Image(); documentationoff.src = "../../graphics/documentation_button.png";
downloadon = new Image();       downloadon.src = "../../graphics/download_buttonH.png";
downloadoff = new Image();      downloadoff.src = "../../graphics/download_button.png";
supporton = new Image();        supporton.src = "../../graphics/support_buttonH.png";
supportoff = new Image();       supportoff.src = "../../graphics/support_button.png";
//-->
</script>
<script src="../../sunjs.js" type="text/javascript" language="javascript1.2"></script>
</head>
<!-- ******************************************************************************** -->
<body>
<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
  <td height="60" background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  <td width="116"><img SRC="../../graphics/head_top_left.png" height="60" width="116" border="0"></td>
  <td width="720"><img SRC="../../graphics/head_mail_top_right.png" height="60" width="720" border="0"></td>
  <td background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  </tr>
  <tr valign="top">
  <td height="127" background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  <td width="116">
    <a href="../../main.html" onMouseOver="img_act('home'); return true;" onMouseOut="img_inact('home'); return true;"><img src="../../graphics/home_button.png" border="0" name="home"></a><br>
    <a href="../../description/description.html" onMouseOver="img_act('description'); return true;" onMouseOut="img_inact('description'); return true;"><img src="../../graphics/description_button.png" border="0" name="description"></a><br>
    <a href="../../documentation/documentation.html" onMouseOver="img_act('documentation'); return true;" onMouseOut="img_inact('documentation'); return true;"><img src="../../graphics/documentation_button.png" border="0" name="documentation"></a><br>
    <a href="../../download/download.html" onMouseOver="img_act('download'); return true;" onMouseOut="img_inact('download'); return true;"><img src="../../graphics/download_button.png" border="0" name="download"></a><br>
    <a href="../../support/support.html" onMouseOver="img_act('support'); return true;" onMouseOut="img_inact('support'); return true;"><img src="../../graphics/support_button.png" border="0" name="support"></a><br>
    <img SRC="../../graphics/line_tl.gif" height="7" width="116" border="0"></td>
  <td width="720">
      <img SRC="../../graphics/head_bottom_right.png" height="120" width="720" border="0"><br>
      <img SRC="../../graphics/line_tr.gif" height="7" width="720" border="0"></td>
  <td background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  </tr>
  <tr valign="top">
  <td background="../../graphics/table_bck3.gif"></td>
  <td width="116" valign="bottom" align="center" background="../../graphics/table_bck5.gif"><img SRC="../../graphics/logo.png" border="0"></td>
  <td width="720" bgcolor="#ffffff">
  <div id="content">   
<!-- Start content for this page -->
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<p class="links">
[<a href="msg00420.html">Date Prev</a>] [<a href="msg00422.html">Date Next</a>] [<a href="msg00417.html">Thread Prev</a>] [<a href="msg00427.html">Thread Next</a>]<br>
[<b><a href="maillist.html#00421">Date Index</a></b>]
[<b><a href="threads.html#00421">Thread Index</a></b>]
</p>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>[sundials-users] coordinate projection with CVODE</h1>
<div class="frame">
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<table border=0 cellpadding=2 cellspacing=0>
<tr>
<td align="right"><b>
<em>From</em></b></td>
<td align="left">
Michael Sherman &lt;<a href="mailto:msherman%40stanford.edu">msherman@stanford.edu</a>&gt;</td>
</tr>

<tr>
<td align="right"><b>
<em>Date</em></b></td>
<td align="left">
Sun, 09 Apr 2006 20:16:44 -0700</td>
</tr>

</table>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div>
<div class="container">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>We are trying in SimTK to solve biomechanics and molecular dynamics problems
using relative coordinate rigid body mechanics with algebraic constraints.
(As we discussed when you were here, Radu.) These problems have a large
number of joint-connected rigid bodies (&gt;1000) with a modest number of
constraints (&lt;100), and are often stiff. 

Over many years I have tried most of the methods in the literature and by
far prefer a formulation in which the acceleration constraints are solved
directly, and coordinate projection is used to keep the positions (&quot;q&quot;
below) and velocities hugging their constraint manifolds. Then the equations
look like this:
    
    (1) q''       = f(t,q,q')
    (2) p(t,q)    = 0
    (3) v(t,q,q') = 0

The coordinate projection integration step procedure is:
    1 advance the ODE (1) by a single error-controlled step
    2 project q onto position constraint manifold using (2)
    3 project q' onto velocity constraint manifold using (3)
    4 the new (q,q') is the end-of-step result
    5 final value of the derivative is f(t+h,q,q')
As long as the projections are done normal to the manifolds, this is
guaranteed not to damage the solution accuracy, and usually improves it. It
is a very nice method in practice.

We would like to use CVODE as the ODE solver for step 1. It is very easy to
use this procedure with one-step ODE methods (I've used Radau5, e.g.), but
it is trickier with multistep methods because the solution adjustment and
new derivative needs to be recorded properly in the internal data structure.
I have done this successfully with BDF (specifically DASSL in ODE mode) but
had to hack it up quite a lot (with Linda's help). I would much prefer to
use CVODE as a black box. 

Is there a reasonable way to use CVODE in a coordinate projection scheme?

Thanks and best regards,
Sherm 



</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<div class="container">
<table width="95%" frame="below"><tr><td></td></table>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00427" href="msg00427.html">Re: [sundials-users] coordinate projection with CVODE</a></strong>
<ul><li><em>From:</em> Radu Serban &lt;serban1@llnl.gov&gt;</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00420.html">Re: [sundials-users] Arbitrary precision for sundials solvers?</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00422.html">[sundials-users] problems on examples compiling in vc6.0</a></strong>
</li>

<li>Previous by thread:
<strong><a href="msg00417.html">[sundials-users] Arbitrary precision for sundials solvers?</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00427.html">Re: [sundials-users] coordinate projection with CVODE</a></strong>
</li>

<li>Index(es):
<ul>
<li><a href="maillist.html#00421">
<strong>Main</strong></a></li>
<li><a href="threads.html#00421">
<strong>Thread</strong></a></li>
</ul>
</li>
</ul>
</div>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<!-- End content for this page -->
  </div>
  </td>
  <td background="../../graphics/table_bck3.gif"></td>
  </tr>
  <tr valign="top">
  <td height="17" background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  <td width="116"><a HREF="http://www.llnl.gov/disclaimer.html" target="_top"><img SRC="../../graphics/line_bl.gif" height="17" width="116" border="0"></a></td>
  <td width="720"><img SRC="../../graphics/line_br.gif" height="17" width="720" border="0"></td>
  <td background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  </tr>
  </table>
</body>
</html>
