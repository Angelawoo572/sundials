<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: [sundials&#45;users] Chemical equilibrium with limitation on the solution... -->
<!--X-From-R13: Yrvgu Sevp Uenag <xrtNyyay.tbi> -->
<!--X-Date: Tue, 31 Oct 2006 10:39:49 &#45;0800 -->
<!--X-Message-Id: 45479667.7090305@llnl.gov -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: op.thwhhguwt8lo91@helium -->
<!--X-Reference: 453EC348.2080300@llnl.gov -->
<!--X-Reference: op.th9b9knjt8lo91@helium -->
<!--X-Head-End-->
<html>
<head>
<title>Re: [sundials-users] Chemical equilibrium with limitation on the solution...</title>
<meta name="author" content="Radu Serban">
<meta name="description" content="suite of nonlinear differential algebraic equation solvers">
<meta name="keywords" content="SUNDIALS, CVODE, CVODES, IDA, KINSOL">
<meta name="keywords" content="ODE, DAE, sensitivity">
<meta name="keywords" content="differential, algebraic">
<link REL="SHORTCUT ICON" HREF="img/favicon.ico" type="image/x-icon">
<link REL="ICON" HREF="img/favicon.ico" type="image/x-icon">
<link href="../../sundials_styles.css" rel="stylesheet" type="text/css">
<script language="JavaScript">
<!--
homeon = new Image();           homeon.src = "../../graphics/home_buttonH.png";
homeoff = new Image();          homeoff.src = "../../graphics/home_button.png";
descriptionon = new Image();    descriptionon.src = "../../graphics/description_buttonH.png";
descriptionoff = new Image();   descriptionoff.src = "../../graphics/description_button.png";
documentationon = new Image();  documentationon.src = "../../graphics/documentation_buttonH.png";
documentationoff = new Image(); documentationoff.src = "../../graphics/documentation_button.png";
downloadon = new Image();       downloadon.src = "../../graphics/download_buttonH.png";
downloadoff = new Image();      downloadoff.src = "../../graphics/download_button.png";
supporton = new Image();        supporton.src = "../../graphics/support_buttonH.png";
supportoff = new Image();       supportoff.src = "../../graphics/support_button.png";
//-->
</script>
<script src="../../sunjs.js" type="text/javascript" language="javascript1.2"></script>
</head>
<!-- ******************************************************************************** -->
<body>
<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
  <td height="60" background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  <td width="116"><img SRC="../../graphics/head_top_left.png" height="60" width="116" border="0"></td>
  <td width="720"><img SRC="../../graphics/head_mail_top_right.png" height="60" width="720" border="0"></td>
  <td background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  </tr>
  <tr valign="top">
  <td height="127" background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  <td width="116">
    <a href="../../main.html" onMouseOver="img_act('home'); return true;" onMouseOut="img_inact('home'); return true;"><img src="../../graphics/home_button.png" border="0" name="home"></a><br>
    <a href="../../description/description.html" onMouseOver="img_act('description'); return true;" onMouseOut="img_inact('description'); return true;"><img src="../../graphics/description_button.png" border="0" name="description"></a><br>
    <a href="../../documentation/documentation.html" onMouseOver="img_act('documentation'); return true;" onMouseOut="img_inact('documentation'); return true;"><img src="../../graphics/documentation_button.png" border="0" name="documentation"></a><br>
    <a href="../../download/download.html" onMouseOver="img_act('download'); return true;" onMouseOut="img_inact('download'); return true;"><img src="../../graphics/download_button.png" border="0" name="download"></a><br>
    <a href="../../support/support.html" onMouseOver="img_act('support'); return true;" onMouseOut="img_inact('support'); return true;"><img src="../../graphics/support_button.png" border="0" name="support"></a><br>
    <img SRC="../../graphics/line_tl.gif" height="7" width="116" border="0"></td>
  <td width="720">
      <img SRC="../../graphics/head_bottom_right.png" height="120" width="720" border="0"><br>
      <img SRC="../../graphics/line_tr.gif" height="7" width="720" border="0"></td>
  <td background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  </tr>
  <tr valign="top">
  <td background="../../graphics/table_bck3.gif"></td>
  <td width="116" valign="bottom" align="center" background="../../graphics/table_bck5.gif"><img SRC="../../graphics/logo.png" border="0"></td>
  <td width="720" bgcolor="#ffffff">
  <div id="content">   
<!-- Start content for this page -->
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<p class="links">
[<a href="msg00763.html">Date Prev</a>] [<a href="msg00765.html">Date Next</a>] [<a href="msg00763.html">Thread Prev</a>] [<a href="msg00750.html">Thread Next</a>]<br>
[<b><a href="maillist.html#00764">Date Index</a></b>]
[<b><a href="threads.html#00764">Thread Index</a></b>]
</p>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [sundials-users] Chemical equilibrium with limitation on the solution...</h1>
<div class="frame">
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<table border=0 cellpadding=2 cellspacing=0>
<tr>
<td align="right"><b>
<em>From</em></b></td>
<td align="left">
Keith Eric Grant &lt;<a href="mailto:keg%40llnl.gov">keg@llnl.gov</a>&gt;</td>
</tr>

<tr>
<td align="right"><b>
<em>Date</em></b></td>
<td align="left">
Tue, 31 Oct 2006 10:31:03 -0800</td>
</tr>

</table>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div>
<div class="container">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Andreas Nicolai wrote:</pre><br>
<blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><br>To summarize, the equation system works (I introduced a new variable 
beta  = b-1, so I could impose the &gt; 0 constraint), but is very 
sensitive to the  range of mol numbers - wether the system is strongly 
oversaturated or  undersaturated. I only tried to solve this system with 
SPGMR yet (Kinsol  has just too many options, it seems), but maybe 
someone in the readers  list can give me a hint on how to improve 
convergence.<br>
<br>
</blockquote><pre style="margin: 0em;"><br>Andreas,</pre><br>
A question on this, are you imposing the positive definite (&gt;0) constraint 
or the nonnegativity (&gt;=0) constraint. For this problem, NaCl concentration 
and beta could both, physically, be effectively zero, so the nonnegativity 
constraint is appropriate. In fact, for the saturated case, beta has to 
become zero for the solution to become exact.<br>
<br>
What I proposed before is also not necessarily the best technique but simply 
a pointer in the manner of thinking about the problem. A book on 
optimization is going to provide a number of techniques.<br>
<br>
When beta is relatively large, the solution becomes inaccurate, because the 
penalty (alpha) is emphasized relative to the desired solution. When the 
penalty is small, the solution is not unique. So the penalty acts somewhat 
as an activation energy does in a chemical reaction. Too large an alpha 
means that you can't converge below tolerance because the solution and 
penalty conflict, so the technique is not one that's perfectly 
self-consistent, but a 'regularization method' borrowed from inverse problems.<br>
<br>
<pre style="margin: 0em;">Have a meeting (actually two). later.</pre><br>
<pre style="margin: 0em;">...Keith</pre><br>
<pre style="margin: 0em;">--</pre><br>
<pre style="margin: 0em;"> +-----------------------------+-------------------------------------------+
 I Keith Eric Grant            I Common sense and a sense of humor are the I
 I                             I same thing, moving at different speeds.   I
 I CASC/ASD                    I A sense of humor is just common sense,    I
 I P.O. Box 808, L-103         I dancing.   ... Clive James                I
 I Lawrence Livrmr Natn'l Lab  I                                           I
 I EMail: keg@llnl.gov         I (or perhaps dancing is just common sense) I
 I FAX:   (925) 423-4908       I                                           I
 +-----------------------------+-------------------------------------------+</pre><br>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<div class="container">
<table width="95%" frame="below"><tr><td></td></table>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00744" href="msg00744.html">[sundials-users] Chemical equilibrium with limitation on the solution...</a></strong>
<ul><li><em>From:</em> &quot;Andreas Nicolai&quot; &lt;Andreas.Nicolai@gmx.net&gt;</li></ul></li>
<li><strong><a name="00748" href="msg00748.html">Re: [sundials-users] Chemical equilibrium with limitation on the solution...</a></strong>
<ul><li><em>From:</em> Keith Eric Grant &lt;keg@llnl.gov&gt;</li></ul></li>
<li><strong><a name="00763" href="msg00763.html">Re: [sundials-users] Chemical equilibrium with limitation on the solution...</a></strong>
<ul><li><em>From:</em> &quot;Andreas Nicolai&quot; &lt;Andreas.Nicolai@gmx.net&gt;</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00763.html">Re: [sundials-users] Chemical equilibrium with limitation on the solution...</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00765.html">[sundials-users] Determining the size/precision of realtype at runtime</a></strong>
</li>

<li>Previous by thread:
<strong><a href="msg00763.html">Re: [sundials-users] Chemical equilibrium with limitation on the solution...</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00750.html">[sundials-users] A Question</a></strong>
</li>

<li>Index(es):
<ul>
<li><a href="maillist.html#00764">
<strong>Main</strong></a></li>
<li><a href="threads.html#00764">
<strong>Thread</strong></a></li>
</ul>
</li>
</ul>
</div>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<!-- End content for this page -->
  </div>
  </td>
  <td background="../../graphics/table_bck3.gif"></td>
  </tr>
  <tr valign="top">
  <td height="17" background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  <td width="116"><a HREF="http://www.llnl.gov/disclaimer.html" target="_top"><img SRC="../../graphics/line_bl.gif" height="17" width="116" border="0"></a></td>
  <td width="720"><img SRC="../../graphics/line_br.gif" height="17" width="720" border="0"></td>
  <td background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  </tr>
  </table>
</body>
</html>
