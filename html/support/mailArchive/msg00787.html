<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: [sundials&#45;users] Adapting to stiff and non&#45;stiff ODEs -->
<!--X-From-R13: Oyna Vvaqznefu <nynauNyyay.tbi> -->
<!--X-Date: Tue, 28 Nov 2006 12:45:09 &#45;0800 -->
<!--X-Message-Id: Pine.LNX.4.58.0611281241180.23964@tux64.llnl.gov -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 1164603259.v2.fusewebmail&#45;81482@f -->
<!--X-Head-End-->
<html>
<head>
<title>Re: [sundials-users] Adapting to stiff and non-stiff ODEs</title>
<meta name="author" content="Radu Serban">
<meta name="description" content="suite of nonlinear differential algebraic equation solvers">
<meta name="keywords" content="SUNDIALS, CVODE, CVODES, IDA, KINSOL">
<meta name="keywords" content="ODE, DAE, sensitivity">
<meta name="keywords" content="differential, algebraic">
<link REL="SHORTCUT ICON" HREF="img/favicon.ico" type="image/x-icon">
<link REL="ICON" HREF="img/favicon.ico" type="image/x-icon">
<link href="../../sundials_styles.css" rel="stylesheet" type="text/css">
<script language="JavaScript">
<!--
homeon = new Image();           homeon.src = "../../graphics/home_buttonH.png";
homeoff = new Image();          homeoff.src = "../../graphics/home_button.png";
descriptionon = new Image();    descriptionon.src = "../../graphics/description_buttonH.png";
descriptionoff = new Image();   descriptionoff.src = "../../graphics/description_button.png";
documentationon = new Image();  documentationon.src = "../../graphics/documentation_buttonH.png";
documentationoff = new Image(); documentationoff.src = "../../graphics/documentation_button.png";
downloadon = new Image();       downloadon.src = "../../graphics/download_buttonH.png";
downloadoff = new Image();      downloadoff.src = "../../graphics/download_button.png";
supporton = new Image();        supporton.src = "../../graphics/support_buttonH.png";
supportoff = new Image();       supportoff.src = "../../graphics/support_button.png";
//-->
</script>
<script src="../../sunjs.js" type="text/javascript" language="javascript1.2"></script>
</head>
<!-- ******************************************************************************** -->
<body>
<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
  <td height="60" background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  <td width="116"><img SRC="../../graphics/head_top_left.png" height="60" width="116" border="0"></td>
  <td width="720"><img SRC="../../graphics/head_mail_top_right.png" height="60" width="720" border="0"></td>
  <td background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  </tr>
  <tr valign="top">
  <td height="127" background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  <td width="116">
    <a href="../../main.html" onMouseOver="img_act('home'); return true;" onMouseOut="img_inact('home'); return true;"><img src="../../graphics/home_button.png" border="0" name="home"></a><br>
    <a href="../../description/description.html" onMouseOver="img_act('description'); return true;" onMouseOut="img_inact('description'); return true;"><img src="../../graphics/description_button.png" border="0" name="description"></a><br>
    <a href="../../documentation/documentation.html" onMouseOver="img_act('documentation'); return true;" onMouseOut="img_inact('documentation'); return true;"><img src="../../graphics/documentation_button.png" border="0" name="documentation"></a><br>
    <a href="../../download/download.html" onMouseOver="img_act('download'); return true;" onMouseOut="img_inact('download'); return true;"><img src="../../graphics/download_button.png" border="0" name="download"></a><br>
    <a href="../../support/support.html" onMouseOver="img_act('support'); return true;" onMouseOut="img_inact('support'); return true;"><img src="../../graphics/support_button.png" border="0" name="support"></a><br>
    <img SRC="../../graphics/line_tl.gif" height="7" width="116" border="0"></td>
  <td width="720">
      <img SRC="../../graphics/head_bottom_right.png" height="120" width="720" border="0"><br>
      <img SRC="../../graphics/line_tr.gif" height="7" width="720" border="0"></td>
  <td background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  </tr>
  <tr valign="top">
  <td background="../../graphics/table_bck3.gif"></td>
  <td width="116" valign="bottom" align="center" background="../../graphics/table_bck5.gif"><img SRC="../../graphics/logo.png" border="0"></td>
  <td width="720" bgcolor="#ffffff">
  <div id="content">   
<!-- Start content for this page -->
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<p class="links">
[<a href="msg00786.html">Date Prev</a>] [<a href="msg00788.html">Date Next</a>] [<a href="msg00780.html">Thread Prev</a>] [<a href="msg00786.html">Thread Next</a>]<br>
[<b><a href="maillist.html#00787">Date Index</a></b>]
[<b><a href="threads.html#00787">Thread Index</a></b>]
</p>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [sundials-users] Adapting to stiff and non-stiff ODEs</h1>
<div class="frame">
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<table border=0 cellpadding=2 cellspacing=0>
<tr>
<td align="right"><b>
<em>From</em></b></td>
<td align="left">
Alan Hindmarsh &lt;<a href="mailto:alanh%40llnl.gov">alanh@llnl.gov</a>&gt;</td>
</tr>

<tr>
<td align="right"><b>
<em>Date</em></b></td>
<td align="left">
Tue, 28 Nov 2006 12:42:25 -0800 (PST)</td>
</tr>

</table>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div>
<div class="container">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>Hello Kevin,

At the moment, this must be done externally to CVODE.  If you know
when the system changes from stiff to nonstiff and back, simply stop
the integration at each of those points, make appropriate calls to
linear solver specification and option Set functions, and then call
CVodeReInit to restart with the other method.

If you do not know where the changes occur, you'll have to stick with
the stiff method.  Of course there is a cost penalty if and when the
system is nonstiff; the extent of this depends on problem size and the
linear system method used.

You can also try making a determination after the fact, for any given
run with the nonstiff method, by seeing whether the number of steps
used was much larger than warranted to resolve the solution.  If it
was, the problem was probably stiff, and knowing this may help with
prior determination of stiffness for future cases.

We have Fortran ODE solvers that have internal automatic method-switching
in them, but have not yet put that into CVODE.  But it is good to know
that there is some user demand for it.

-Alan H


On Sun, 26 Nov 2006, Kevin Neff wrote:

&gt;<i></i>
&gt;<i> Hello,</i>
&gt;<i></i>
&gt;<i> I am working on a chemical kinetics problem that involves using an</i>
&gt;<i> optimizer to create a subset of parameters for a smallish system of ODEs.</i>
&gt;<i> Sometimes, the resulting system is stiff, but often not.  How can I switch</i>
&gt;<i> CVODE between stiff and non-stiff programatically?  How do I detect if a</i>
&gt;<i> system is stiff?  Is there a large performance penalty for assuming</i>
&gt;<i> stiffness?</i>
&gt;<i></i>
&gt;<i> --Kevin</i>
&gt;<i></i>
&gt;<i></i>

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<div class="container">
<table width="95%" frame="below"><tr><td></td></table>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00784" href="msg00784.html">[sundials-users] Adapting to stiff and non-stiff ODEs</a></strong>
<ul><li><em>From:</em> &quot;Kevin Neff&quot; &lt;NeffK@ieee.org&gt;</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00786.html">[sundials-users] Fortran 95/90</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00788.html">Re: [sundials-users] multiple calls to CVODE in a single program</a></strong>
</li>

<li>Previous by thread:
<strong><a href="msg00780.html">Re: [sundials-users] Adapting to stiff and non-stiff ODEs</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00786.html">[sundials-users] Fortran 95/90</a></strong>
</li>

<li>Index(es):
<ul>
<li><a href="maillist.html#00787">
<strong>Main</strong></a></li>
<li><a href="threads.html#00787">
<strong>Thread</strong></a></li>
</ul>
</li>
</ul>
</div>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<!-- End content for this page -->
  </div>
  </td>
  <td background="../../graphics/table_bck3.gif"></td>
  </tr>
  <tr valign="top">
  <td height="17" background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  <td width="116"><a HREF="http://www.llnl.gov/disclaimer.html" target="_top"><img SRC="../../graphics/line_bl.gif" height="17" width="116" border="0"></a></td>
  <td width="720"><img SRC="../../graphics/line_br.gif" height="17" width="720" border="0"></td>
  <td background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  </tr>
  </table>
</body>
</html>
