<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: [sundials&#45;users] Sundials Toolbox on windows -->
<!--X-From-R13: Dnqh Ereona <enqhNyyay.tbi> -->
<!--X-Date: Fri, 23 Jun 2006 11:33:18 &#45;0700 -->
<!--X-Message-Id: 449C32C5.9010709@llnl.gov -->
<!--X-Content-Type: multipart/mixed -->
<!--X-Reference: 19544DDD29208A4A924C554E08BF789D117BC8@WCXLMAIL.wcrt.xeroxlabs.com -->
<!--X-Head-End-->
<html>
<head>
<title>Re: [sundials-users] Sundials Toolbox on windows</title>
<meta name="author" content="Radu Serban">
<meta name="description" content="suite of nonlinear differential algebraic equation solvers">
<meta name="keywords" content="SUNDIALS, CVODE, CVODES, IDA, KINSOL">
<meta name="keywords" content="ODE, DAE, sensitivity">
<meta name="keywords" content="differential, algebraic">
<link REL="SHORTCUT ICON" HREF="img/favicon.ico" type="image/x-icon">
<link REL="ICON" HREF="img/favicon.ico" type="image/x-icon">
<link href="../../sundials_styles.css" rel="stylesheet" type="text/css">
<script language="JavaScript">
<!--
homeon = new Image();           homeon.src = "../../graphics/home_buttonH.png";
homeoff = new Image();          homeoff.src = "../../graphics/home_button.png";
descriptionon = new Image();    descriptionon.src = "../../graphics/description_buttonH.png";
descriptionoff = new Image();   descriptionoff.src = "../../graphics/description_button.png";
documentationon = new Image();  documentationon.src = "../../graphics/documentation_buttonH.png";
documentationoff = new Image(); documentationoff.src = "../../graphics/documentation_button.png";
downloadon = new Image();       downloadon.src = "../../graphics/download_buttonH.png";
downloadoff = new Image();      downloadoff.src = "../../graphics/download_button.png";
supporton = new Image();        supporton.src = "../../graphics/support_buttonH.png";
supportoff = new Image();       supportoff.src = "../../graphics/support_button.png";
//-->
</script>
<script src="../../sunjs.js" type="text/javascript" language="javascript1.2"></script>
</head>
<!-- ******************************************************************************** -->
<body>
<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
  <td height="60" background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  <td width="116"><img SRC="../../graphics/head_top_left.png" height="60" width="116" border="0"></td>
  <td width="720"><img SRC="../../graphics/head_mail_top_right.png" height="60" width="720" border="0"></td>
  <td background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  </tr>
  <tr valign="top">
  <td height="127" background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  <td width="116">
    <a href="../../main.html" onMouseOver="img_act('home'); return true;" onMouseOut="img_inact('home'); return true;"><img src="../../graphics/home_button.png" border="0" name="home"></a><br>
    <a href="../../description/description.html" onMouseOver="img_act('description'); return true;" onMouseOut="img_inact('description'); return true;"><img src="../../graphics/description_button.png" border="0" name="description"></a><br>
    <a href="../../documentation/documentation.html" onMouseOver="img_act('documentation'); return true;" onMouseOut="img_inact('documentation'); return true;"><img src="../../graphics/documentation_button.png" border="0" name="documentation"></a><br>
    <a href="../../download/download.html" onMouseOver="img_act('download'); return true;" onMouseOut="img_inact('download'); return true;"><img src="../../graphics/download_button.png" border="0" name="download"></a><br>
    <a href="../../support/support.html" onMouseOver="img_act('support'); return true;" onMouseOut="img_inact('support'); return true;"><img src="../../graphics/support_button.png" border="0" name="support"></a><br>
    <img SRC="../../graphics/line_tl.gif" height="7" width="116" border="0"></td>
  <td width="720">
      <img SRC="../../graphics/head_bottom_right.png" height="120" width="720" border="0"><br>
      <img SRC="../../graphics/line_tr.gif" height="7" width="720" border="0"></td>
  <td background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  </tr>
  <tr valign="top">
  <td background="../../graphics/table_bck3.gif"></td>
  <td width="116" valign="bottom" align="center" background="../../graphics/table_bck5.gif"><img SRC="../../graphics/logo.png" border="0"></td>
  <td width="720" bgcolor="#ffffff">
  <div id="content">   
<!-- Start content for this page -->
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<p class="links">
[<a href="msg00537.html">Date Prev</a>] [<a href="msg00539.html">Date Next</a>] [<a href="msg00537.html">Thread Prev</a>] [<a href="msg00539.html">Thread Next</a>]<br>
[<b><a href="maillist.html#00538">Date Index</a></b>]
[<b><a href="threads.html#00538">Thread Index</a></b>]
</p>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [sundials-users] Sundials Toolbox on windows</h1>
<div class="frame">
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<table border=0 cellpadding=2 cellspacing=0>
<tr>
<td align="right"><b>
<em>From</em></b></td>
<td align="left">
Radu Serban &lt;<a href="mailto:radu%40llnl.gov">radu@llnl.gov</a>&gt;</td>
</tr>

<tr>
<td align="right"><b>
<em>Date</em></b></td>
<td align="left">
Fri, 23 Jun 2006 11:28:21 -0700</td>
</tr>

</table>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div>
<div class="container">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<tt>Lopez, Daniel wrote:
</tt><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><tt>Hi, </tt><br>
<br>
<tt>I was wondering if anyone else has ran into the same issues that I have<br>
with getting the Sundials TB to run under matlab on windows.  By making<br>
a few changes to the Install_STB file I was able to get the install<br>
process to work, but now when I try to run any of the examples I don't<br>
have the kim function.  </tt><br>
<br>
<tt> </tt><br>
<br>
<pre style="margin: 0em;">The changes that I made were lines 154 and 259, where I changed
eval(mex_cmd) to 'cvm' and 'kim' respectively.  I then copied the
folders kim and cvm created in my main directory and pasted them into
the toolbox where they belong.  However, I don't think a mex file named
kim was ever created, and it seems to me like this might be the problem.
Can anyone help me with this?</pre><br>
<pre style="margin: 0em;">Thanks,</pre><br>
<tt> </tt><br>
<br>
<pre style="margin: 0em;">Daniel Lopez</pre><br>
<pre style="margin: 0em;">Xerox Innovation Group</pre><br>
<br>
</blockquote><pre style="margin: 0em;"><br>Dan,</pre><br>
<tt>I'm not quite sure what you mean by the install process working after the two changes you've made. You never call the mex script so 
obviously you will not get the mex files cvm.dll and kim.dll.</tt><br>
<br>
<pre style="margin: 0em;">What prompted you to make those modifications to install_STB.m?</pre><br>
<tt>I installed sundialsTB for Windows only using cygwin and that worked just fine using the distribution install_STB.m. However, now I realize 
that there may be some issues related to the format of file paths on Windows. I attached a modified install_STB.m which uses the platform 
independent fullfile function to create the necessary full filenames. Maybe your installation problem was related to this?</tt><br>
<br>
<pre style="margin: 0em;">--Radu</pre><br>
<pre style="margin: 0em;">--
   Radu Serban
   Center for Applied Scientific Computing   [email] radu@llnl.gov
   Lawrence Livermore National Laboratory    [phone] 925-424-4852
   P.O. Box 808, L-560                       [fax]   925-422-6287
   Livermore, CA 94551
</pre><pre>function [] = install_STB
%
% INSTALL_STB Compilation of sundialsTB MEX files

% Radu Serban &lt;radu@llnl.gov&gt;
% Copyright (c) 2005, The Regents of the University of California.
% $Revision: 1.1 $Date: 2006/03/07 01:19:46 $

% Turn on debugging?

dbg = true;

% Location of sundialsTB

stb = pwd;

% Location of SUNDIALS

sun = input('SUNDIALS home directory: ','s');

if ~exist(sun, 'dir')
    error('SUNDIALS not found');
end


% Should we enable parallel support?

par = true;
if isempty(getenv('LAMHOME'))
    par = false;
end
if isempty(getenv('MPITB_ROOT'))
    par = false;
end
q = [sun '/nvec_par'];
if ~exist(q, 'dir')
    par = false;
end

% Compile cvm MEX file

q = fullfile(sun,'cvodes');
if exist(q,'dir')
    install_CVM(stb,sun,par,dbg);
end

% Compile kim MEX file

q = fullfile(sun, 'kinsol');
if exist(q,'dir')
    install_KIM(stb,sun,par,dbg);
end

%---------------------------------------------------------------------------------
% compilation of cvm MEX file
%---------------------------------------------------------------------------------

function [] = install_CVM(stb,sun,par,dbg)

cvm_sources = {
    fullfile(stb,'src','cvm','cvm.c')
    fullfile(stb,'src','cvm','cvmWrap.c')
    fullfile(stb,'src','cvm','cvmOpts.c')
    };
if par
    nvm_sources = {
        fullfile(stb,'src','nvm','nvm_parallel.c')
        fullfile(stb,'src','nvm','nvm_ops.c')
        };
else
    nvm_sources = {
        fullfile(stb,'src','nvm','nvm_serial.c')
        fullfile(stb,'src','nvm','nvm_ops.c')
        };
end
sources = '';
for i=1:length(cvm_sources)
    sources = sprintf('%s %s',sources,cvm_sources{i});
end
for i=1:length(nvm_sources)
    sources = sprintf('%s %s',sources,nvm_sources{i});
end

stb_srcdir = fullfile(stb,'src');
cvm_incdir = fullfile(stb,'src','cvm');
nvm_incdir = fullfile(stb,'src','nvm');
includes = sprintf('-I%s -I%s -I%s',stb_srcdir,cvm_incdir,nvm_incdir);

libraries = '';

% Add CVODES sources and header files

cvs_sources = {
    fullfile(sun,'cvodes','source','cvodes_band.c')
    fullfile(sun,'cvodes','source','cvodes_bandpre.c')
    fullfile(sun,'cvodes','source','cvodes_bbdpre.c')
    fullfile(sun,'cvodes','source','cvodes_dense.c')
    fullfile(sun,'cvodes','source','cvodes_diag.c')
    fullfile(sun,'cvodes','source','cvodea.c')
    fullfile(sun,'cvodes','source','cvodes.c')
    fullfile(sun,'cvodes','source','cvodes_io.c')
    fullfile(sun,'cvodes','source','cvodea_io.c')
    fullfile(sun,'cvodes','source','cvodes_spils.c')
    fullfile(sun,'cvodes','source','cvodes_spbcgs.c')
    fullfile(sun,'cvodes','source','cvodes_spgmr.c')
    fullfile(sun,'cvodes','source','cvodes_sptfqmr.c')
    };
shr_sources = {
    fullfile(sun,'shared','source','sundials_band.c')
    fullfile(sun,'shared','source','sundials_dense.c')
    fullfile(sun,'shared','source','sundials_iterative.c')
    fullfile(sun,'shared','source','sundials_nvector.c')
    fullfile(sun,'shared','source','sundials_smalldense.c')
    fullfile(sun,'shared','source','sundials_spbcgs.c')
    fullfile(sun,'shared','source','sundials_spgmr.c')
    fullfile(sun,'shared','source','sundials_sptfqmr.c')
    fullfile(sun,'shared','source','sundials_math.c')
    };
for i=1:length(cvs_sources)
    sources = sprintf('%s %s',sources,cvs_sources{i});
end
for i=1:length(shr_sources)
    sources = sprintf('%s %s',sources,shr_sources{i});
end

cvs_incdir = fullfile(sun, 'cvodes', 'include');
cvs_srcdir = fullfile(sun, 'cvodes', 'source');
shr_incdir = fullfile(sun, 'shared', 'include');
includes = sprintf('%s -I%s -I%s 
-I%s',includes,cvs_incdir,cvs_srcdir,shr_incdir);

% Add NVEC_SER sources and header files

nvs_sources = fullfile(sun, 'nvec_ser', 'nvector_serial.c');
sources = sprintf('%s %s',sources, nvs_sources);
nvs_incdir = fullfile(sun, 'nvec_ser');
includes = sprintf('%s -I%s',includes,nvs_incdir);

if par
  
    % Add NVEC_PAR sources and header files

  nvp_sources = fullfile(sun, 'nvec_par', 'nvector_parallel.c');
  sources = sprintf('%s %s',sources, nvp_sources);
  nvp_incdir = fullfile(sun, 'nvec_par');
  includes = sprintf('%s -I%s',includes,nvp_incdir);

% Add LAM headers and libraries

  lam = getenv('LAMHOME');
  lam_incdir = fullfile(lam, 'include');
  lam_libdir = fullfile(lam, 'lib');
  includes = sprintf('%s -I%s',includes,lam_incdir);
  libraries = sprintf('%s -L%s -lmpi -llam -lutil',libraries,lam_libdir);

end

% Create MEX file

cvm_dir = fullfile(stb, 'cvodes', 'cvm');
cd(cvm_dir)
if dbg
    mex_cmd = 'mex -g';
else
    mex_cmd = 'mex';
end
mex_cmd = sprintf('%s -v %s %s %s', mex_cmd, includes, sources, libraries);
disp(mex_cmd);
eval(mex_cmd);

% Move back to sundialsTB

cd(stb)


%---------------------------------------------------------------------------------
% compilation of KINSOL MEX file
%---------------------------------------------------------------------------------

function [] = install_KIM(stb,sun,par,dbg)

kim_sources = {
    fullfile(stb,'src','kim','kim.c')
    fullfile(stb,'src','kim','kimWrap.c')
    fullfile(stb,'src','kim','kimOpts.c')
    };
if par
    nvm_sources = {
        fullfile(stb,'src','nvm','nvm_parallel.c')
        fullfile(stb,'src','nvm','nvm_ops.c')
        };
else
    nvm_sources = {
        fullfile(stb,'src','nvm','nvm_serial.c')
        fullfile(stb,'src','nvm','nvm_ops.c')
        };
end
sources = '';
for i=1:length(kim_sources)
    sources = sprintf('%s %s',sources,kim_sources{i});
end
for i=1:length(nvm_sources)
    sources = sprintf('%s %s',sources,nvm_sources{i});
end

stb_srcdir = fullfile(stb,'src');
kim_incdir = fullfile(stb,'src','kim');
nvm_incdir = fullfile(stb,'src','nvm');
includes = sprintf('-I%s -I%s -I%s',stb_srcdir,kim_incdir,nvm_incdir);

libraries = '';

% Add KINSOL sources and header files

kin_sources = {
    fullfile(sun,'kinsol','source','kinsol_band.c')
    fullfile(sun,'kinsol','source','kinsol_bbdpre.c')
    fullfile(sun,'kinsol','source','kinsol_dense.c')
    fullfile(sun,'kinsol','source','kinsol.c')
    fullfile(sun,'kinsol','source','kinsol_io.c')
    fullfile(sun,'kinsol','source','kinsol_spils.c')
    fullfile(sun,'kinsol','source','kinsol_spbcgs.c')
    fullfile(sun,'kinsol','source','kinsol_spgmr.c')
    fullfile(sun,'kinsol','source','kinsol_sptfqmr.c')
    };
shr_sources = {
    fullfile(sun,'shared','source','sundials_band.c')
    fullfile(sun,'shared','source','sundials_dense.c')
    fullfile(sun,'shared','source','sundials_iterative.c')
    fullfile(sun,'shared','source','sundials_nvector.c')
    fullfile(sun,'shared','source','sundials_smalldense.c')
    fullfile(sun,'shared','source','sundials_spbcgs.c')
    fullfile(sun,'shared','source','sundials_spgmr.c')
    fullfile(sun,'shared','source','sundials_sptfqmr.c')
    fullfile(sun,'shared','source','sundials_math.c')
    };

for i=1:length(kin_sources)
    sources = sprintf('%s %s',sources,kin_sources{i});
end
for i=1:length(shr_sources)
    sources = sprintf('%s %s',sources,shr_sources{i});
end

kin_incdir = fullfile(sun, 'kinsol', 'include');
kin_srcdir = fullfile(sun, 'kinsol', 'source');
shr_incdir = fullfile(sun, 'shared', 'include');
includes = sprintf('%s -I%s -I%s 
-I%s',includes,kin_incdir,kin_srcdir,shr_incdir);

% Add NVEC_SER sources and header files

nvs_sources = fullfile(sun, 'nvec_ser', 'nvector_serial.c');
sources = sprintf('%s %s',sources, nvs_sources);
nvs_incdir = fullfile(sun, 'nvec_ser');
includes = sprintf('%s -I%s',includes,nvs_incdir);

if par

% Add NVEC_PAR sources and header files

  nvp_sources = fullfile(sun, 'nvec_par', 'nvector_parallel.c');
  sources = sprintf('%s %s',sources, nvp_sources);
  nvp_incdir = fullfile(sun, 'nvec_par');
  includes = sprintf('%s -I%s',includes,nvp_incdir);
  
% Add LAM headers and libraries
  
  lam = getenv('LAMHOME');
  lam_incdir = fullfile(lam, 'include');
  lam_libdir = fullfile(lam, 'lib');
  includes = sprintf('%s -I%s',includes,lam_incdir);
  libraries = sprintf('%s -L%s -lmpi -llam -lutil',libraries,lam_libdir);

end

% Create MEX file

kim_dir = fullfile(stb, 'kinsol', 'kim');
cd(kim_dir)
if dbg
    mex_cmd = 'mex -g';
else
    mex_cmd = 'mex';
end
mex_cmd = sprintf('%s -v %s %s %s', mex_cmd, includes, sources, libraries);
disp(mex_cmd);
eval(mex_cmd);

% Move back to sundialsTB

cd(stb)

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<div class="container">
<table width="95%" frame="below"><tr><td></td></table>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00539" href="msg00539.html">RE: [sundials-users] Sundials Toolbox on windows</a></strong>
<ul><li><em>From:</em> &quot;Lopez, Daniel&quot; &lt;Daniel.Lopez@xeroxlabs.com&gt;</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00537" href="msg00537.html">[sundials-users] Sundials Toolbox on windows</a></strong>
<ul><li><em>From:</em> &quot;Lopez, Daniel&quot; &lt;Daniel.Lopez@xeroxlabs.com&gt;</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00537.html">[sundials-users] Sundials Toolbox on windows</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00539.html">RE: [sundials-users] Sundials Toolbox on windows</a></strong>
</li>

<li>Previous by thread:
<strong><a href="msg00537.html">[sundials-users] Sundials Toolbox on windows</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00539.html">RE: [sundials-users] Sundials Toolbox on windows</a></strong>
</li>

<li>Index(es):
<ul>
<li><a href="maillist.html#00538">
<strong>Main</strong></a></li>
<li><a href="threads.html#00538">
<strong>Thread</strong></a></li>
</ul>
</li>
</ul>
</div>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<!-- End content for this page -->
  </div>
  </td>
  <td background="../../graphics/table_bck3.gif"></td>
  </tr>
  <tr valign="top">
  <td height="17" background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  <td width="116"><a HREF="http://www.llnl.gov/disclaimer.html" target="_top"><img SRC="../../graphics/line_bl.gif" height="17" width="116" border="0"></a></td>
  <td width="720"><img SRC="../../graphics/line_br.gif" height="17" width="720" border="0"></td>
  <td background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  </tr>
  </table>
</body>
</html>
