<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: [sundials&#45;users] KINGetNumFuncEvals returns wrong count -->
<!--X-From-R13: Dnqh Ereona <enqhNyyay.tbi> -->
<!--X-Date: Fri, 27 Oct 2006 14:17:35 &#45;0700 -->
<!--X-Message-Id: 454276E3.2050605@llnl.gov -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: op.th3jemtdt8lo91@smtp.kuleuven.ac.be -->
<!--X-Reference: 45426AB5.1090209@llnl.gov -->
<!--X-Reference: op.th3lrzj8t8lo91@smtp.kuleuven.ac.be -->
<!--X-Head-End-->
<html>
<head>
<title>Re: [sundials-users] KINGetNumFuncEvals returns wrong count</title>
<meta name="author" content="Radu Serban">
<meta name="description" content="suite of nonlinear differential algebraic equation solvers">
<meta name="keywords" content="SUNDIALS, CVODE, CVODES, IDA, KINSOL">
<meta name="keywords" content="ODE, DAE, sensitivity">
<meta name="keywords" content="differential, algebraic">
<link REL="SHORTCUT ICON" HREF="img/favicon.ico" type="image/x-icon">
<link REL="ICON" HREF="img/favicon.ico" type="image/x-icon">
<link href="../../sundials_styles.css" rel="stylesheet" type="text/css">
<script language="JavaScript">
<!--
homeon = new Image();           homeon.src = "../../graphics/home_buttonH.png";
homeoff = new Image();          homeoff.src = "../../graphics/home_button.png";
descriptionon = new Image();    descriptionon.src = "../../graphics/description_buttonH.png";
descriptionoff = new Image();   descriptionoff.src = "../../graphics/description_button.png";
documentationon = new Image();  documentationon.src = "../../graphics/documentation_buttonH.png";
documentationoff = new Image(); documentationoff.src = "../../graphics/documentation_button.png";
downloadon = new Image();       downloadon.src = "../../graphics/download_buttonH.png";
downloadoff = new Image();      downloadoff.src = "../../graphics/download_button.png";
supporton = new Image();        supporton.src = "../../graphics/support_buttonH.png";
supportoff = new Image();       supportoff.src = "../../graphics/support_button.png";
//-->
</script>
<script src="../../sunjs.js" type="text/javascript" language="javascript1.2"></script>
</head>
<!-- ******************************************************************************** -->
<body>
<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
  <td height="60" background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  <td width="116"><img SRC="../../graphics/head_top_left.png" height="60" width="116" border="0"></td>
  <td width="720"><img SRC="../../graphics/head_mail_top_right.png" height="60" width="720" border="0"></td>
  <td background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  </tr>
  <tr valign="top">
  <td height="127" background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  <td width="116">
    <a href="../../main.html" onMouseOver="img_act('home'); return true;" onMouseOut="img_inact('home'); return true;"><img src="../../graphics/home_button.png" border="0" name="home"></a><br>
    <a href="../../description/description.html" onMouseOver="img_act('description'); return true;" onMouseOut="img_inact('description'); return true;"><img src="../../graphics/description_button.png" border="0" name="description"></a><br>
    <a href="../../documentation/documentation.html" onMouseOver="img_act('documentation'); return true;" onMouseOut="img_inact('documentation'); return true;"><img src="../../graphics/documentation_button.png" border="0" name="documentation"></a><br>
    <a href="../../download/download.html" onMouseOver="img_act('download'); return true;" onMouseOut="img_inact('download'); return true;"><img src="../../graphics/download_button.png" border="0" name="download"></a><br>
    <a href="../../support/support.html" onMouseOver="img_act('support'); return true;" onMouseOut="img_inact('support'); return true;"><img src="../../graphics/support_button.png" border="0" name="support"></a><br>
    <img SRC="../../graphics/line_tl.gif" height="7" width="116" border="0"></td>
  <td width="720">
      <img SRC="../../graphics/head_bottom_right.png" height="120" width="720" border="0"><br>
      <img SRC="../../graphics/line_tr.gif" height="7" width="720" border="0"></td>
  <td background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  </tr>
  <tr valign="top">
  <td background="../../graphics/table_bck3.gif"></td>
  <td width="116" valign="bottom" align="center" background="../../graphics/table_bck5.gif"><img SRC="../../graphics/logo.png" border="0"></td>
  <td width="720" bgcolor="#ffffff">
  <div id="content">   
<!-- Start content for this page -->
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<p class="links">
[<a href="msg00760.html">Date Prev</a>] [<a href="msg00762.html">Date Next</a>] [<a href="msg00760.html">Thread Prev</a>] [<a href="msg00758.html">Thread Next</a>]<br>
[<b><a href="maillist.html#00761">Date Index</a></b>]
[<b><a href="threads.html#00761">Thread Index</a></b>]
</p>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [sundials-users] KINGetNumFuncEvals returns wrong count</h1>
<div class="frame">
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<table border=0 cellpadding=2 cellspacing=0>
<tr>
<td align="right"><b>
<em>From</em></b></td>
<td align="left">
Radu Serban &lt;<a href="mailto:radu%40llnl.gov">radu@llnl.gov</a>&gt;</td>
</tr>

<tr>
<td align="right"><b>
<em>Date</em></b></td>
<td align="left">
Fri, 27 Oct 2006 14:15:15 -0700</td>
</tr>

</table>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div>
<div class="container">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
Andreas Nicolai wrote:
<blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">Hi again,</pre><br>
<blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">However, note that the value returned by KINGetNumFuncEvals does not take into
account any function evaluations needed for the DQ Jacobian approximation. To
get the number of these additional function evaluations, use the appropriate
optional get function for the linear solver you're using (e.g.
KINDenseGetNumFuncEvals for the DENSE linear solver).
</pre></blockquote><pre style="margin: 0em;"><br>Yes, I should have checked that (I always forget that there source code is 
right there to look at).
The counter nfe and nfes are incremented separately (one in kinsol.c and one in 
kinsol_spils.c).</pre><br>
<pre style="margin: 0em;">Also, printing out the uu values with (a lot more) accuracy shows that there is 
indeed a change of the values. Still, two times the uu vector stays the same.</pre><br>
<pre style="margin: 0em;">5.550800000000000267e+01  0.000000000000000000e+00  0.000000000000000000e+00  
5.000000000000000000e+00          1.000000000000000000e+00
5.550800082713365668e+01  0.000000000000000000e+00  0.000000000000000000e+00  
5.000000074505805969e+00          1.000000014901161193e+00
5.550800082713365668e+01  0.000000000000000000e+00  0.000000000000000000e+00  
5.000000074505805969e+00          1.000000014901161193e+00
5.550799999999995294e+00  0.000000000000000000e+00  0.000000000000000000e+00  
5.000000000000000000e-01          9.999999999999997780e-02
5.550800082713361228e+00  0.000000000000000000e+00  0.000000000000000000e+00  
5.000000074505805969e-01          1.000000014901160916e-01
5.550800082713361228e+00  0.000000000000000000e+00  0.000000000000000000e+00  
5.000000074505805969e-01          1.000000014901160916e-01
2.524338515996760180e-08  0.000000000000000000e+00  0.000000000000000000e+00  
2.273851051892705755e-09          4.547702214807713972e-10</pre><br>
<pre style="margin: 0em;">Result = KIN_SUCCESS
KINGetNumFuncEvals = 3
2.524338515996760180e-08  0.000000000000000000e+00  0.000000000000000000e+00  
2.273851051892705755e-09          4.547702214807713972e-10</pre><br>
<pre style="margin: 0em;"><br></pre><br>
<pre style="margin: 0em;">Andreas</pre><br>
</blockquote><pre style="margin: 0em;"><br></pre><br>
Andreas,<br>
Could you please provide all statistics (from both KINSOL and the linear solver, 
including nfes) and also tell us whether you use line search or not (strategy=? 
in the call to KINSol)?<br>
--Radu<br>
<br>
P.S. I'm fighting a flu so I'll go home now and I may not read my email until 
Monday....<br>
<br>
<pre style="margin: 0em;"><br></pre><br>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<div class="container">
<table width="95%" frame="below"><tr><td></td></table>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00756" href="msg00756.html">[sundials-users] KINGetNumFuncEvals returns wrong count</a></strong>
<ul><li><em>From:</em> &quot;Andreas Nicolai&quot; &lt;Andreas.Nicolai@gmx.net&gt;</li></ul></li>
<li><strong><a name="00757" href="msg00757.html">Re: [sundials-users] KINGetNumFuncEvals returns wrong count</a></strong>
<ul><li><em>From:</em> Radu Serban &lt;radu@llnl.gov&gt;</li></ul></li>
<li><strong><a name="00760" href="msg00760.html">Re: [sundials-users] KINGetNumFuncEvals returns wrong count</a></strong>
<ul><li><em>From:</em> &quot;Andreas Nicolai&quot; &lt;Andreas.Nicolai@gmx.net&gt;</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00760.html">Re: [sundials-users] KINGetNumFuncEvals returns wrong count</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00762.html">Re: [sundials-users] A Question</a></strong>
</li>

<li>Previous by thread:
<strong><a href="msg00760.html">Re: [sundials-users] KINGetNumFuncEvals returns wrong count</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00758.html">[sundials-users] Kinsol problem : multiple evaluations of RHS without changes in uu?</a></strong>
</li>

<li>Index(es):
<ul>
<li><a href="maillist.html#00761">
<strong>Main</strong></a></li>
<li><a href="threads.html#00761">
<strong>Thread</strong></a></li>
</ul>
</li>
</ul>
</div>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<!-- End content for this page -->
  </div>
  </td>
  <td background="../../graphics/table_bck3.gif"></td>
  </tr>
  <tr valign="top">
  <td height="17" background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  <td width="116"><a HREF="http://www.llnl.gov/disclaimer.html" target="_top"><img SRC="../../graphics/line_bl.gif" height="17" width="116" border="0"></a></td>
  <td width="720"><img SRC="../../graphics/line_br.gif" height="17" width="720" border="0"></td>
  <td background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  </tr>
  </table>
</body>
</html>
