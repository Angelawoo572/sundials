<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: Prefered way to "tell the solver" that he should retry with smaller timesteps... -->
<!--X-From-R13: Oyna Vvaqznefu <nynauNyyay.tbi> -->
<!--X-Date: Mon, 18 Apr 2005 13:54:47 &#45;0700 (PDT) -->
<!--X-Message-Id: Pine.LNX.4.58.0504181351560.24845@tux64.llnl.gov -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: opspb6slsxt8lo91@smtp.kuleuven.ac.be -->
<!--X-Head-End-->
<html>
<head>
<title>Re: Prefered way to &quot;tell the solver&quot; that he should retry with smaller timesteps...</title>
<meta name="author" content="Radu Serban">
<meta name="description" content="suite of nonlinear differential algebraic equation solvers">
<meta name="keywords" content="SUNDIALS, CVODE, CVODES, IDA, KINSOL">
<meta name="keywords" content="ODE, DAE, sensitivity">
<meta name="keywords" content="differential, algebraic">
<link REL="SHORTCUT ICON" HREF="img/favicon.ico" type="image/x-icon">
<link REL="ICON" HREF="img/favicon.ico" type="image/x-icon">
<link href="../../sundials_styles.css" rel="stylesheet" type="text/css">
<script language="JavaScript">
<!--
homeon = new Image();           homeon.src = "../../graphics/home_buttonH.png";
homeoff = new Image();          homeoff.src = "../../graphics/home_button.png";
descriptionon = new Image();    descriptionon.src = "../../graphics/description_buttonH.png";
descriptionoff = new Image();   descriptionoff.src = "../../graphics/description_button.png";
documentationon = new Image();  documentationon.src = "../../graphics/documentation_buttonH.png";
documentationoff = new Image(); documentationoff.src = "../../graphics/documentation_button.png";
downloadon = new Image();       downloadon.src = "../../graphics/download_buttonH.png";
downloadoff = new Image();      downloadoff.src = "../../graphics/download_button.png";
supporton = new Image();        supporton.src = "../../graphics/support_buttonH.png";
supportoff = new Image();       supportoff.src = "../../graphics/support_button.png";
//-->
</script>
<script src="../../sunjs.js" type="text/javascript" language="javascript1.2"></script>
</head>
<!-- ******************************************************************************** -->
<body>
<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
  <td height="60" background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  <td width="116"><img SRC="../../graphics/head_top_left.png" height="60" width="116" border="0"></td>
  <td width="720"><img SRC="../../graphics/head_mail_top_right.png" height="60" width="720" border="0"></td>
  <td background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  </tr>
  <tr valign="top">
  <td height="127" background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  <td width="116">
    <a href="../../main.html" onMouseOver="img_act('home'); return true;" onMouseOut="img_inact('home'); return true;"><img src="../../graphics/home_button.png" border="0" name="home"></a><br>
    <a href="../../description/description.html" onMouseOver="img_act('description'); return true;" onMouseOut="img_inact('description'); return true;"><img src="../../graphics/description_button.png" border="0" name="description"></a><br>
    <a href="../../documentation/documentation.html" onMouseOver="img_act('documentation'); return true;" onMouseOut="img_inact('documentation'); return true;"><img src="../../graphics/documentation_button.png" border="0" name="documentation"></a><br>
    <a href="../../download/download.html" onMouseOver="img_act('download'); return true;" onMouseOut="img_inact('download'); return true;"><img src="../../graphics/download_button.png" border="0" name="download"></a><br>
    <a href="../../support/support.html" onMouseOver="img_act('support'); return true;" onMouseOut="img_inact('support'); return true;"><img src="../../graphics/support_button.png" border="0" name="support"></a><br>
    <img SRC="../../graphics/line_tl.gif" height="7" width="116" border="0"></td>
  <td width="720">
      <img SRC="../../graphics/head_bottom_right.png" height="120" width="720" border="0"><br>
      <img SRC="../../graphics/line_tr.gif" height="7" width="720" border="0"></td>
  <td background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  </tr>
  <tr valign="top">
  <td background="../../graphics/table_bck3.gif"></td>
  <td width="116" valign="bottom" align="center" background="../../graphics/table_bck5.gif"><img SRC="../../graphics/logo.png" border="0"></td>
  <td width="720" bgcolor="#ffffff">
  <div id="content">   
<!-- Start content for this page -->
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<p class="links">
[<a href="msg00039.html">Date Prev</a>] [<a href="msg00041.html">Date Next</a>] [<a href="msg00039.html">Thread Prev</a>] [<a href="msg00041.html">Thread Next</a>]<br>
[<b><a href="maillist.html#00040">Date Index</a></b>]
[<b><a href="threads.html#00040">Thread Index</a></b>]
</p>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: Prefered way to &quot;tell the solver&quot; that he should retry with smaller timesteps...</h1>
<div class="frame">
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<table border=0 cellpadding=2 cellspacing=0>
<tr>
<td align="right"><b>
<em>From</em></b></td>
<td align="left">
Alan Hindmarsh &lt;<a href="mailto:alanh%40llnl.gov">alanh@llnl.gov</a>&gt;</td>
</tr>

<tr>
<td align="right"><b>
<em>Date</em></b></td>
<td align="left">
Mon, 18 Apr 2005 13:54:06 -0700 (PDT)</td>
</tr>

</table>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div>
<div class="container">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>
Hello Andreas,

In most cases, there is no need to tell the solver anything.  Small
(unphysical) negative values in the y vector -- below the noise level,
are usually harmless.  If you need to, you can correct these to zero
in local workspace within the RHS routine, for the purposes of
computing y_dot.  But in no circumstance should you correct them in the
y vector passed to that routine.  That will cause potentially unstable
behavior.  Likewise, feel free to make such corrections in your
calling program to generate clean output.

The size of the negative values should be kept to the noise level
by means of careful choice of tolerances, especially the absolute
tolerances.

I take it you are using CVODE.  If you are using KINSOL or IDA, there
is an option to force components to be non-negative.  But even that
should not be used unless it is really necessary.

-Alan Hindmarsh


On Sat, 16 Apr 2005, Andreas Nicolai wrote:

&gt;<i> Hi there,</i>
&gt;<i></i>
&gt;<i> in my PDE I have certain limits of the solution variables (like: can't have </i>
&gt;<i> negative masses, or temperatures below 0K). So far I solve the problem by </i>
&gt;<i> &quot;correcting&quot; the values I get in the y vector from the solver so that they </i>
&gt;<i> stay inside the preferred range.</i>
&gt;<i></i>
&gt;<i> Now, in such cases my divergences that I store in the y_dot vector are now </i>
&gt;<i> based on my corrected values, not on the values the solver gave me... I'm </i>
&gt;<i> wondering, how does that affect the result of the solution?</i>
&gt;<i></i>
&gt;<i> Would there be a way to &quot;tell the solver&quot;, that he just extrapolated a little </i>
&gt;<i> bit too much and should try again with another order/time step?</i>
&gt;<i></i>
&gt;<i> Bye,</i>
&gt;<i> Andreas</i>
&gt;<i></i>
&gt;<i> --</i>
&gt;<i> Andreas Nicolai                 Andreas.Nicolai@gmx.net</i>
&gt;<i> 959 Lancaster Avenue            001 (315) 422-0024</i>
&gt;<i> Syracuse NY 13210</i>
&gt;<i></i>

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<div class="container">
<table width="95%" frame="below"><tr><td></td></table>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00039" href="msg00039.html">Prefered way to &quot;tell the solver&quot; that he should retry with smaller timesteps...</a></strong>
<ul><li><em>From:</em> Andreas Nicolai &lt;Andreas.Nicolai@gmx.net&gt;</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00039.html">Prefered way to &quot;tell the solver&quot; that he should retry with smaller timesteps...</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00041.html">Shared libs</a></strong>
</li>

<li>Previous by thread:
<strong><a href="msg00039.html">Prefered way to &quot;tell the solver&quot; that he should retry with smaller timesteps...</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00041.html">Shared libs</a></strong>
</li>

<li>Index(es):
<ul>
<li><a href="maillist.html#00040">
<strong>Main</strong></a></li>
<li><a href="threads.html#00040">
<strong>Thread</strong></a></li>
</ul>
</li>
</ul>
</div>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<!-- End content for this page -->
  </div>
  </td>
  <td background="../../graphics/table_bck3.gif"></td>
  </tr>
  <tr valign="top">
  <td height="17" background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  <td width="116"><a HREF="http://www.llnl.gov/disclaimer.html" target="_top"><img SRC="../../graphics/line_bl.gif" height="17" width="116" border="0"></a></td>
  <td width="720"><img SRC="../../graphics/line_br.gif" height="17" width="720" border="0"></td>
  <td background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  </tr>
  </table>
</body>
</html>
