<!-- MHonArc v2.6.10 -->
<!--X-Subject: [sundials&#45;users] Re: Inquiry regarding CVODE -->
<!--X-From-R13: Dnqh Ereona <freona1Nyyay.tbi> -->
<!--X-Date: Tue, 30 May 2006 10:53:42 &#45;0700 (PDT) -->
<!--X-Message-Id: 447C851C.70405@llnl.gov -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 90004056.1148981680079.JavaMail.wwwadmin@phoebe.mathworks.com -->
<!--X-Head-End-->
<html>
<head>
<title>[sundials-users] Re: Inquiry regarding CVODE</title>
<meta name="author" content="Radu Serban">
<meta name="description" content="suite of nonlinear differential algebraic equation solvers">
<meta name="keywords" content="SUNDIALS, CVODE, CVODES, IDA, KINSOL">
<meta name="keywords" content="ODE, DAE, sensitivity">
<meta name="keywords" content="differential, algebraic">
<link REL="SHORTCUT ICON" HREF="img/favicon.ico" type="image/x-icon">
<link REL="ICON" HREF="img/favicon.ico" type="image/x-icon">
<link href="../../sundials_styles.css" rel="stylesheet" type="text/css">
<script language="JavaScript">
<!--
homeon = new Image();           homeon.src = "../../graphics/home_buttonH.png";
homeoff = new Image();          homeoff.src = "../../graphics/home_button.png";
descriptionon = new Image();    descriptionon.src = "../../graphics/description_buttonH.png";
descriptionoff = new Image();   descriptionoff.src = "../../graphics/description_button.png";
documentationon = new Image();  documentationon.src = "../../graphics/documentation_buttonH.png";
documentationoff = new Image(); documentationoff.src = "../../graphics/documentation_button.png";
downloadon = new Image();       downloadon.src = "../../graphics/download_buttonH.png";
downloadoff = new Image();      downloadoff.src = "../../graphics/download_button.png";
supporton = new Image();        supporton.src = "../../graphics/support_buttonH.png";
supportoff = new Image();       supportoff.src = "../../graphics/support_button.png";
//-->
</script>
<script src="../../sunjs.js" type="text/javascript" language="javascript1.2"></script>
</head>
<!-- ******************************************************************************** -->
<body>
<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
  <td height="60" background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  <td width="116"><img SRC="../../graphics/head_top_left.png" height="60" width="116" border="0"></td>
  <td width="720"><img SRC="../../graphics/head_mail_top_right.png" height="60" width="720" border="0"></td>
  <td background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  </tr>
  <tr valign="top">
  <td height="127" background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  <td width="116">
    <a href="../../main.html" onMouseOver="img_act('home'); return true;" onMouseOut="img_inact('home'); return true;"><img src="../../graphics/home_button.png" border="0" name="home"></a><br>
    <a href="../../description/description.html" onMouseOver="img_act('description'); return true;" onMouseOut="img_inact('description'); return true;"><img src="../../graphics/description_button.png" border="0" name="description"></a><br>
    <a href="../../documentation/documentation.html" onMouseOver="img_act('documentation'); return true;" onMouseOut="img_inact('documentation'); return true;"><img src="../../graphics/documentation_button.png" border="0" name="documentation"></a><br>
    <a href="../../download/download.html" onMouseOver="img_act('download'); return true;" onMouseOut="img_inact('download'); return true;"><img src="../../graphics/download_button.png" border="0" name="download"></a><br>
    <a href="../../support/support.html" onMouseOver="img_act('support'); return true;" onMouseOut="img_inact('support'); return true;"><img src="../../graphics/support_button.png" border="0" name="support"></a><br>
    <img SRC="../../graphics/line_tl.gif" height="7" width="116" border="0"></td>
  <td width="720">
      <img SRC="../../graphics/head_bottom_right.png" height="120" width="720" border="0"><br>
      <img SRC="../../graphics/line_tr.gif" height="7" width="720" border="0"></td>
  <td background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  </tr>
  <tr valign="top">
  <td background="../../graphics/table_bck3.gif"></td>
  <td width="116" valign="bottom" align="center" background="../../graphics/table_bck5.gif"><img SRC="../../graphics/logo.png" border="0"></td>
  <td width="720" bgcolor="#ffffff">
  <div id="content">   
<!-- Start content for this page -->
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<p class="links">
[<a href="msg00458.html">Date Prev</a>] [<a href="msg00460.html">Date Next</a>] [<a href="msg00456.html">Thread Prev</a>] [<a href="msg00460.html">Thread Next</a>]<br>
[<b><a href="maillist.html#00459">Date Index</a></b>]
[<b><a href="threads.html#00459">Thread Index</a></b>]
</p>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>[sundials-users] Re: Inquiry regarding CVODE</h1>
<div class="frame">
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<table border=0 cellpadding=2 cellspacing=0>
<tr>
<td align="right"><b>
<em>From</em></b></td>
<td align="left">
Radu Serban &lt;<a href="mailto:serban1%40llnl.gov">serban1@llnl.gov</a>&gt;</td>
</tr>

<tr>
<td align="right"><b>
<em>Date</em></b></td>
<td align="left">
Tue, 30 May 2006 10:47:08 -0700</td>
</tr>

</table>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div>
<div class="container">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
Dotan Algranati wrote:
<blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em">Dear Sir,<br>
It is of great honor for me to contact you after reading some of your papers.<br>
I&#x2019;m a graduate student, investigating the flow in the coronary system (the blood vessels feeding the heart). 
Making it as general as possible, I have a large-scale, stiff, fully non-linear ODE system to solve, that can be described as y'=Ay+b, where A and b should be updated each time step according to y. A is symmetric, positive definite, and sparse (5 elements per row) but poorly banded. The Jacobian itself is also sparse and poorly banded. I was able to solve a similar system with N~1000 using MATLAB&#x2019;s ode15s, and now I need to solve a system in which N is ~ 5*10^6.<br>
I thought about trying to solve it with CVODE. In addition, I&#x2019;m not much of a programmer, driving me to think about using the MATLAB interface.<br>
<br>
<pre style="margin: 0em;">1. From your experience, is CVODE the kind of tool I&#x2019;m looking for?
2. How large a problem can I solve with CVODE? I know that ode15s allocates an n-by-n 
Jacobian matrix, restricting me to &#x201C;small&#x201D; systems.
3. What kind of hardware am I looking for?
4. Any other comment would be of great help.</pre><br>
<pre style="margin: 0em;">Thank you for your time,</pre><br>
<pre style="margin: 0em;">Dotan Algranati
B.Sc. in Biomedical Engineering</pre><br>
<br>
</blockquote><pre style="margin: 0em;"><br>Dear Dotan,</pre><br>
Yes, CVODE is the right tool for the type of problem you have. It has been routinely used to solve systems with millions of unknowns. That 
being said, the only linear solvers currently provided with SUNDIALS that can effectively deal with large-scale systems are the Krylov ones 
which are matrix-free (i.e. never form the Jacobian matrix but rather require only Jacobian-vector products) but, for acceptable efficiency, 
require preconditioning. We plan on including a sparse direct linear solver, but one is not currently available. There is, of course, the 
option of providing your own linear solver (all SUNDIALS solvers define a generic interface to the linear solver module), but that's 
probably more programming that you want.<br>
<br>
You say your system is of the form y' = A(y)*y + b(y). While from CVODE's point of view this is just y' = f(y) (i.e. for the integration we 
do not assume anything about the structure of the right-hand side), this particular form may be useful in building an appropriate 
preconditioner. I suspect your ODE arises from the semi-discretization of some PDE. Maybe you can give a few more details on the form of A 
and b? Also, when you say that A (and J) are 'poorly banded', do you mean that they are banded but with several sub- and superdiagonals that 
are zero (or could be brought to this form)? If that is the case, you may be able to use a modified version of the banded linear solver 
module in CVODE which would explicitly take care of the zero diagonals.<br>
<br>
You could certainly use the Matlab interface to CVODES to solve your problem, but you need to keep in mind that sundialsTB uses Matlab 
m-files for the main driver and all user-provided functions which will negatively impact performance. Moreover, if you want to parallelize 
your code, that will require additional Matlab tools (MPITB) as well as an MPI distribution that provides MPI-2 capabilities (LAM or MPICH2).<br>
<br>
Finally, SUNDIALS can be built on any platform that provides (at a minimum) a C compiler. The easiest installation is on a *NIX platform, 
using the configure script, but SUNDIALS has also been built under Windows using various IDEs (look at the FAQ and browse the sundials-users 
mailing list archive for discussions on this topic). For parallel support you'll also need an MPI distribution.<br>
<br>
<pre style="margin: 0em;">--Radu</pre><br>
P.S. I've cc-ed this message to the sundials-users mailing list to which I encourage you to post inquiries such as this (you can subscribe 
to the list from the Support page on the SUNDIALS website where you can also find an archive of previous messages).<br>
<br>
<pre style="margin: 0em;">--
   Radu Serban
   Center for Applied Scientific Computing   [email] radu@llnl.gov
   Lawrence Livermore National Laboratory    [phone] 925-424-4852
   P.O. Box 808, L-560                       [fax]   925-422-6287
   Livermore, CA 94551</pre><br>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<div class="container">
<table width="95%" frame="below"><tr><td></td></table>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00460" href="msg00460.html">[sundials-users] Re: Inquiry regarding CVODE</a></strong>
<ul><li><em>From:</em> dotana@techunix.technion.ac.il</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00458.html">Re: [sundials-users] Sequential optimization setup with sensitivities</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00460.html">[sundials-users] Re: Inquiry regarding CVODE</a></strong>
</li>

<li>Previous by thread:
<strong><a href="msg00456.html">[sundials-users] Sequential optimization setup with sensitivities</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00460.html">[sundials-users] Re: Inquiry regarding CVODE</a></strong>
</li>

<li>Index(es):
<ul>
<li><a href="maillist.html#00459">
<strong>Main</strong></a></li>
<li><a href="threads.html#00459">
<strong>Thread</strong></a></li>
</ul>
</li>
</ul>
</div>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<!-- End content for this page -->
  </div>
  </td>
  <td background="../../graphics/table_bck3.gif"></td>
  </tr>
  <tr valign="top">
  <td height="17" background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  <td width="116"><a HREF="http://www.llnl.gov/disclaimer.html" target="_top"><img SRC="../../graphics/line_bl.gif" height="17" width="116" border="0"></a></td>
  <td width="720"><img SRC="../../graphics/line_br.gif" height="17" width="720" border="0"></td>
  <td background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  </tr>
  </table>
</body>
</html>
