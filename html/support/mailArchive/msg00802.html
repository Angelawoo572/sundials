<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: [sundials&#45;users] SundialsTB::Cvodes::cvfdx.m -->
<!--X-From-R13: Dnqh Ereona <enqhNyyay.tbi> -->
<!--X-Date: Sun, 03 Dec 2006 08:21:50 &#45;0800 -->
<!--X-Message-Id: 4572F968.7070404@llnl.gov -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 35f4e4e10612030543g5a1ca0a1w4f4a862e1147f967@mail.gmail.com -->
<!--X-Head-End-->
<html>
<head>
<title>Re: [sundials-users] SundialsTB::Cvodes::cvfdx.m</title>
<meta name="author" content="Radu Serban">
<meta name="description" content="suite of nonlinear differential algebraic equation solvers">
<meta name="keywords" content="SUNDIALS, CVODE, CVODES, IDA, KINSOL">
<meta name="keywords" content="ODE, DAE, sensitivity">
<meta name="keywords" content="differential, algebraic">
<link REL="SHORTCUT ICON" HREF="img/favicon.ico" type="image/x-icon">
<link REL="ICON" HREF="img/favicon.ico" type="image/x-icon">
<link href="../../sundials_styles.css" rel="stylesheet" type="text/css">
<script language="JavaScript">
<!--
homeon = new Image();           homeon.src = "../../graphics/home_buttonH.png";
homeoff = new Image();          homeoff.src = "../../graphics/home_button.png";
descriptionon = new Image();    descriptionon.src = "../../graphics/description_buttonH.png";
descriptionoff = new Image();   descriptionoff.src = "../../graphics/description_button.png";
documentationon = new Image();  documentationon.src = "../../graphics/documentation_buttonH.png";
documentationoff = new Image(); documentationoff.src = "../../graphics/documentation_button.png";
downloadon = new Image();       downloadon.src = "../../graphics/download_buttonH.png";
downloadoff = new Image();      downloadoff.src = "../../graphics/download_button.png";
supporton = new Image();        supporton.src = "../../graphics/support_buttonH.png";
supportoff = new Image();       supportoff.src = "../../graphics/support_button.png";
//-->
</script>
<script src="../../sunjs.js" type="text/javascript" language="javascript1.2"></script>
</head>
<!-- ******************************************************************************** -->
<body>
<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
  <td height="60" background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  <td width="116"><img SRC="../../graphics/head_top_left.png" height="60" width="116" border="0"></td>
  <td width="720"><img SRC="../../graphics/head_mail_top_right.png" height="60" width="720" border="0"></td>
  <td background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  </tr>
  <tr valign="top">
  <td height="127" background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  <td width="116">
    <a href="../../main.html" onMouseOver="img_act('home'); return true;" onMouseOut="img_inact('home'); return true;"><img src="../../graphics/home_button.png" border="0" name="home"></a><br>
    <a href="../../description/description.html" onMouseOver="img_act('description'); return true;" onMouseOut="img_inact('description'); return true;"><img src="../../graphics/description_button.png" border="0" name="description"></a><br>
    <a href="../../documentation/documentation.html" onMouseOver="img_act('documentation'); return true;" onMouseOut="img_inact('documentation'); return true;"><img src="../../graphics/documentation_button.png" border="0" name="documentation"></a><br>
    <a href="../../download/download.html" onMouseOver="img_act('download'); return true;" onMouseOut="img_inact('download'); return true;"><img src="../../graphics/download_button.png" border="0" name="download"></a><br>
    <a href="../../support/support.html" onMouseOver="img_act('support'); return true;" onMouseOut="img_inact('support'); return true;"><img src="../../graphics/support_button.png" border="0" name="support"></a><br>
    <img SRC="../../graphics/line_tl.gif" height="7" width="116" border="0"></td>
  <td width="720">
      <img SRC="../../graphics/head_bottom_right.png" height="120" width="720" border="0"><br>
      <img SRC="../../graphics/line_tr.gif" height="7" width="720" border="0"></td>
  <td background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  </tr>
  <tr valign="top">
  <td background="../../graphics/table_bck3.gif"></td>
  <td width="116" valign="bottom" align="center" background="../../graphics/table_bck5.gif"><img SRC="../../graphics/logo.png" border="0"></td>
  <td width="720" bgcolor="#ffffff">
  <div id="content">   
<!-- Start content for this page -->
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<p class="links">
[<a href="msg00801.html">Date Prev</a>] [<a href="msg00803.html">Date Next</a>] [<a href="msg00808.html">Thread Prev</a>] [<a href="msg00809.html">Thread Next</a>]<br>
[<b><a href="maillist.html#00802">Date Index</a></b>]
[<b><a href="threads.html#00802">Thread Index</a></b>]
</p>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [sundials-users] SundialsTB::Cvodes::cvfdx.m</h1>
<div class="frame">
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<table border=0 cellpadding=2 cellspacing=0>
<tr>
<td align="right"><b>
<em>From</em></b></td>
<td align="left">
Radu Serban &lt;<a href="mailto:radu%40llnl.gov">radu@llnl.gov</a>&gt;</td>
</tr>

<tr>
<td align="right"><b>
<em>Date</em></b></td>
<td align="left">
Sun, 03 Dec 2006 08:20:56 -0800</td>
</tr>

</table>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div>
<div class="container">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Hi,</pre><br>
<tt>1. The monitoring capability in sundialsTB is mostly &quot;eye-candy&quot; and its 
implementation could certainly be made more robust. Moreover, with 
monitoring enabled, the code will run much slower. You can always 
achieve the same functionality from your own program by calling the 
CVode function in a loop over a sequence of output times (in 'Normal' 
mode) as is done in the cvbx example or in a loop in 'OneStep' mode (as 
done, for example, in the vdp example) and display/plot the solver 
statistics and/or solution yourself.</tt><br>
<br>
<tt>2. As Alex indicated, if you rely on the internal approximation of the 
sensitivity equations, you must indicate the array of problem parameters 
through the option 'ParamField' and select those with respect to which 
sensitivities are to be computed through the option 'ParamList'. On the 
other hand, if you provide your own sensitivity right-hand side function 
(through the option 'SensRhsFn') as in the cvfdx example, CVODES does 
not need to know what the parameters are.</tt><br>
<br>
<tt>3. For the methods used in the internal CVODES approximation of the 
sensitivity right-hand sides, see Section 3.2.3 of the CVODES User Guide.</tt><br>
<br>
<pre style="margin: 0em;">--Radu</pre><br>
<tt>karima djabella wrote:
</tt><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><tt>Hello,<br>
 
I use cvodes of SundialsTB. I would like to use the sensitivity 
analysis capabilities (forward and adjoint)  to my nonlinear system 
consisting of 8 state variables and 60 parametrers . In the example 
cvfdx.m ( CVODES forward sensitivity example) i found a problem when i 
run it, the error message is:<br>
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%<br>
??? Error using ==&gt; reshape<br>
To RESHAPE the number of elements must not change.</tt><br>
<br>
<pre style="margin: 0em;">Error in ==&gt; cvm_monitor at 8
yS = reshape(yS,N,Ns);</pre><br>
<pre style="margin: 0em;">Error in ==&gt; CVode at 62
  [status,t,y,v1] = cvm(mode,tout,itask);</pre><br>
<pre style="margin: 0em;">Error in ==&gt; cvfdx at 93
  [status, t, y, yS] = CVode(tout,'Normal');</pre><br>
<pre style="margin: 0em;">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</pre><br>
<pre style="margin: 0em;">could you help me to overcome this error?</pre><br>
<tt>Also, you put on the options, of the case 2 (commented part), the 
following one: 'ParamField', 'p'. is this meant that you choose all 
the parameters for the sensitivity study?. In my problem, i have 60 
parameters and i would like to study the sensitivity of a few number 
of parameters not the all. How can i change the program in order to 
choose only some parameters?</tt><br>
<br>
<tt>could you explain me the method of approximation used in the case 2 
for the sensitivity problem?</tt><br>
<br>
<pre style="margin: 0em;">Greetings.</pre><br>
</blockquote><br>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<div class="container">
<table width="95%" frame="below"><tr><td></td></table>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00800" href="msg00800.html">[sundials-users] SundialsTB::Cvodes::cvfdx.m</a></strong>
<ul><li><em>From:</em> &quot;karima djabella&quot; &lt;karima.djabella@gmail.com&gt;</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00801.html">Re: [sundials-users] SundialsTB::Cvodes::cvfdx.m</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00803.html">Re: [sundials-users] SundialsTB::Cvodes::cvfdx.m</a></strong>
</li>

<li>Previous by thread:
<strong><a href="msg00808.html">Re: [sundials-users] SundialsTB::Cvodes::cvfdx.m</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00809.html">[sundials-users] Stiff ODE solution is slow?</a></strong>
</li>

<li>Index(es):
<ul>
<li><a href="maillist.html#00802">
<strong>Main</strong></a></li>
<li><a href="threads.html#00802">
<strong>Thread</strong></a></li>
</ul>
</li>
</ul>
</div>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<!-- End content for this page -->
  </div>
  </td>
  <td background="../../graphics/table_bck3.gif"></td>
  </tr>
  <tr valign="top">
  <td height="17" background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  <td width="116"><a HREF="http://www.llnl.gov/disclaimer.html" target="_top"><img SRC="../../graphics/line_bl.gif" height="17" width="116" border="0"></a></td>
  <td width="720"><img SRC="../../graphics/line_br.gif" height="17" width="720" border="0"></td>
  <td background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  </tr>
  </table>
</body>
</html>
