<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: [sundials&#45;users] performance for chemical kinetic problems -->
<!--X-From-R13: Oyna Vvaqznefu <nynauNyyay.tbi> -->
<!--X-Date: Wed, 06 Sep 2006 12:06:02 &#45;0700 -->
<!--X-Message-Id: Pine.LNX.4.58.0609061201150.19866@tux64.llnl.gov -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: DIIE.00000AAA000224D0@mail.micodat.de -->
<!--X-Head-End-->
<html>
<head>
<title>Re: [sundials-users] performance for chemical kinetic problems</title>
<meta name="author" content="Radu Serban">
<meta name="description" content="suite of nonlinear differential algebraic equation solvers">
<meta name="keywords" content="SUNDIALS, CVODE, CVODES, IDA, KINSOL">
<meta name="keywords" content="ODE, DAE, sensitivity">
<meta name="keywords" content="differential, algebraic">
<link REL="SHORTCUT ICON" HREF="img/favicon.ico" type="image/x-icon">
<link REL="ICON" HREF="img/favicon.ico" type="image/x-icon">
<link href="../../sundials_styles.css" rel="stylesheet" type="text/css">
<script language="JavaScript">
<!--
homeon = new Image();           homeon.src = "../../graphics/home_buttonH.png";
homeoff = new Image();          homeoff.src = "../../graphics/home_button.png";
descriptionon = new Image();    descriptionon.src = "../../graphics/description_buttonH.png";
descriptionoff = new Image();   descriptionoff.src = "../../graphics/description_button.png";
documentationon = new Image();  documentationon.src = "../../graphics/documentation_buttonH.png";
documentationoff = new Image(); documentationoff.src = "../../graphics/documentation_button.png";
downloadon = new Image();       downloadon.src = "../../graphics/download_buttonH.png";
downloadoff = new Image();      downloadoff.src = "../../graphics/download_button.png";
supporton = new Image();        supporton.src = "../../graphics/support_buttonH.png";
supportoff = new Image();       supportoff.src = "../../graphics/support_button.png";
//-->
</script>
<script src="../../sunjs.js" type="text/javascript" language="javascript1.2"></script>
</head>
<!-- ******************************************************************************** -->
<body>
<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
  <td height="60" background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  <td width="116"><img SRC="../../graphics/head_top_left.png" height="60" width="116" border="0"></td>
  <td width="720"><img SRC="../../graphics/head_mail_top_right.png" height="60" width="720" border="0"></td>
  <td background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  </tr>
  <tr valign="top">
  <td height="127" background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  <td width="116">
    <a href="../../main.html" onMouseOver="img_act('home'); return true;" onMouseOut="img_inact('home'); return true;"><img src="../../graphics/home_button.png" border="0" name="home"></a><br>
    <a href="../../description/description.html" onMouseOver="img_act('description'); return true;" onMouseOut="img_inact('description'); return true;"><img src="../../graphics/description_button.png" border="0" name="description"></a><br>
    <a href="../../documentation/documentation.html" onMouseOver="img_act('documentation'); return true;" onMouseOut="img_inact('documentation'); return true;"><img src="../../graphics/documentation_button.png" border="0" name="documentation"></a><br>
    <a href="../../download/download.html" onMouseOver="img_act('download'); return true;" onMouseOut="img_inact('download'); return true;"><img src="../../graphics/download_button.png" border="0" name="download"></a><br>
    <a href="../../support/support.html" onMouseOver="img_act('support'); return true;" onMouseOut="img_inact('support'); return true;"><img src="../../graphics/support_button.png" border="0" name="support"></a><br>
    <img SRC="../../graphics/line_tl.gif" height="7" width="116" border="0"></td>
  <td width="720">
      <img SRC="../../graphics/head_bottom_right.png" height="120" width="720" border="0"><br>
      <img SRC="../../graphics/line_tr.gif" height="7" width="720" border="0"></td>
  <td background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  </tr>
  <tr valign="top">
  <td background="../../graphics/table_bck3.gif"></td>
  <td width="116" valign="bottom" align="center" background="../../graphics/table_bck5.gif"><img SRC="../../graphics/logo.png" border="0"></td>
  <td width="720" bgcolor="#ffffff">
  <div id="content">   
<!-- Start content for this page -->
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<p class="links">
[<a href="msg00649.html">Date Prev</a>] [<a href="msg00651.html">Date Next</a>] [<a href="msg00649.html">Thread Prev</a>] [<a href="msg00651.html">Thread Next</a>]<br>
[<b><a href="maillist.html#00650">Date Index</a></b>]
[<b><a href="threads.html#00650">Thread Index</a></b>]
</p>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [sundials-users] performance for chemical kinetic problems</h1>
<div class="frame">
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<table border=0 cellpadding=2 cellspacing=0>
<tr>
<td align="right"><b>
<em>From</em></b></td>
<td align="left">
Alan Hindmarsh &lt;<a href="mailto:alanh%40llnl.gov">alanh@llnl.gov</a>&gt;</td>
</tr>

<tr>
<td align="right"><b>
<em>Date</em></b></td>
<td align="left">
Wed, 06 Sep 2006 12:01:37 -0700 (PDT)</td>
</tr>

</table>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div>
<div class="container">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>
Hello Stefan,

I have several thoughts in answer to your questions.

1. The fact that the order drops to 2 is not (by itself) a reason for
any concern.  Typically, the order varies from 1 to some higher value,
and then settles down to 2 or 1 as the solution becomes smoother.

2. We have also solved very large reaction-diffusion systems with both
VODPK and CVODE.  The stiffness is well taken care of by the choice of
BDF methods.  The crucial factor in getting success is having a good
preconditioner.  Very often it is sufficient to use a preconditioner
based only on the reaction kinetics Jacobian contributions (ignoring
spatial coupling).  You can read about this and other choice we have
used in the literature associated with those solvers.

3. Generally, we do not recommend normalizing the dependent values.
The solvers should be able to handle the problem without normalization.
There is no particular advantage to normalization in the numerical
methods, and it introduces extra work.

4. Switching from VODPK to CVODE will not change performance, as long
as the usage is the same.  The functionality is essentially the same
for the two solvers (for the choice of preconditioned GMRES as linear
solver).  With a switch to CVODE, you have the option of trying two
other Krylov methods (TFQMR and BiCGStab), but I really doubt that
either will perform significantly (if any) better than GMRES.

5. Using CVODE does give you the opportunity to run on a parallel
machine, if you have access to one.  The natural choice is to put a
subgrid of values on each processor.  Here the main difficulty
(besides parallelizing your RHS function evaluation) is generating and
solving the preconditioner in parallel.  In the case of a
kinetics-only preconditioner, this is trivial.  But with one that
involves spatial coupling, there will a loss of effectiveness in going
from serial to parallel.

I hope this helps.

-Alan H.



On Tue, 5 Sep 2006, Stefan Kerkemeier wrote:

&gt;<i> Hi Guys,</i>
&gt;<i></i>
&gt;<i> I was wondering if you could push me into the right direction for the </i>
&gt;<i> following problem.</i>
&gt;<i></i>
&gt;<i> I have to solve big (10000 eqns) extremely stiff (reaction-diffusion </i>
&gt;<i> equations) ODE problems and I was using VODPK (version from 2002 with GMRES) </i>
&gt;<i> in the past. I normalise my values to order 1 but perhaps there are other </i>
&gt;<i> useful normalisation and preconditioners? During the calculation the oder </i>
&gt;<i> drops down to 2 which is not very nice.</i>
&gt;<i></i>
&gt;<i> Has someone experience with such problems in terms of performance. I have </i>
&gt;<i> considered to switch to CVODE, is there a possible performance advantage? </i>
&gt;<i> Additional I have looked up for the parallel version for CVODE but other </i>
&gt;<i> publications with similar problems observed a very bad speedup.</i>
&gt;<i></i>
&gt;<i></i>
&gt;<i> Cheers,</i>
&gt;<i> Stefan</i>
&gt;<i></i>

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<div class="container">
<table width="95%" frame="below"><tr><td></td></table>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00649" href="msg00649.html">[sundials-users] performance for chemical kinetic problems</a></strong>
<ul><li><em>From:</em> &quot;Stefan Kerkemeier&quot; &lt;stefanke@micodat.com&gt;</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00649.html">[sundials-users] performance for chemical kinetic problems</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00651.html">[sundials-users] Performance of CVODE similar to Matlab ode. How to improve?</a></strong>
</li>

<li>Previous by thread:
<strong><a href="msg00649.html">[sundials-users] performance for chemical kinetic problems</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00651.html">[sundials-users] Performance of CVODE similar to Matlab ode. How to improve?</a></strong>
</li>

<li>Index(es):
<ul>
<li><a href="maillist.html#00650">
<strong>Main</strong></a></li>
<li><a href="threads.html#00650">
<strong>Thread</strong></a></li>
</ul>
</li>
</ul>
</div>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<!-- End content for this page -->
  </div>
  </td>
  <td background="../../graphics/table_bck3.gif"></td>
  </tr>
  <tr valign="top">
  <td height="17" background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  <td width="116"><a HREF="http://www.llnl.gov/disclaimer.html" target="_top"><img SRC="../../graphics/line_bl.gif" height="17" width="116" border="0"></a></td>
  <td width="720"><img SRC="../../graphics/line_br.gif" height="17" width="720" border="0"></td>
  <td background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  </tr>
  </table>
</body>
</html>
