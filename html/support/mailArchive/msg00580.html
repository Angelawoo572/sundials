<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: [sundials&#45;users] Problem with IDA -->
<!--X-From-R13: Dnqh Ereona <enqhNyyay.tbi> -->
<!--X-Date: Mon, 17 Jul 2006 16:47:34 &#45;0700 -->
<!--X-Message-Id: 44BC202F.6070904@llnl.gov -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 000301c6a9f7$6dcdd4e0$ae13cd80@eng.buffalo.edu -->
<!--X-Head-End-->
<html>
<head>
<title>Re: [sundials-users] Problem with IDA</title>
<meta name="author" content="Radu Serban">
<meta name="description" content="suite of nonlinear differential algebraic equation solvers">
<meta name="keywords" content="SUNDIALS, CVODE, CVODES, IDA, KINSOL">
<meta name="keywords" content="ODE, DAE, sensitivity">
<meta name="keywords" content="differential, algebraic">
<link REL="SHORTCUT ICON" HREF="img/favicon.ico" type="image/x-icon">
<link REL="ICON" HREF="img/favicon.ico" type="image/x-icon">
<link href="../../sundials_styles.css" rel="stylesheet" type="text/css">
<script language="JavaScript">
<!--
homeon = new Image();           homeon.src = "../../graphics/home_buttonH.png";
homeoff = new Image();          homeoff.src = "../../graphics/home_button.png";
descriptionon = new Image();    descriptionon.src = "../../graphics/description_buttonH.png";
descriptionoff = new Image();   descriptionoff.src = "../../graphics/description_button.png";
documentationon = new Image();  documentationon.src = "../../graphics/documentation_buttonH.png";
documentationoff = new Image(); documentationoff.src = "../../graphics/documentation_button.png";
downloadon = new Image();       downloadon.src = "../../graphics/download_buttonH.png";
downloadoff = new Image();      downloadoff.src = "../../graphics/download_button.png";
supporton = new Image();        supporton.src = "../../graphics/support_buttonH.png";
supportoff = new Image();       supportoff.src = "../../graphics/support_button.png";
//-->
</script>
<script src="../../sunjs.js" type="text/javascript" language="javascript1.2"></script>
</head>
<!-- ******************************************************************************** -->
<body>
<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
  <td height="60" background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  <td width="116"><img SRC="../../graphics/head_top_left.png" height="60" width="116" border="0"></td>
  <td width="720"><img SRC="../../graphics/head_mail_top_right.png" height="60" width="720" border="0"></td>
  <td background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  </tr>
  <tr valign="top">
  <td height="127" background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  <td width="116">
    <a href="../../main.html" onMouseOver="img_act('home'); return true;" onMouseOut="img_inact('home'); return true;"><img src="../../graphics/home_button.png" border="0" name="home"></a><br>
    <a href="../../description/description.html" onMouseOver="img_act('description'); return true;" onMouseOut="img_inact('description'); return true;"><img src="../../graphics/description_button.png" border="0" name="description"></a><br>
    <a href="../../documentation/documentation.html" onMouseOver="img_act('documentation'); return true;" onMouseOut="img_inact('documentation'); return true;"><img src="../../graphics/documentation_button.png" border="0" name="documentation"></a><br>
    <a href="../../download/download.html" onMouseOver="img_act('download'); return true;" onMouseOut="img_inact('download'); return true;"><img src="../../graphics/download_button.png" border="0" name="download"></a><br>
    <a href="../../support/support.html" onMouseOver="img_act('support'); return true;" onMouseOut="img_inact('support'); return true;"><img src="../../graphics/support_button.png" border="0" name="support"></a><br>
    <img SRC="../../graphics/line_tl.gif" height="7" width="116" border="0"></td>
  <td width="720">
      <img SRC="../../graphics/head_bottom_right.png" height="120" width="720" border="0"><br>
      <img SRC="../../graphics/line_tr.gif" height="7" width="720" border="0"></td>
  <td background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  </tr>
  <tr valign="top">
  <td background="../../graphics/table_bck3.gif"></td>
  <td width="116" valign="bottom" align="center" background="../../graphics/table_bck5.gif"><img SRC="../../graphics/logo.png" border="0"></td>
  <td width="720" bgcolor="#ffffff">
  <div id="content">   
<!-- Start content for this page -->
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<p class="links">
[<a href="msg00579.html">Date Prev</a>] [<a href="msg00581.html">Date Next</a>] [<a href="msg00579.html">Thread Prev</a>] [<a href="msg00581.html">Thread Next</a>]<br>
[<b><a href="maillist.html#00580">Date Index</a></b>]
[<b><a href="threads.html#00580">Thread Index</a></b>]
</p>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [sundials-users] Problem with IDA</h1>
<div class="frame">
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<table border=0 cellpadding=2 cellspacing=0>
<tr>
<td align="right"><b>
<em>From</em></b></td>
<td align="left">
Radu Serban &lt;<a href="mailto:radu%40llnl.gov">radu@llnl.gov</a>&gt;</td>
</tr>

<tr>
<td align="right"><b>
<em>Date</em></b></td>
<td align="left">
Mon, 17 Jul 2006 16:41:35 -0700</td>
</tr>

</table>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div>
<div class="container">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Maca,</pre><br>
Hmmm, you're right. I was looking at he development version. In the current distribution, those two variables are not initialized (I must 
have added this sometime since the last release). The solution is, indeed, to add<br>
  err_k = ZERO;<br>
  err_km1 = ZERO;<br>
right before the loop in IDAStep (but NOT before IDAHandleNFlag as this would lead to wrong results in the case in which the nonlinear 
solver is successful but the error test fails!)<br>
<br>
<pre style="margin: 0em;">--Radu</pre><br>
<br>Maca wrote:
<blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">Radu,</pre><br>
<pre style="margin: 0em;">I know it is a problem with the variable not being initialized since I get
the following exception when running my program with a debugger:</pre><br>
<pre style="margin: 0em;">&quot;Run-Time Check Failure #3 - The variable 'err_k' is being used without
being defined. &quot;</pre><br>
<pre style="margin: 0em;">And the exception points to the IDAHandleNFlag function call. If I set both
err_k and err_km1 to 0 before this function is called, I do not get the
exception. So this may be an issue with the compiler I am using (Microsoft
Visual C 2005).</pre><br>
<pre style="margin: 0em;">Thanks,
Maca</pre><br>
<pre style="margin: 0em;">-----Original Message-----
From: owner-sundials-users@lists.llnl.gov
[<a  href="mailto:owner-sundials-users@lists.llnl.gov">mailto:owner-sundials-users@lists.llnl.gov</a>] On Behalf Of Radu Serban
Sent: Monday, July 17, 2006 5:57 PM
To: sundials-users@llnl.gov
Subject: Re: [sundials-users] Problem with IDA</pre><br>
<pre style="margin: 0em;">Macarena:</pre><br>
<pre style="margin: 0em;">If the nonlinear solver fails, there is no sense to perform the error test.
If nflag is not IDA_SUCCESS after IDAnls, then this fact is recognized in
IDAHandleNFLag which, in this case, does not require err_k or err_km1. In
any case, both err_k and err_km1 are set to default values 0.0 when entering
IDAStep (only to prevent compiler warnings!), so I doubt that the reason for
which your code crashes is the one you stated.</pre><br>
<pre style="margin: 0em;">The modification you've made to the code is incorrect. Undo it and look for
other problems in your code.</pre><br>
<pre style="margin: 0em;">--Radu</pre><br>
Maca wrote:
<blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em">Dear All<br>
I am attempting to solve a structure in the state space using IDA.<br>
Everything went fine until the program suddenly crashed. I found out 
that at some point in the iterations the function IDAStep is called 
but the nflag from the function IDANls is not IDA_SUCCESS so the 
program doesn't call the function IDATestError, therefore the variable 
err_k is not defined and when trying to call IDAHandleNFlag, it crashes
</blockquote>because err_k is not defined.
<blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em">As a &quot;solution&quot; I uncommented the if test before the call to 
IDATestError so the variable would be defined at all times.<br>
I still have to do some more checking on my results but they seem very 
reasonable.<br>
 
 I am not very familiar with the variables used along the program and 
not too familiar with all the mathematical procedures either so there 
probably is a better way to solve this problem so if you can help me 
with some hints, I will be grateful.<br>
 
Thanks,<br>
Macarena Schachter.<br>
 
PhD Candidate<br>
Department of Civil, Structural and Environmental Engineering.<br>
University at Buffalo.<br>
 <br>
<br>
</blockquote><pre style="margin: 0em;"><br></pre><br>
</blockquote><pre style="margin: 0em;"><br></pre><br>
<pre style="margin: 0em;">--
   Radu Serban
   Center for Applied Scientific Computing   [email] radu@llnl.gov
   Lawrence Livermore National Laboratory    [phone] 925-424-4852
   P.O. Box 808, L-560                       [fax]   925-422-6287
   Livermore, CA 94551</pre><br>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<div class="container">
<table width="95%" frame="below"><tr><td></td></table>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00579" href="msg00579.html">RE: [sundials-users] Problem with IDA</a></strong>
<ul><li><em>From:</em> &quot;Maca&quot; &lt;mfs26@buffalo.edu&gt;</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00579.html">RE: [sundials-users] Problem with IDA</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00581.html">Re: [sundials-users] Problem with IDA</a></strong>
</li>

<li>Previous by thread:
<strong><a href="msg00579.html">RE: [sundials-users] Problem with IDA</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00581.html">Re: [sundials-users] Problem with IDA</a></strong>
</li>

<li>Index(es):
<ul>
<li><a href="maillist.html#00580">
<strong>Main</strong></a></li>
<li><a href="threads.html#00580">
<strong>Thread</strong></a></li>
</ul>
</li>
</ul>
</div>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<!-- End content for this page -->
  </div>
  </td>
  <td background="../../graphics/table_bck3.gif"></td>
  </tr>
  <tr valign="top">
  <td height="17" background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  <td width="116"><a HREF="http://www.llnl.gov/disclaimer.html" target="_top"><img SRC="../../graphics/line_bl.gif" height="17" width="116" border="0"></a></td>
  <td width="720"><img SRC="../../graphics/line_br.gif" height="17" width="720" border="0"></td>
  <td background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  </tr>
  </table>
</body>
</html>
