<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: Slow performance when solution is not changing -->
<!--X-From-R13: Oaqernf @vpbynv <Oaqernf.@vpbynvNtzk.arg> -->
<!--X-Date: Mon, 16 May 2005 16:53:01 &#45;0700 (PDT) -->
<!--X-Message-Id: opsqv69e0rt8lo91@smtp.kuleuven.ac.be -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: opsquiwflzt8lo91@smtp.kuleuven.ac.be -->
<!--X-Reference: Pine.LNX.4.58.0505161544560.27111@tux64.llnl.gov -->
<!--X-Head-End-->
<html>
<head>
<title>Re: Slow performance when solution is not changing</title>
<meta name="author" content="Radu Serban">
<meta name="description" content="suite of nonlinear differential algebraic equation solvers">
<meta name="keywords" content="SUNDIALS, CVODE, CVODES, IDA, KINSOL">
<meta name="keywords" content="ODE, DAE, sensitivity">
<meta name="keywords" content="differential, algebraic">
<link REL="SHORTCUT ICON" HREF="img/favicon.ico" type="image/x-icon">
<link REL="ICON" HREF="img/favicon.ico" type="image/x-icon">
<link href="../../sundials_styles.css" rel="stylesheet" type="text/css">
<script language="JavaScript">
<!--
homeon = new Image();           homeon.src = "../../graphics/home_buttonH.png";
homeoff = new Image();          homeoff.src = "../../graphics/home_button.png";
descriptionon = new Image();    descriptionon.src = "../../graphics/description_buttonH.png";
descriptionoff = new Image();   descriptionoff.src = "../../graphics/description_button.png";
documentationon = new Image();  documentationon.src = "../../graphics/documentation_buttonH.png";
documentationoff = new Image(); documentationoff.src = "../../graphics/documentation_button.png";
downloadon = new Image();       downloadon.src = "../../graphics/download_buttonH.png";
downloadoff = new Image();      downloadoff.src = "../../graphics/download_button.png";
supporton = new Image();        supporton.src = "../../graphics/support_buttonH.png";
supportoff = new Image();       supportoff.src = "../../graphics/support_button.png";
//-->
</script>
<script src="../../sunjs.js" type="text/javascript" language="javascript1.2"></script>
</head>
<!-- ******************************************************************************** -->
<body>
<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
  <td height="60" background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  <td width="116"><img SRC="../../graphics/head_top_left.png" height="60" width="116" border="0"></td>
  <td width="720"><img SRC="../../graphics/head_mail_top_right.png" height="60" width="720" border="0"></td>
  <td background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  </tr>
  <tr valign="top">
  <td height="127" background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  <td width="116">
    <a href="../../main.html" onMouseOver="img_act('home'); return true;" onMouseOut="img_inact('home'); return true;"><img src="../../graphics/home_button.png" border="0" name="home"></a><br>
    <a href="../../description/description.html" onMouseOver="img_act('description'); return true;" onMouseOut="img_inact('description'); return true;"><img src="../../graphics/description_button.png" border="0" name="description"></a><br>
    <a href="../../documentation/documentation.html" onMouseOver="img_act('documentation'); return true;" onMouseOut="img_inact('documentation'); return true;"><img src="../../graphics/documentation_button.png" border="0" name="documentation"></a><br>
    <a href="../../download/download.html" onMouseOver="img_act('download'); return true;" onMouseOut="img_inact('download'); return true;"><img src="../../graphics/download_button.png" border="0" name="download"></a><br>
    <a href="../../support/support.html" onMouseOver="img_act('support'); return true;" onMouseOut="img_inact('support'); return true;"><img src="../../graphics/support_button.png" border="0" name="support"></a><br>
    <img SRC="../../graphics/line_tl.gif" height="7" width="116" border="0"></td>
  <td width="720">
      <img SRC="../../graphics/head_bottom_right.png" height="120" width="720" border="0"><br>
      <img SRC="../../graphics/line_tr.gif" height="7" width="720" border="0"></td>
  <td background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  </tr>
  <tr valign="top">
  <td background="../../graphics/table_bck3.gif"></td>
  <td width="116" valign="bottom" align="center" background="../../graphics/table_bck5.gif"><img SRC="../../graphics/logo.png" border="0"></td>
  <td width="720" bgcolor="#ffffff">
  <div id="content">   
<!-- Start content for this page -->
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<p class="links">
[<a href="msg00052.html">Date Prev</a>] [<a href="msg00054.html">Date Next</a>] [<a href="msg00051.html">Thread Prev</a>] [<a href="msg00062.html">Thread Next</a>]<br>
[<b><a href="maillist.html#00053">Date Index</a></b>]
[<b><a href="threads.html#00053">Thread Index</a></b>]
</p>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: Slow performance when solution is not changing</h1>
<div class="frame">
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<table border=0 cellpadding=2 cellspacing=0>
<tr>
<td align="right"><b>
<em>From</em></b></td>
<td align="left">
Andreas Nicolai &lt;<a href="mailto:Andreas.Nicolai%40gmx.net">Andreas.Nicolai@gmx.net</a>&gt;</td>
</tr>

<tr>
<td align="right"><b>
<em>Date</em></b></td>
<td align="left">
Mon, 16 May 2005 19:52:16 -0400</td>
</tr>

</table>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div>
<div class="container">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Hi again,</pre><br>
<blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">Probably the most common reason for the unexpected slowdown of an ODE
solution is the introduction of stiffness into the system while using
a nonstiff method (or using the wrong stiff method). What are your
method options (lmm, iter)?
</pre></blockquote><pre style="margin: 0em;">I'm using BDF, NEWTON.</pre><br>
<blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">Is it possible that the added 3rd
equation has some stiffness that is not being properly treated?
</pre></blockquote><pre style="margin: 0em;">Yes. That may be the case, since this is the only balance equation with very 
large transport coefficients resulting in large convective fluxes of the other 
quantities. Testing the solver further I found the following dependencies:
- problem only persists in 2D cases
- speed is increasing if transport coefficients are decreased (thus slowing 
down all convective and coupled processes)
- loosening the tolerances a lot (especially relative tolerance) helps 
increasing speed but makes the solution instable at times (large 
over/undershoot in my region of calculation)</pre><br>
<blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">Another possibility is a low-amplitude high-frequency oscillation that
was introduced with the 3rd equation.  Unless the tolerances are
loosened alot, the solver could be following this oscillation, and yet
it may be largely invisible to you in the solution.
</pre></blockquote><pre style="margin: 0em;">This is what I suspect, since the problem really only appears in 2D 
simulations. By looking at the progress of the solver during the iteration and 
the individual state variables I find that the values are all only marginally 
changing. A small change in the state variable of my 2nd equation results in 
huge fluxes of the 3rd which again have effects in not just the next few but 
quite a lot neighboring elements.</pre><br>
<pre style="margin: 0em;">So far only decoupling the system has helped speeding up the solution a bit.
Related to that, I have a question (see next post).</pre><br>
<pre style="margin: 0em;">But thanks for the suggestion with the Jacobian. Since it is so readily 
calculated by CVODE I will try to make sense of the Eigenvalues.</pre><br>
<pre style="margin: 0em;">Andreas</pre><br>
<pre style="margin: 0em;">--
Andreas Nicolai                   Andreas.Nicolai@gmx.net
Syracuse University               +01 (315) 443 1099
151 E.A.Link Hall
Syracuse NY 13244-1240</pre><br>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<div class="container">
<table width="95%" frame="below"><tr><td></td></table>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00062" href="msg00062.html">Re: Slow performance when solution is not changing</a></strong>
<ul><li><em>From:</em> Alan Hindmarsh &lt;alanh@llnl.gov&gt;</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00050" href="msg00050.html">Slow performance when solution is not changing</a></strong>
<ul><li><em>From:</em> Andreas Nicolai &lt;Andreas.Nicolai@gmx.net&gt;</li></ul></li>
<li><strong><a name="00051" href="msg00051.html">Re: Slow performance when solution is not changing</a></strong>
<ul><li><em>From:</em> Alan Hindmarsh &lt;alanh@llnl.gov&gt;</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00052.html">Re: CVODE</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00054.html">RE: CVODE</a></strong>
</li>

<li>Previous by thread:
<strong><a href="msg00051.html">Re: Slow performance when solution is not changing</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00062.html">Re: Slow performance when solution is not changing</a></strong>
</li>

<li>Index(es):
<ul>
<li><a href="maillist.html#00053">
<strong>Main</strong></a></li>
<li><a href="threads.html#00053">
<strong>Thread</strong></a></li>
</ul>
</li>
</ul>
</div>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<!-- End content for this page -->
  </div>
  </td>
  <td background="../../graphics/table_bck3.gif"></td>
  </tr>
  <tr valign="top">
  <td height="17" background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  <td width="116"><a HREF="http://www.llnl.gov/disclaimer.html" target="_top"><img SRC="../../graphics/line_bl.gif" height="17" width="116" border="0"></a></td>
  <td width="720"><img SRC="../../graphics/line_br.gif" height="17" width="720" border="0"></td>
  <td background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  </tr>
  </table>
</body>
</html>
