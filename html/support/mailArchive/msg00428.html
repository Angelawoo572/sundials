<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: [sundials&#45;users] Arbitrary precision for sundials solvers? -->
<!--X-From-R13: Dnqh Ereona <freona1Nyyay.tbi> -->
<!--X-Date: Tue, 11 Apr 2006 10:58:22 &#45;0700 (PDT) -->
<!--X-Message-Id: 443BEDD9.4060103@llnl.gov -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 44365283.5060103@Uni&#45;Koeln.De -->
<!--X-Reference: E8F5ABE6&#45;8209&#45;4D54&#45;A73D&#45;0051AAB88E30@mcmaster.ca -->
<!--X-Reference: 443BD601.8050405@Uni&#45;Koeln.De -->
<!--X-Head-End-->
<html>
<head>
<title>Re: [sundials-users] Arbitrary precision for sundials solvers?</title>
<meta name="author" content="Radu Serban">
<meta name="description" content="suite of nonlinear differential algebraic equation solvers">
<meta name="keywords" content="SUNDIALS, CVODE, CVODES, IDA, KINSOL">
<meta name="keywords" content="ODE, DAE, sensitivity">
<meta name="keywords" content="differential, algebraic">
<link REL="SHORTCUT ICON" HREF="img/favicon.ico" type="image/x-icon">
<link REL="ICON" HREF="img/favicon.ico" type="image/x-icon">
<link href="../../sundials_styles.css" rel="stylesheet" type="text/css">
<script language="JavaScript">
<!--
homeon = new Image();           homeon.src = "../../graphics/home_buttonH.png";
homeoff = new Image();          homeoff.src = "../../graphics/home_button.png";
descriptionon = new Image();    descriptionon.src = "../../graphics/description_buttonH.png";
descriptionoff = new Image();   descriptionoff.src = "../../graphics/description_button.png";
documentationon = new Image();  documentationon.src = "../../graphics/documentation_buttonH.png";
documentationoff = new Image(); documentationoff.src = "../../graphics/documentation_button.png";
downloadon = new Image();       downloadon.src = "../../graphics/download_buttonH.png";
downloadoff = new Image();      downloadoff.src = "../../graphics/download_button.png";
supporton = new Image();        supporton.src = "../../graphics/support_buttonH.png";
supportoff = new Image();       supportoff.src = "../../graphics/support_button.png";
//-->
</script>
<script src="../../sunjs.js" type="text/javascript" language="javascript1.2"></script>
</head>
<!-- ******************************************************************************** -->
<body>
<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
  <td height="60" background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  <td width="116"><img SRC="../../graphics/head_top_left.png" height="60" width="116" border="0"></td>
  <td width="720"><img SRC="../../graphics/head_mail_top_right.png" height="60" width="720" border="0"></td>
  <td background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  </tr>
  <tr valign="top">
  <td height="127" background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  <td width="116">
    <a href="../../main.html" onMouseOver="img_act('home'); return true;" onMouseOut="img_inact('home'); return true;"><img src="../../graphics/home_button.png" border="0" name="home"></a><br>
    <a href="../../description/description.html" onMouseOver="img_act('description'); return true;" onMouseOut="img_inact('description'); return true;"><img src="../../graphics/description_button.png" border="0" name="description"></a><br>
    <a href="../../documentation/documentation.html" onMouseOver="img_act('documentation'); return true;" onMouseOut="img_inact('documentation'); return true;"><img src="../../graphics/documentation_button.png" border="0" name="documentation"></a><br>
    <a href="../../download/download.html" onMouseOver="img_act('download'); return true;" onMouseOut="img_inact('download'); return true;"><img src="../../graphics/download_button.png" border="0" name="download"></a><br>
    <a href="../../support/support.html" onMouseOver="img_act('support'); return true;" onMouseOut="img_inact('support'); return true;"><img src="../../graphics/support_button.png" border="0" name="support"></a><br>
    <img SRC="../../graphics/line_tl.gif" height="7" width="116" border="0"></td>
  <td width="720">
      <img SRC="../../graphics/head_bottom_right.png" height="120" width="720" border="0"><br>
      <img SRC="../../graphics/line_tr.gif" height="7" width="720" border="0"></td>
  <td background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  </tr>
  <tr valign="top">
  <td background="../../graphics/table_bck3.gif"></td>
  <td width="116" valign="bottom" align="center" background="../../graphics/table_bck5.gif"><img SRC="../../graphics/logo.png" border="0"></td>
  <td width="720" bgcolor="#ffffff">
  <div id="content">   
<!-- Start content for this page -->
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<p class="links">
[<a href="msg00427.html">Date Prev</a>] [<a href="msg00429.html">Date Next</a>] [<a href="msg00426.html">Thread Prev</a>] [<a href="msg00429.html">Thread Next</a>]<br>
[<b><a href="maillist.html#00428">Date Index</a></b>]
[<b><a href="threads.html#00428">Thread Index</a></b>]
</p>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [sundials-users] Arbitrary precision for sundials solvers?</h1>
<div class="frame">
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<table border=0 cellpadding=2 cellspacing=0>
<tr>
<td align="right"><b>
<em>From</em></b></td>
<td align="left">
Radu Serban &lt;<a href="mailto:serban1%40llnl.gov">serban1@llnl.gov</a>&gt;</td>
</tr>

<tr>
<td align="right"><b>
<em>Date</em></b></td>
<td align="left">
Tue, 11 Apr 2006 10:56:41 -0700</td>
</tr>

</table>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div>
<div class="container">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Comments interspersed below...</pre><br>
Kai Hartmann wrote:
<blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">Ned Nedialkov schrieb:</pre><br>
<blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">On Apr 7, 2006, at 4:52 AM, Kai Hartmann wrote:</pre><br>
<br>
<blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">Hi all,</pre><br>
<pre style="margin: 0em;">I'm currently testing the cvode solver on a specific problem and it
seems that the extended precision is not sufficient.</pre><br>
<pre style="margin: 0em;">Do you provide an option or include an arbitrary precision arithmetic?
Does it make sense to do so when using an ODE solver (runtime and/or
other issues)?
</pre></blockquote><pre style="margin: 0em;"><br>
I think it makes sense if you can get the truncation error of high order, 
which is not the case with BDF and RK methods. If you need high-precision 
numerical solutions, and your problem is not large, I would consider Taylor 
series based methods, where order 30, for example, is not unusual.
</pre></blockquote></blockquote><br>Ned, the floating-point precision has nothing to do with the integration method. You confuse truncation and roundoff errors. You can get the 
errors down to whatever level you want with an adaptive BDF (or RK) solver by controlling the stepsize. Conversely, the tolerance with which 
you can solve using a Taylor series based method of any order will be limited by the floating-point precision.<br>
<br>
The question here is not whether it makes sense to use arbitrary precision when using an ODE solver, but rather if it makes sense for a 
given problem.<br>
<br>
<blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;"><br>Ned Nedialkov</pre><br>
</blockquote><pre style="margin: 0em;"><br></pre><br>
<pre style="margin: 0em;">Thanks for your thoughtful comments, Radu and Ned.</pre><br>
<pre style="margin: 0em;">I have a stiff problem with a wide range of orders of magnitudes in the
variables. The matrix is sparse. From what I read, I took that a BDF is
the favorable solution in this case.
</pre></blockquote><br>This alone does not suggest the need for more than extended precision (or even double precision). I trust you use different absolute 
tolerances for different solution components to deal with the different orders of magnitude.<br>
<br>
What exactly makes you think that you need more precision? How many significant digits are you after? What is an acceptable noise level 
(absolute tolerance)? Maybe you could tell us a bit about the actual physical problem you try to solve...<br>
<br>
<blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">I also tried to modify the source code and include an arbitrary
precision library (gmp), but have not been successful. My best guess is
that the difference between the built-in datatypes and a C++ class of
gmp that is used as a datatype (mpf_class) is the main problem.</pre><br>
Let's see if I can find a workaround for this,
</blockquote><pre style="margin: 0em;">
<br>Again, if I were you, before doing all this work, I'd think twice if it's needed or not.</pre><br>
<blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">Kai</pre><br>
</blockquote><pre style="margin: 0em;"><br>--Radu</pre><br>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<div class="container">
<table width="95%" frame="below"><tr><td></td></table>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00433" href="msg00433.html">Re: [sundials-users] Arbitrary precision for sundials solvers?</a></strong>
<ul><li><em>From:</em> Kai Hartmann &lt;Kai.Hartmann@uni-koeln.de&gt;</li></ul></li>
<li><strong><a name="00429" href="msg00429.html">Re: [sundials-users] Arbitrary precision for sundials solvers?</a></strong>
<ul><li><em>From:</em> Ned Nedialkov &lt;nedialk@univmail.cis.mcmaster.ca&gt;</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00417" href="msg00417.html">[sundials-users] Arbitrary precision for sundials solvers?</a></strong>
<ul><li><em>From:</em> Kai Hartmann &lt;Kai.Hartmann@uni-koeln.de&gt;</li></ul></li>
<li><strong><a name="00420" href="msg00420.html">Re: [sundials-users] Arbitrary precision for sundials solvers?</a></strong>
<ul><li><em>From:</em> Ned Nedialkov &lt;nedialk@mcmaster.ca&gt;</li></ul></li>
<li><strong><a name="00425" href="msg00425.html">Re: [sundials-users] Arbitrary precision for sundials solvers?</a></strong>
<ul><li><em>From:</em> Kai Hartmann &lt;Kai.Hartmann@uni-koeln.de&gt;</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00427.html">Re: [sundials-users] coordinate projection with CVODE</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00429.html">Re: [sundials-users] Arbitrary precision for sundials solvers?</a></strong>
</li>

<li>Previous by thread:
<strong><a href="msg00426.html">Re: [sundials-users] Arbitrary precision for sundials solvers?</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00429.html">Re: [sundials-users] Arbitrary precision for sundials solvers?</a></strong>
</li>

<li>Index(es):
<ul>
<li><a href="maillist.html#00428">
<strong>Main</strong></a></li>
<li><a href="threads.html#00428">
<strong>Thread</strong></a></li>
</ul>
</li>
</ul>
</div>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<!-- End content for this page -->
  </div>
  </td>
  <td background="../../graphics/table_bck3.gif"></td>
  </tr>
  <tr valign="top">
  <td height="17" background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  <td width="116"><a HREF="http://www.llnl.gov/disclaimer.html" target="_top"><img SRC="../../graphics/line_bl.gif" height="17" width="116" border="0"></a></td>
  <td width="720"><img SRC="../../graphics/line_br.gif" height="17" width="720" border="0"></td>
  <td background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  </tr>
  </table>
</body>
</html>
