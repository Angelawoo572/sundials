<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: Re&#45;4: [sundials&#45;users] performance for chemical kinetic problems -->
<!--X-From-R13: [vpunry Zrgmthf <zvpunry.yrgmthfNhav&#45;ovryrsryq.qr> -->
<!--X-Date: Thu, 28 Sep 2006 01:05:18 &#45;0700 -->
<!--X-Message-Id: 451B8125.7080508@uni&#45;bielefeld.de -->
<!--X-Content-Type: multipart/signed -->
<!--X-Reference: Pine.LNX.4.58.0609201521260.28545@tux64.llnl.gov -->
<!--X-Reference: 4511C60E.3000405@uni&#45;bielefeld.de -->
<!--X-Reference: Pine.LNX.4.58.0609271401190.16395@tux64.llnl.gov -->
<!--X-Reference: 451AF248.3060208@uni&#45;bielefeld.de -->
<!--X-Reference: Pine.LNX.4.58.0609271610271.16395@tux64.llnl.gov -->
<!--X-Derived: pgpgVFXgLWWNC.pgp -->
<!--X-Head-End-->
<html>
<head>
<title>Re: Re-4: [sundials-users] performance for chemical kinetic problems</title>
<meta name="author" content="Radu Serban">
<meta name="description" content="suite of nonlinear differential algebraic equation solvers">
<meta name="keywords" content="SUNDIALS, CVODE, CVODES, IDA, KINSOL">
<meta name="keywords" content="ODE, DAE, sensitivity">
<meta name="keywords" content="differential, algebraic">
<link REL="SHORTCUT ICON" HREF="img/favicon.ico" type="image/x-icon">
<link REL="ICON" HREF="img/favicon.ico" type="image/x-icon">
<link href="../../sundials_styles.css" rel="stylesheet" type="text/css">
<script language="JavaScript">
<!--
homeon = new Image();           homeon.src = "../../graphics/home_buttonH.png";
homeoff = new Image();          homeoff.src = "../../graphics/home_button.png";
descriptionon = new Image();    descriptionon.src = "../../graphics/description_buttonH.png";
descriptionoff = new Image();   descriptionoff.src = "../../graphics/description_button.png";
documentationon = new Image();  documentationon.src = "../../graphics/documentation_buttonH.png";
documentationoff = new Image(); documentationoff.src = "../../graphics/documentation_button.png";
downloadon = new Image();       downloadon.src = "../../graphics/download_buttonH.png";
downloadoff = new Image();      downloadoff.src = "../../graphics/download_button.png";
supporton = new Image();        supporton.src = "../../graphics/support_buttonH.png";
supportoff = new Image();       supportoff.src = "../../graphics/support_button.png";
//-->
</script>
<script src="../../sunjs.js" type="text/javascript" language="javascript1.2"></script>
</head>
<!-- ******************************************************************************** -->
<body>
<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
  <td height="60" background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  <td width="116"><img SRC="../../graphics/head_top_left.png" height="60" width="116" border="0"></td>
  <td width="720"><img SRC="../../graphics/head_mail_top_right.png" height="60" width="720" border="0"></td>
  <td background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  </tr>
  <tr valign="top">
  <td height="127" background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  <td width="116">
    <a href="../../main.html" onMouseOver="img_act('home'); return true;" onMouseOut="img_inact('home'); return true;"><img src="../../graphics/home_button.png" border="0" name="home"></a><br>
    <a href="../../description/description.html" onMouseOver="img_act('description'); return true;" onMouseOut="img_inact('description'); return true;"><img src="../../graphics/description_button.png" border="0" name="description"></a><br>
    <a href="../../documentation/documentation.html" onMouseOver="img_act('documentation'); return true;" onMouseOut="img_inact('documentation'); return true;"><img src="../../graphics/documentation_button.png" border="0" name="documentation"></a><br>
    <a href="../../download/download.html" onMouseOver="img_act('download'); return true;" onMouseOut="img_inact('download'); return true;"><img src="../../graphics/download_button.png" border="0" name="download"></a><br>
    <a href="../../support/support.html" onMouseOver="img_act('support'); return true;" onMouseOut="img_inact('support'); return true;"><img src="../../graphics/support_button.png" border="0" name="support"></a><br>
    <img SRC="../../graphics/line_tl.gif" height="7" width="116" border="0"></td>
  <td width="720">
      <img SRC="../../graphics/head_bottom_right.png" height="120" width="720" border="0"><br>
      <img SRC="../../graphics/line_tr.gif" height="7" width="720" border="0"></td>
  <td background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  </tr>
  <tr valign="top">
  <td background="../../graphics/table_bck3.gif"></td>
  <td width="116" valign="bottom" align="center" background="../../graphics/table_bck5.gif"><img SRC="../../graphics/logo.png" border="0"></td>
  <td width="720" bgcolor="#ffffff">
  <div id="content">   
<!-- Start content for this page -->
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<p class="links">
[<a href="msg00712.html">Date Prev</a>] [<a href="msg00714.html">Date Next</a>] [<a href="msg00712.html">Thread Prev</a>] [<a href="msg00700.html">Thread Next</a>]<br>
[<b><a href="maillist.html#00713">Date Index</a></b>]
[<b><a href="threads.html#00713">Thread Index</a></b>]
</p>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: Re-4: [sundials-users] performance for chemical kinetic problems</h1>
<div class="frame">
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<table border=0 cellpadding=2 cellspacing=0>
<tr>
<td align="right"><b>
<em>From</em></b></td>
<td align="left">
Michael Letzgus &lt;<a href="mailto:michael.letzgus%40uni-bielefeld.de">michael.letzgus@uni-bielefeld.de</a>&gt;</td>
</tr>

<tr>
<td align="right"><b>
<em>Date</em></b></td>
<td align="left">
Thu, 28 Sep 2006 10:00:37 +0200</td>
</tr>

</table>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div>
<div class="container">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>Hi Alan!


Alan Hindmarsh schrieb:

&gt;<i> Tell me if this right:  I gather that a pulse consists of a short</i>
&gt;<i> excitation interval, followed by a longer relaxation interval.  For</i>
&gt;<i> the short excitation interval of each pulse, you use the 4-step loop</i>
&gt;<i> to make CVODE hit each of a set of time points at which you have</i>
&gt;<i> stored values of a power profile. (You say &quot;tstop is the next</i>
&gt;<i> available sample of the pulse&quot;.)</i>

Full Ack, that's exactly my problem.


&gt;<i> Because both the start and end of the short excitation interval is a</i>
&gt;<i> major discontinuity in the RHS function of the ODE system, both of</i>
&gt;<i> those points should be restart points for CVODE (using calls to</i>
&gt;<i> CVodeReInit after the very first excitiation).</i>

OK, I see, so I have to split my problem into three different runs:
Before the pulse (with jacobian J1), during pulse (J2), and after (J1).
Another advantage of this scheme is the simplified preconditioning
because the excitation matrix elements can't be diagonalized together
with the other coefficients.

A completely different idea I had is to make the excitation pulse part
of the ODE.
I think it should be possible to find a RHS describing the pulse shape
(gaussian, lorentzian). Then, all rate coefficients may be constant in
time and the pulse itself is a part of the stiff system. Maybe I'll try
this approach later.



&gt;<i> I hope this clarifies things.</i>

Yes, thank you very much!

Best regards,
 Michael


-- 

Dipl. Chem. Michael Letzgus
Universit&#xE4;t Bielefeld
Physikalische Chemie I
Raum: F2-118 / E2-246
Tel: 0521-106-2190
Fax: 0521-106-6027


</pre><p><strong>Attachment:
<a href="pgpgVFXgLWWNC.pgp" >signature.asc</a></strong><br>
<em>Description:</em> OpenPGP digital signature</p>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<div class="container">
<table width="95%" frame="below"><tr><td></td></table>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00702" href="msg00702.html">Re: Re-4: [sundials-users] performance for chemical kinetic problems</a></strong>
<ul><li><em>From:</em> Alan Hindmarsh &lt;alanh@llnl.gov&gt;</li></ul></li>
<li><strong><a name="00703" href="msg00703.html">Re: Re-4: [sundials-users] performance for chemical kinetic problems</a></strong>
<ul><li><em>From:</em> Michael Letzgus &lt;michael.letzgus@uni-bielefeld.de&gt;</li></ul></li>
<li><strong><a name="00709" href="msg00709.html">Re: Re-4: [sundials-users] performance for chemical kinetic problems</a></strong>
<ul><li><em>From:</em> Alan Hindmarsh &lt;alanh@llnl.gov&gt;</li></ul></li>
<li><strong><a name="00710" href="msg00710.html">Re: Re-4: [sundials-users] performance for chemical kinetic problems</a></strong>
<ul><li><em>From:</em> Michael Letzgus &lt;michael.letzgus@uni-bielefeld.de&gt;</li></ul></li>
<li><strong><a name="00712" href="msg00712.html">Re: Re-4: [sundials-users] performance for chemical kinetic problems</a></strong>
<ul><li><em>From:</em> Alan Hindmarsh &lt;alanh@llnl.gov&gt;</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00712.html">Re: Re-4: [sundials-users] performance for chemical kinetic problems</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00714.html">[sundials-users] how to install</a></strong>
</li>

<li>Previous by thread:
<strong><a href="msg00712.html">Re: Re-4: [sundials-users] performance for chemical kinetic problems</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00700.html">Re: [sundials-users] Maximum order of 12 in the non-stiff IVP</a></strong>
</li>

<li>Index(es):
<ul>
<li><a href="maillist.html#00713">
<strong>Main</strong></a></li>
<li><a href="threads.html#00713">
<strong>Thread</strong></a></li>
</ul>
</li>
</ul>
</div>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<!-- End content for this page -->
  </div>
  </td>
  <td background="../../graphics/table_bck3.gif"></td>
  </tr>
  <tr valign="top">
  <td height="17" background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  <td width="116"><a HREF="http://www.llnl.gov/disclaimer.html" target="_top"><img SRC="../../graphics/line_bl.gif" height="17" width="116" border="0"></a></td>
  <td width="720"><img SRC="../../graphics/line_br.gif" height="17" width="720" border="0"></td>
  <td background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  </tr>
  </table>
</body>
</html>
