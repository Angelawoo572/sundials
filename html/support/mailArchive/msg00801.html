<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: [sundials&#45;users] SundialsTB::Cvodes::cvfdx.m -->
<!--X-From-R13: Oyrknaqer Rbamr <Oyrknaqer.RbamrNvznt.se> -->
<!--X-Date: Sun, 03 Dec 2006 06:40:26 &#45;0800 -->
<!--X-Message-Id: Pine.LNX.4.64.0612031509410.619@pelve.imag.fr -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 35f4e4e10612030543g5a1ca0a1w4f4a862e1147f967@mail.gmail.com -->
<!--X-Head-End-->
<html>
<head>
<title>Re: [sundials-users] SundialsTB::Cvodes::cvfdx.m</title>
<meta name="author" content="Radu Serban">
<meta name="description" content="suite of nonlinear differential algebraic equation solvers">
<meta name="keywords" content="SUNDIALS, CVODE, CVODES, IDA, KINSOL">
<meta name="keywords" content="ODE, DAE, sensitivity">
<meta name="keywords" content="differential, algebraic">
<link REL="SHORTCUT ICON" HREF="img/favicon.ico" type="image/x-icon">
<link REL="ICON" HREF="img/favicon.ico" type="image/x-icon">
<link href="../../sundials_styles.css" rel="stylesheet" type="text/css">
<script language="JavaScript">
<!--
homeon = new Image();           homeon.src = "../../graphics/home_buttonH.png";
homeoff = new Image();          homeoff.src = "../../graphics/home_button.png";
descriptionon = new Image();    descriptionon.src = "../../graphics/description_buttonH.png";
descriptionoff = new Image();   descriptionoff.src = "../../graphics/description_button.png";
documentationon = new Image();  documentationon.src = "../../graphics/documentation_buttonH.png";
documentationoff = new Image(); documentationoff.src = "../../graphics/documentation_button.png";
downloadon = new Image();       downloadon.src = "../../graphics/download_buttonH.png";
downloadoff = new Image();      downloadoff.src = "../../graphics/download_button.png";
supporton = new Image();        supporton.src = "../../graphics/support_buttonH.png";
supportoff = new Image();       supportoff.src = "../../graphics/support_button.png";
//-->
</script>
<script src="../../sunjs.js" type="text/javascript" language="javascript1.2"></script>
</head>
<!-- ******************************************************************************** -->
<body>
<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
  <td height="60" background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  <td width="116"><img SRC="../../graphics/head_top_left.png" height="60" width="116" border="0"></td>
  <td width="720"><img SRC="../../graphics/head_mail_top_right.png" height="60" width="720" border="0"></td>
  <td background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  </tr>
  <tr valign="top">
  <td height="127" background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  <td width="116">
    <a href="../../main.html" onMouseOver="img_act('home'); return true;" onMouseOut="img_inact('home'); return true;"><img src="../../graphics/home_button.png" border="0" name="home"></a><br>
    <a href="../../description/description.html" onMouseOver="img_act('description'); return true;" onMouseOut="img_inact('description'); return true;"><img src="../../graphics/description_button.png" border="0" name="description"></a><br>
    <a href="../../documentation/documentation.html" onMouseOver="img_act('documentation'); return true;" onMouseOut="img_inact('documentation'); return true;"><img src="../../graphics/documentation_button.png" border="0" name="documentation"></a><br>
    <a href="../../download/download.html" onMouseOver="img_act('download'); return true;" onMouseOut="img_inact('download'); return true;"><img src="../../graphics/download_button.png" border="0" name="download"></a><br>
    <a href="../../support/support.html" onMouseOver="img_act('support'); return true;" onMouseOut="img_inact('support'); return true;"><img src="../../graphics/support_button.png" border="0" name="support"></a><br>
    <img SRC="../../graphics/line_tl.gif" height="7" width="116" border="0"></td>
  <td width="720">
      <img SRC="../../graphics/head_bottom_right.png" height="120" width="720" border="0"><br>
      <img SRC="../../graphics/line_tr.gif" height="7" width="720" border="0"></td>
  <td background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  </tr>
  <tr valign="top">
  <td background="../../graphics/table_bck3.gif"></td>
  <td width="116" valign="bottom" align="center" background="../../graphics/table_bck5.gif"><img SRC="../../graphics/logo.png" border="0"></td>
  <td width="720" bgcolor="#ffffff">
  <div id="content">   
<!-- Start content for this page -->
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<p class="links">
[<a href="msg00800.html">Date Prev</a>] [<a href="msg00802.html">Date Next</a>] [<a href="msg00800.html">Thread Prev</a>] [<a href="msg00803.html">Thread Next</a>]<br>
[<b><a href="maillist.html#00801">Date Index</a></b>]
[<b><a href="threads.html#00801">Thread Index</a></b>]
</p>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [sundials-users] SundialsTB::Cvodes::cvfdx.m</h1>
<div class="frame">
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<table border=0 cellpadding=2 cellspacing=0>
<tr>
<td align="right"><b>
<em>From</em></b></td>
<td align="left">
Alexandre Donze &lt;<a href="mailto:Alexandre.Donze%40imag.fr">Alexandre.Donze@imag.fr</a>&gt;</td>
</tr>

<tr>
<td align="right"><b>
<em>Date</em></b></td>
<td align="left">
Sun, 3 Dec 2006 15:39:06 +0100 (MET)</td>
</tr>

</table>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div>
<div class="container">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Hello,</pre><br>
<pre style="margin: 0em;">On Sun, 3 Dec 2006, karima djabella wrote:</pre><br>
<blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">Hello,</pre><br>
<pre style="margin: 0em;">I use cvodes of SundialsTB. I would like to use the sensitivity analysis
capabilities (forward and adjoint)  to my nonlinear system consisting of 8
state variables and 60 parametrers . In the example cvfdx.m (CVODES forward
sensitivity example) i found a problem when i run it, the error message is:
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
??? Error using ==&gt; reshape
To RESHAPE the number of elements must not change.</pre><br>
<pre style="margin: 0em;">Error in ==&gt; cvm_monitor at 8
yS = reshape(yS,N,Ns);</pre><br>
<pre style="margin: 0em;">Error in ==&gt; CVode at 62
[status,t,y,v1] = cvm(mode,tout,itask);</pre><br>
<pre style="margin: 0em;">Error in ==&gt; cvfdx at 93
[status, t, y, yS] = CVode(tout,'Normal');</pre><br>
<pre style="margin: 0em;">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</pre><br>
<tt>could you help me to overcome this error?
</tt></blockquote><tt><br>I also noticed that this was happening sometimes (usually when 
something got wrong before). The pb was that 
matlab function reshape was called with yS being an empty array. 
To overcome this problem, I just edited the file cvm_monitor.m so that 
it checks if yS is not empty before reshaping it :</tt><br>
<br>
<pre style="margin: 0em;">just change:</pre><br>
<pre style="margin: 0em;">N = length(y);
yS = reshape(yS,N,Ns);</pre><br>
<pre style="margin: 0em;">into:</pre><br>
<pre style="margin: 0em;">if (~isempty(yS))
  N = length(y);
  yS = reshape(yS,N,Ns);
end</pre><br>
<pre style="margin: 0em;">Don't know if this is the best way to fix this, but it worked for me.</pre><br>
<blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;"><br>Also, you put on the options, of the case 2 (commented part), the following
one: 'ParamField', 'p'. is this meant that you choose all the parameters for
the sensitivity study?. In my problem, i have 60 parameters and i would like
to study the sensitivity of a few number of parameters not the all. How can
i change the program in order to choose only some parameters?
</pre></blockquote><tt><br>just use the option 'Paramlist' (see CVodeSetFSAOptions. Unless you 
want to use your own sensitivity rhs function). In the comments 
in the example, you can see that 'Paramlist' is set to [1 2] meaning 
that the sensitivity is computed only for p1 and p2.</tt><br>
<br>
<pre style="margin: 0em;">Alex.</pre><br>
<pre style="margin: 0em;">--
Alexandre Donz&#xE9;
Doctorant UJF
Laboratoire VERIMAG
2 avenue de Vignate
38610 GIERES
Tel: 33 4 56 52 03 63
Fax: 33 4 56 52 03 44</pre><br>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<div class="container">
<table width="95%" frame="below"><tr><td></td></table>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00803" href="msg00803.html">Re: [sundials-users] SundialsTB::Cvodes::cvfdx.m</a></strong>
<ul><li><em>From:</em> &quot;karima djabella&quot; &lt;karima.djabella@gmail.com&gt;</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00800" href="msg00800.html">[sundials-users] SundialsTB::Cvodes::cvfdx.m</a></strong>
<ul><li><em>From:</em> &quot;karima djabella&quot; &lt;karima.djabella@gmail.com&gt;</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00800.html">[sundials-users] SundialsTB::Cvodes::cvfdx.m</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00802.html">Re: [sundials-users] SundialsTB::Cvodes::cvfdx.m</a></strong>
</li>

<li>Previous by thread:
<strong><a href="msg00800.html">[sundials-users] SundialsTB::Cvodes::cvfdx.m</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00803.html">Re: [sundials-users] SundialsTB::Cvodes::cvfdx.m</a></strong>
</li>

<li>Index(es):
<ul>
<li><a href="maillist.html#00801">
<strong>Main</strong></a></li>
<li><a href="threads.html#00801">
<strong>Thread</strong></a></li>
</ul>
</li>
</ul>
</div>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<!-- End content for this page -->
  </div>
  </td>
  <td background="../../graphics/table_bck3.gif"></td>
  </tr>
  <tr valign="top">
  <td height="17" background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  <td width="116"><a HREF="http://www.llnl.gov/disclaimer.html" target="_top"><img SRC="../../graphics/line_bl.gif" height="17" width="116" border="0"></a></td>
  <td width="720"><img SRC="../../graphics/line_br.gif" height="17" width="720" border="0"></td>
  <td background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  </tr>
  </table>
</body>
</html>
