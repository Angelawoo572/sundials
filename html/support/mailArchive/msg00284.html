<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: [sundials&#45;users] Problem reagring Residual function in IDA -->
<!--X-From-R13: Dnqh Ereona <freona1Nyyay.tbi> -->
<!--X-Date: Thu, 02 Feb 2006 09:15:13 &#45;0800 (PST) -->
<!--X-Message-Id: 43E23D70.6010208@llnl.gov -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: c600b5b40601252343t2e1323d8hda77a43ce68305ce@mail.gmail.com -->
<!--X-Reference: 43DAA9CC.1040106@llnl.gov -->
<!--X-Head-End-->
<html>
<head>
<title>Re: [sundials-users] Problem reagring Residual function in IDA</title>
<meta name="author" content="Radu Serban">
<meta name="description" content="suite of nonlinear differential algebraic equation solvers">
<meta name="keywords" content="SUNDIALS, CVODE, CVODES, IDA, KINSOL">
<meta name="keywords" content="ODE, DAE, sensitivity">
<meta name="keywords" content="differential, algebraic">
<link REL="SHORTCUT ICON" HREF="img/favicon.ico" type="image/x-icon">
<link REL="ICON" HREF="img/favicon.ico" type="image/x-icon">
<link href="../../sundials_styles.css" rel="stylesheet" type="text/css">
<script language="JavaScript">
<!--
homeon = new Image();           homeon.src = "../../graphics/home_buttonH.png";
homeoff = new Image();          homeoff.src = "../../graphics/home_button.png";
descriptionon = new Image();    descriptionon.src = "../../graphics/description_buttonH.png";
descriptionoff = new Image();   descriptionoff.src = "../../graphics/description_button.png";
documentationon = new Image();  documentationon.src = "../../graphics/documentation_buttonH.png";
documentationoff = new Image(); documentationoff.src = "../../graphics/documentation_button.png";
downloadon = new Image();       downloadon.src = "../../graphics/download_buttonH.png";
downloadoff = new Image();      downloadoff.src = "../../graphics/download_button.png";
supporton = new Image();        supporton.src = "../../graphics/support_buttonH.png";
supportoff = new Image();       supportoff.src = "../../graphics/support_button.png";
//-->
</script>
<script src="../../sunjs.js" type="text/javascript" language="javascript1.2"></script>
</head>
<!-- ******************************************************************************** -->
<body>
<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
  <td height="60" background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  <td width="116"><img SRC="../../graphics/head_top_left.png" height="60" width="116" border="0"></td>
  <td width="720"><img SRC="../../graphics/head_mail_top_right.png" height="60" width="720" border="0"></td>
  <td background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  </tr>
  <tr valign="top">
  <td height="127" background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  <td width="116">
    <a href="../../main.html" onMouseOver="img_act('home'); return true;" onMouseOut="img_inact('home'); return true;"><img src="../../graphics/home_button.png" border="0" name="home"></a><br>
    <a href="../../description/description.html" onMouseOver="img_act('description'); return true;" onMouseOut="img_inact('description'); return true;"><img src="../../graphics/description_button.png" border="0" name="description"></a><br>
    <a href="../../documentation/documentation.html" onMouseOver="img_act('documentation'); return true;" onMouseOut="img_inact('documentation'); return true;"><img src="../../graphics/documentation_button.png" border="0" name="documentation"></a><br>
    <a href="../../download/download.html" onMouseOver="img_act('download'); return true;" onMouseOut="img_inact('download'); return true;"><img src="../../graphics/download_button.png" border="0" name="download"></a><br>
    <a href="../../support/support.html" onMouseOver="img_act('support'); return true;" onMouseOut="img_inact('support'); return true;"><img src="../../graphics/support_button.png" border="0" name="support"></a><br>
    <img SRC="../../graphics/line_tl.gif" height="7" width="116" border="0"></td>
  <td width="720">
      <img SRC="../../graphics/head_bottom_right.png" height="120" width="720" border="0"><br>
      <img SRC="../../graphics/line_tr.gif" height="7" width="720" border="0"></td>
  <td background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  </tr>
  <tr valign="top">
  <td background="../../graphics/table_bck3.gif"></td>
  <td width="116" valign="bottom" align="center" background="../../graphics/table_bck5.gif"><img SRC="../../graphics/logo.png" border="0"></td>
  <td width="720" bgcolor="#ffffff">
  <div id="content">   
<!-- Start content for this page -->
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<p class="links">
[<a href="msg00283.html">Date Prev</a>] [<a href="msg00285.html">Date Next</a>] [<a href="msg00278.html">Thread Prev</a>] [<a href="msg00285.html">Thread Next</a>]<br>
[<b><a href="maillist.html#00284">Date Index</a></b>]
[<b><a href="threads.html#00284">Thread Index</a></b>]
</p>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [sundials-users] Problem reagring Residual function in IDA</h1>
<div class="frame">
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<table border=0 cellpadding=2 cellspacing=0>
<tr>
<td align="right"><b>
<em>From</em></b></td>
<td align="left">
Radu Serban &lt;<a href="mailto:serban1%40llnl.gov">serban1@llnl.gov</a>&gt;</td>
</tr>

<tr>
<td align="right"><b>
<em>Date</em></b></td>
<td align="left">
Thu, 02 Feb 2006 09:12:16 -0800</td>
</tr>

</table>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div>
<div class="container">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
Radu Serban wrote:
<blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">Vinayak Kumar wrote:</pre><br>
<blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">Hi all,</pre><br>
I have a problem in IDASolve(). In one of the ciruit, I am  using 
Piecewise-Linear source (one like in SPICE). When the time steps for 
getting the solution using IDASolve() is set high (1e-5), the solver is 
</blockquote><pre style="margin: 0em;"><br></pre><br>
By time steps here, do you mean the difference between consecutive tout 
values in IDASolve() called with itask=IDA_NORMAL?<br>
<br>
<blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em">giving error with flag 6 telling that minimum time step has been 
</blockquote><pre style="margin: 0em;"><br></pre><br>
I assume you mean you get a return value IDA_ERR_FAIL (= -6), i.e. a 
repeated error test failure, correct?<br>
<br>
<blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em">reached.When I am reducing the time step (1e-7), the solver is able to 
execute properly, but when I checked Residual function defined, the 
solver is skipping this function for most of the steps.
</blockquote><pre style="margin: 0em;"><br></pre><br>
I'm not sure I understand what you mean... Are you saying that IDA is 
not 'sampling' your piecewise linear function as often as you'd like? 
Can you provide some more information about the source term?  What is it 
a function of? What are the intervals it's defined on? How smooth is it?<br>
<br>
<blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em">I am not able to understand why this is happening. After getting the 
solution, I tried to verify the solution with SPICE, it is not at all 
accurate. Please help me with this problem. Do I need to set some kind 
of parameters in IDA for this?
</blockquote><pre style="margin: 0em;"><br></pre><br>
Please also provide other relevant information (tolerances, linear 
solver used, Jacobian function used, etc.)<br>
<br>
<blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">I hope I was able to convey my question.</pre><br>
<pre style="margin: 0em;">Thanks in advance,</pre><br>
Vinayak
</blockquote><pre style="margin: 0em;"><br></pre><br>
<pre style="margin: 0em;">--Radu</pre><br>
</blockquote><pre style="margin: 0em;"><br>Vinayak,</pre><br>
I'd really appreciate it if you'd continue posting on the sundials-users mailing list for everybody 
to have access to this info...<br>
So I posted below the reply you've sent me to the above message.<br>
<br>
Regarding the IDACalcIC error, a return value IDA_NO_RECOVERY means that your residual function has 
returned a positive flag (which indicates a recoverable failure). Make sure that if no problems 
occur in your res function it returns a value of 0 indicating success! If you're using the SPGMR 
linear solver and provide your own preconditioner setup and solve functions, make sure that that is 
true for those as well.<br>
<br>
<pre style="margin: 0em;">--Radu</pre><br>
<pre style="margin: 0em;"><br></pre><br>
<pre style="margin: 0em;">Vinayak Kumar wrote:
&gt; Radu,
&gt;
&gt; Thanks for your quick reply and Sorry for replying late
&gt;
&gt; Yes, by time steps I meant the time steps for consecutive tout. If I was
&gt; keeping it high, it's not able to solve and giving me error with flag 6
&gt; that minimum time steps value has been reached.
&gt;
&gt; But later when I analyzed, my PWL source wasn't accurate. Now the tool
&gt; is able to solve it.  I am sorry for your precious time.
&gt;
&gt; But still I am geting one problem that IDACalcIC() method is giving
&gt; error with flag -19 telling that routine had a recoverable error, but
&gt; couldn't recover. I checked the initial values for the DAEs and the
&gt; values are satisfying all the equaions. Without IDACalcIC(), it's able
&gt; to solve it properly.
&gt;
&gt; What may be the problem?
&gt;
&gt; Thanks for your time ..
&gt;
&gt; Vinayak
&gt;</pre><br>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<div class="container">
<table width="95%" frame="below"><tr><td></td></table>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00285" href="msg00285.html">[sundials-users] N_VECTOR in Pvode</a></strong>
<ul><li><em>From:</em> raj duffy &lt;raj_duffy@yahoo.com&gt;</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00264" href="msg00264.html">[sundials-users] Problem reagring Residual function in IDA</a></strong>
<ul><li><em>From:</em> Vinayak Kumar &lt;vinayak.kumar@gmail.com&gt;</li></ul></li>
<li><strong><a name="00278" href="msg00278.html">Re: [sundials-users] Problem reagring Residual function in IDA</a></strong>
<ul><li><em>From:</em> Radu Serban &lt;serban1@llnl.gov&gt;</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00283.html">Re: [sundials-users] Tolerance in CVSPGMR()</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00285.html">[sundials-users] N_VECTOR in Pvode</a></strong>
</li>

<li>Previous by thread:
<strong><a href="msg00278.html">Re: [sundials-users] Problem reagring Residual function in IDA</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00285.html">[sundials-users] N_VECTOR in Pvode</a></strong>
</li>

<li>Index(es):
<ul>
<li><a href="maillist.html#00284">
<strong>Main</strong></a></li>
<li><a href="threads.html#00284">
<strong>Thread</strong></a></li>
</ul>
</li>
</ul>
</div>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<!-- End content for this page -->
  </div>
  </td>
  <td background="../../graphics/table_bck3.gif"></td>
  </tr>
  <tr valign="top">
  <td height="17" background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  <td width="116"><a HREF="http://www.llnl.gov/disclaimer.html" target="_top"><img SRC="../../graphics/line_bl.gif" height="17" width="116" border="0"></a></td>
  <td width="720"><img SRC="../../graphics/line_br.gif" height="17" width="720" border="0"></td>
  <td background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  </tr>
  </table>
</body>
</html>
