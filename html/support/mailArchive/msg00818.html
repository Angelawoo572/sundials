<!-- MHonArc v2.6.10 -->
<!--X-Subject: [sundials&#45;users] Building SUNDIALS on Gentoo within an ebuild -->
<!--X-From-R13: Xnzrf Rbzval <wnzrfNaoa.np.mn> -->
<!--X-Date: Thu, 07 Dec 2006 00:34:53 &#45;0800 -->
<!--X-Message-Id: 4577D0E0.7080207@nbn.ac.za -->
<!--X-Content-Type: text/plain -->
<!--X-Head-End-->
<html>
<head>
<title>[sundials-users] Building SUNDIALS on Gentoo within an ebuild</title>
<meta name="author" content="Radu Serban">
<meta name="description" content="suite of nonlinear differential algebraic equation solvers">
<meta name="keywords" content="SUNDIALS, CVODE, CVODES, IDA, KINSOL">
<meta name="keywords" content="ODE, DAE, sensitivity">
<meta name="keywords" content="differential, algebraic">
<link REL="SHORTCUT ICON" HREF="img/favicon.ico" type="image/x-icon">
<link REL="ICON" HREF="img/favicon.ico" type="image/x-icon">
<link href="../../sundials_styles.css" rel="stylesheet" type="text/css">
<script language="JavaScript">
<!--
homeon = new Image();           homeon.src = "../../graphics/home_buttonH.png";
homeoff = new Image();          homeoff.src = "../../graphics/home_button.png";
descriptionon = new Image();    descriptionon.src = "../../graphics/description_buttonH.png";
descriptionoff = new Image();   descriptionoff.src = "../../graphics/description_button.png";
documentationon = new Image();  documentationon.src = "../../graphics/documentation_buttonH.png";
documentationoff = new Image(); documentationoff.src = "../../graphics/documentation_button.png";
downloadon = new Image();       downloadon.src = "../../graphics/download_buttonH.png";
downloadoff = new Image();      downloadoff.src = "../../graphics/download_button.png";
supporton = new Image();        supporton.src = "../../graphics/support_buttonH.png";
supportoff = new Image();       supportoff.src = "../../graphics/support_button.png";
//-->
</script>
<script src="../../sunjs.js" type="text/javascript" language="javascript1.2"></script>
</head>
<!-- ******************************************************************************** -->
<body>
<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
  <td height="60" background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  <td width="116"><img SRC="../../graphics/head_top_left.png" height="60" width="116" border="0"></td>
  <td width="720"><img SRC="../../graphics/head_mail_top_right.png" height="60" width="720" border="0"></td>
  <td background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  </tr>
  <tr valign="top">
  <td height="127" background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  <td width="116">
    <a href="../../main.html" onMouseOver="img_act('home'); return true;" onMouseOut="img_inact('home'); return true;"><img src="../../graphics/home_button.png" border="0" name="home"></a><br>
    <a href="../../description/description.html" onMouseOver="img_act('description'); return true;" onMouseOut="img_inact('description'); return true;"><img src="../../graphics/description_button.png" border="0" name="description"></a><br>
    <a href="../../documentation/documentation.html" onMouseOver="img_act('documentation'); return true;" onMouseOut="img_inact('documentation'); return true;"><img src="../../graphics/documentation_button.png" border="0" name="documentation"></a><br>
    <a href="../../download/download.html" onMouseOver="img_act('download'); return true;" onMouseOut="img_inact('download'); return true;"><img src="../../graphics/download_button.png" border="0" name="download"></a><br>
    <a href="../../support/support.html" onMouseOver="img_act('support'); return true;" onMouseOut="img_inact('support'); return true;"><img src="../../graphics/support_button.png" border="0" name="support"></a><br>
    <img SRC="../../graphics/line_tl.gif" height="7" width="116" border="0"></td>
  <td width="720">
      <img SRC="../../graphics/head_bottom_right.png" height="120" width="720" border="0"><br>
      <img SRC="../../graphics/line_tr.gif" height="7" width="720" border="0"></td>
  <td background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  </tr>
  <tr valign="top">
  <td background="../../graphics/table_bck3.gif"></td>
  <td width="116" valign="bottom" align="center" background="../../graphics/table_bck5.gif"><img SRC="../../graphics/logo.png" border="0"></td>
  <td width="720" bgcolor="#ffffff">
  <div id="content">   
<!-- Start content for this page -->
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<p class="links">
[<a href="msg00817.html">Date Prev</a>] [<a href="msg00819.html">Date Next</a>] [<a href="msg00814.html">Thread Prev</a>] [<a href="msg00822.html">Thread Next</a>]<br>
[<b><a href="maillist.html#00818">Date Index</a></b>]
[<b><a href="threads.html#00818">Thread Index</a></b>]
</p>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>[sundials-users] Building SUNDIALS on Gentoo within an ebuild</h1>
<div class="frame">
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<table border=0 cellpadding=2 cellspacing=0>
<tr>
<td align="right"><b>
<em>From</em></b></td>
<td align="left">
James Dominy &lt;<a href="mailto:james%40nbn.ac.za">james@nbn.ac.za</a>&gt;</td>
</tr>

<tr>
<td align="right"><b>
<em>Date</em></b></td>
<td align="left">
Thu, 07 Dec 2006 10:29:20 +0200</td>
</tr>

</table>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div>
<div class="container">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>Hi,

I'm trying to modify the ebuild for SUNDIALS to update for version
2.3.0. However, during the build process, I get permission denied
errors, because the ebuild system builds packages within sandbox,
denying access to the system. Actually, it builds fine, but fails on
install. Here is the relevant output, I can provide a complete
transcript if anyone wants it, but it's a bit big to post unannounced to
a mailing list.

--snip--

----------------------
Install src/sundials...
----------------------
make[1]: Entering directory
`/var/tmp/portage/sundials-2.3.0/work/sundials-2.3.0/src/sundials'
/bin/sh ./../../config/mkinstalldirs  /usr/include/sundials
/bin/sh ./../../config/mkinstalldirs  /usr/bin
/bin/install -c -m 644 ./../../include/sundials/sundials_band.h
/usr/include/sundials/
ACCESS DENIED  unlink:    /usr/include/sundials/sundials_band.h
/bin/install: cannot remove `/usr/include/sundials/sundials_band.h':
Permission denied
make[1]: *** [install] Error 1
make[1]: Leaving directory
`/var/tmp/portage/sundials-2.3.0/work/sundials-2.3.0/src/sundials'

--snip--

Ideally, if someone knows how to modify the ebuild so that the
permissions problem is avoided, that would be great. If someone has a
working ebuild for sudials 2.3.0, even better.

The problem appears to be with the actual build process,
using absolute paths for install, but I'm not sure enough of how things
work to be certain.

Thanks,
James

Here is a copy of my ebuild so far, modified from that provided at
<a  href="http://bugs.gentoo.org/show_bug.cgi?id=74356">http://bugs.gentoo.org/show_bug.cgi?id=74356</a>

--snip--

# Copyright 2004 Gentoo Technologies, Inc.
# Distributed under the terms of the GNU General Public License v2
# $Header: /home/casc/repository/sundials/html/support/mailArchive/Attic/msg00818.html,v 1.1 2007-03-22 17:46:08 radu Exp $

inherit fortran

IUSE=&quot;fortran mpi shared&quot;

DESCRIPTION=&quot;SUNDIALS (SUite of Nonlinear and DIfferential/ALgebraic
equation So
lvers)&quot;
HOMEPAGE=&quot;<a  href="http://www.llnl.gov/CASC/sundials/&quot">http://www.llnl.gov/CASC/sundials/&quot</a>;
SRC_URI=&quot;<a  href="http://www.llnl.gov/casc/sundials/download/code/${P}.tar.gz&quot">http://www.llnl.gov/casc/sundials/download/code/${P}.tar.gz&quot</a>;
LICENSE=&quot;BSD&quot;

DEPEND=&quot;mpi? ( sys-cluster/lam-mpi )&quot;
        # gcc and lam-mpi must be built with USE=fortran

SLOT=&quot;0&quot;
KEYWORDS=&quot;~x86&quot;

#f77_CONF=&quot;--with-f77&quot;
f77_CONF=&quot;F77=g77&quot;

src_compile() {

        local myconf
        fconf=&quot; &quot;
        if useq fortran; then
                fortran_pkg_setup
                myconf=&quot;F77=g77&quot;
                # switch to `use_enable fortran`
        fi

        econf \
                ${myconf} \
                `use_enable shared` ||  die &quot;econf failed&quot;

        emake || die &quot;emake failed&quot;
}


src_install() {
        # ?? dolib dolib.a dolib.so
        #addwrite /usr/lib/
        #addwrite /usr/include/
        emake DESTDIR=&quot;${D}&quot; install
}

pkg_postinst() {
        einfo &quot;Please register your use of this package at
<a  href="http://www.llnl.gov/C">http://www.llnl.gov/C</a>
ASC/sundials/download/get_sundials_reg.html&quot;
}

--snip--

A: Post your responses after the portion of the message to which
you're replying.
Q: So what should we do?
A: Because it reverses the order in which we read things.
Q: Why is top-posting a bad idea?

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<div class="container">
<table width="95%" frame="below"><tr><td></td></table>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00822" href="msg00822.html">Re: [sundials-users] Building SUNDIALS on Gentoo within an ebuild</a></strong>
<ul><li><em>From:</em> Radu Serban &lt;radu@llnl.gov&gt;</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00817.html">Re: [sundials-users] Re: (IDACalcIC failure)</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00819.html">[sundials-users] IDA stochastic problem</a></strong>
</li>

<li>Previous by thread:
<strong><a href="msg00814.html">[sundials-users] Compliment + Question</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00822.html">Re: [sundials-users] Building SUNDIALS on Gentoo within an ebuild</a></strong>
</li>

<li>Index(es):
<ul>
<li><a href="maillist.html#00818">
<strong>Main</strong></a></li>
<li><a href="threads.html#00818">
<strong>Thread</strong></a></li>
</ul>
</li>
</ul>
</div>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<!-- End content for this page -->
  </div>
  </td>
  <td background="../../graphics/table_bck3.gif"></td>
  </tr>
  <tr valign="top">
  <td height="17" background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  <td width="116"><a HREF="http://www.llnl.gov/disclaimer.html" target="_top"><img SRC="../../graphics/line_bl.gif" height="17" width="116" border="0"></a></td>
  <td width="720"><img SRC="../../graphics/line_br.gif" height="17" width="720" border="0"></td>
  <td background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  </tr>
  </table>
</body>
</html>
