<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: [sundials&#45;users] value of t during internal steps of CVODE call -->
<!--X-From-R13: Dnqh Ereona <freona1Nyyay.tbi> -->
<!--X-Date: Tue, 21 Feb 2006 06:01:57 &#45;0800 (PST) -->
<!--X-Message-Id: 43FB1CE5.5010601@llnl.gov -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 20060221071024.98087.qmail@web37008.mail.mud.yahoo.com -->
<!--X-Head-End-->
<html>
<head>
<title>Re: [sundials-users] value of t during internal steps of CVODE call</title>
<meta name="author" content="Radu Serban">
<meta name="description" content="suite of nonlinear differential algebraic equation solvers">
<meta name="keywords" content="SUNDIALS, CVODE, CVODES, IDA, KINSOL">
<meta name="keywords" content="ODE, DAE, sensitivity">
<meta name="keywords" content="differential, algebraic">
<link REL="SHORTCUT ICON" HREF="img/favicon.ico" type="image/x-icon">
<link REL="ICON" HREF="img/favicon.ico" type="image/x-icon">
<link href="../../sundials_styles.css" rel="stylesheet" type="text/css">
<script language="JavaScript">
<!--
homeon = new Image();           homeon.src = "../../graphics/home_buttonH.png";
homeoff = new Image();          homeoff.src = "../../graphics/home_button.png";
descriptionon = new Image();    descriptionon.src = "../../graphics/description_buttonH.png";
descriptionoff = new Image();   descriptionoff.src = "../../graphics/description_button.png";
documentationon = new Image();  documentationon.src = "../../graphics/documentation_buttonH.png";
documentationoff = new Image(); documentationoff.src = "../../graphics/documentation_button.png";
downloadon = new Image();       downloadon.src = "../../graphics/download_buttonH.png";
downloadoff = new Image();      downloadoff.src = "../../graphics/download_button.png";
supporton = new Image();        supporton.src = "../../graphics/support_buttonH.png";
supportoff = new Image();       supportoff.src = "../../graphics/support_button.png";
//-->
</script>
<script src="../../sunjs.js" type="text/javascript" language="javascript1.2"></script>
</head>
<!-- ******************************************************************************** -->
<body>
<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
  <td height="60" background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  <td width="116"><img SRC="../../graphics/head_top_left.png" height="60" width="116" border="0"></td>
  <td width="720"><img SRC="../../graphics/head_mail_top_right.png" height="60" width="720" border="0"></td>
  <td background="../../graphics/table_bck1.gif"><img src="../../graphics/table_bck1.gif" width="5" height="60"></td>
  </tr>
  <tr valign="top">
  <td height="127" background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  <td width="116">
    <a href="../../main.html" onMouseOver="img_act('home'); return true;" onMouseOut="img_inact('home'); return true;"><img src="../../graphics/home_button.png" border="0" name="home"></a><br>
    <a href="../../description/description.html" onMouseOver="img_act('description'); return true;" onMouseOut="img_inact('description'); return true;"><img src="../../graphics/description_button.png" border="0" name="description"></a><br>
    <a href="../../documentation/documentation.html" onMouseOver="img_act('documentation'); return true;" onMouseOut="img_inact('documentation'); return true;"><img src="../../graphics/documentation_button.png" border="0" name="documentation"></a><br>
    <a href="../../download/download.html" onMouseOver="img_act('download'); return true;" onMouseOut="img_inact('download'); return true;"><img src="../../graphics/download_button.png" border="0" name="download"></a><br>
    <a href="../../support/support.html" onMouseOver="img_act('support'); return true;" onMouseOut="img_inact('support'); return true;"><img src="../../graphics/support_button.png" border="0" name="support"></a><br>
    <img SRC="../../graphics/line_tl.gif" height="7" width="116" border="0"></td>
  <td width="720">
      <img SRC="../../graphics/head_bottom_right.png" height="120" width="720" border="0"><br>
      <img SRC="../../graphics/line_tr.gif" height="7" width="720" border="0"></td>
  <td background="../../graphics/table_bck2.gif"><img src="../../graphics/table_bck2.gif" width="5" height="127"></td>
  </tr>
  <tr valign="top">
  <td background="../../graphics/table_bck3.gif"></td>
  <td width="116" valign="bottom" align="center" background="../../graphics/table_bck5.gif"><img SRC="../../graphics/logo.png" border="0"></td>
  <td width="720" bgcolor="#ffffff">
  <div id="content">   
<!-- Start content for this page -->
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<p class="links">
[<a href="msg00304.html">Date Prev</a>] [<a href="msg00306.html">Date Next</a>] [<a href="msg00303.html">Thread Prev</a>] [<a href="msg00306.html">Thread Next</a>]<br>
[<b><a href="maillist.html#00305">Date Index</a></b>]
[<b><a href="threads.html#00305">Thread Index</a></b>]
</p>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [sundials-users] value of t during internal steps of CVODE call</h1>
<div class="frame">
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<table border=0 cellpadding=2 cellspacing=0>
<tr>
<td align="right"><b>
<em>From</em></b></td>
<td align="left">
Radu Serban &lt;<a href="mailto:serban1%40llnl.gov">serban1@llnl.gov</a>&gt;</td>
</tr>

<tr>
<td align="right"><b>
<em>Date</em></b></td>
<td align="left">
Tue, 21 Feb 2006 06:00:05 -0800</td>
</tr>

</table>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
</div>
<div class="container">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">Hi Raj,</pre><br>
Andreas is correct. These all seem to be calls to the RHS function made from the DQ internal 
Jacobian approximation function. To verify that, you can monitor the number of calls to f() from 
such DQ functions (use CVDenseGetNumRhsEvals or CVBandGetNumRhsEvals for the dense or banded linear 
solver module, respectively). Also, these calls to f() are made at the same value of t but each with 
slightly perturbed values of the states (print the values of y from within f to see that).<br>
<br>
However, if this is the case, you should see 6 of these calls at the first step too (the Jacobian 
function is always called at nsteps=0).<br>
<br>
Can you monitor and report some of the other solver statistics (number of convergence failures, 
error test failures, etc), as well as confirm the linear solver that you use?<br>
<br>
<pre style="margin: 0em;">In any case, inside your RHS function, ALWAYS use the value of t that is passed 
as an argument.</pre><br>
<pre style="margin: 0em;">--Radu</pre><br>
raj duffy wrote:
<blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">Hello</pre><br>
           When I am printing time t within the for-loop for Cvode with 
Normal-stepping (denoted by Tsteps) and then inside function f() 
(denoted by t) I get something like<br>
<br>
<pre style="margin: 0em;"> t = 0.000000
 t = 0.000010
 t = 0.100010
 t = 1.100010
 Tsteps = 1.000000 nsteps 3</pre><br>
<pre style="margin: 0em;"> t = 2.100010
 Tsteps = 2.000000 nsteps 4</pre><br>
<pre style="margin: 0em;"> t = 3.100010
 Tsteps = 3.000000 nsteps 5</pre><br>
<pre style="margin: 0em;"> t = 4.100010
 Tsteps = 4.000000 nsteps 6</pre><br>
<pre style="margin: 0em;">..........................
........................
......................</pre><br>
<pre style="margin: 0em;"> Tsteps = 51.000000 nsteps 53</pre><br>
<pre style="margin: 0em;"> t = 52.100010
 t = 52.100010
 t = 52.100010
 t = 52.100010
 t = 52.100010
 t = 52.100010
 Tsteps = 52.000000 nsteps 54</pre><br>
<pre style="margin: 0em;"> t = 53.100010
 t = 53.100010
&amp;nb! sp;t = 53.100010
 t = 53.100010
 t = 53.100010
 t = 53.100010
 Tsteps = 53.000000 nsteps 55</pre><br>
<pre style="margin: 0em;"> t = 54.100010
 t = 54.100010
 t = 54.100010
 t = 54.100010
 t = 54.100010
 Tsteps = 54.000000 nsteps 56</pre><br>
Now interestingly, number of times f function was called (lets say after 
Tsteps=52 ) is 6 however t doesn't shows any internal division as all 
the ts' are same. However the cumulative number of steps taken only gets 
increased by one. So what does this multiple calls to f() suggest.I 
essentially want to use the value to t during the internal time steps in 
the function f().<br>
<br>
<pre style="margin: 0em;">Regards</pre><br>
<pre style="margin: 0em;">Raj</pre><br>
<pre style="margin: 0em;">------------------------------------------------------------------------</pre><br>
What are the most popular cars? Find out at Yahoo! Autos 
&lt;<a  href="http://us.rd.yahoo.com/evt=38382/_ylc=X3oDMTEzNWFva2Y2BF9TAzk3MTA3MDc2BHNlYwNtYWlsdGFncwRzbGsDMmF1dG9z/*http://autos.yahoo.com/newcars/popular/thisweek.html">http://us.rd.yahoo.com/evt=38382/_ylc=X3oDMTEzNWFva2Y2BF9TAzk3MTA3MDc2BHNlYwNtYWlsdGFncwRzbGsDMmF1dG9z/*http://autos.yahoo.com/newcars/popular/thisweek.html</a> 
 &gt;
</blockquote><pre style="margin: 0em;"><br></pre><br>
<br>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<div class="container">
<table width="95%" frame="below"><tr><td></td></table>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00306" href="msg00306.html">Re: [sundials-users] value of t during internal steps of CVODE call</a></strong>
<ul><li><em>From:</em> raj duffy &lt;raj_duffy@yahoo.com&gt;</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00301" href="msg00301.html">[sundials-users] value of t during internal steps of CVODE call</a></strong>
<ul><li><em>From:</em> raj duffy &lt;raj_duffy@yahoo.com&gt;</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00304.html">Re: [sundials-users] ODE</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00306.html">Re: [sundials-users] value of t during internal steps of CVODE call</a></strong>
</li>

<li>Previous by thread:
<strong><a href="msg00303.html">Re: [sundials-users] value of t during internal steps of CVODE call</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00306.html">Re: [sundials-users] value of t during internal steps of CVODE call</a></strong>
</li>

<li>Index(es):
<ul>
<li><a href="maillist.html#00305">
<strong>Main</strong></a></li>
<li><a href="threads.html#00305">
<strong>Thread</strong></a></li>
</ul>
</li>
</ul>
</div>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<!-- End content for this page -->
  </div>
  </td>
  <td background="../../graphics/table_bck3.gif"></td>
  </tr>
  <tr valign="top">
  <td height="17" background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  <td width="116"><a HREF="http://www.llnl.gov/disclaimer.html" target="_top"><img SRC="../../graphics/line_bl.gif" height="17" width="116" border="0"></a></td>
  <td width="720"><img SRC="../../graphics/line_br.gif" height="17" width="720" border="0"></td>
  <td background="../../graphics/table_bck4.gif"><img src="../../graphics/table_bck4.gif" width="5" height="17"></td>
  </tr>
  </table>
</body>
</html>
