%===================================================================================
\chapter{Introduction}\label{s:intro}
%===================================================================================

{\kinsol} is part of a software family called {\sundials}: SUite
of Nonlinear and DIfferential/ALgebraic equation Solvers. This
suite consists of {\cvode}, {\kinsol}, and {\ida}, and variants of
these.
%
{\kinsol}\index{KINSOL@{\kinsol}!brief description of} is a
general-purpose nonlinear system solver based on Newton-Krylov
solver technology.

%---------------------------------
\section{Historical Background}\label{ss:history}
%---------------------------------

\index{KINSOL@{\kinsol}!relationship to NKSOL}  The first
nonlinear solver packages based on Newton-Krylov methods were
written in {\F}.  In particular, the NKSOL package, written at
LLNL, was the first Newton-Krylov solver package written for
solution of systems arising in solution of partial differential
equations \cite{BrSa:90}.  This {\F} code made use of Newton's
method to solve the discrete nonlinear systems and applied a
preconditioned Krylov linear solver for solution of the Jacobian
system at each nonlinear iteration.  The key to the Newton-Krylov
method was that the matrix-vector multiplies required by the
Krylov method could effectively be approximated by a finite
difference of the nonlinear system-defining function, preventing a
requirement for the formation of the actual Jacobian matrix.
Significantly less memory was required for the solver as a result.

In the late 1990's, there was a push at LLNL to rewrite the
nonlinear solver into {\C} and port it to distributed memory
parallel machines.  Both Newton and Krylov methods are easily
implemented in parallel, and this effort gave rise to the
{\kinsol} package. {\kinsol} is similar to NKSOL in functionality,
except that it provides for more options in the choice of linear
system tolerances and has a more modular design to provide
flexibility for future enhancements.
\index{KINSOL@{\kinsol}!relationship to NKSOL}

\index{KINSOL@{\kinsol}!motivation for writing in C|(} There are
several motivations for choosing the {\C} language for {\kinsol}.
First, a general movement away from {\F} and toward {\C} in
scientific computing is apparent. Second, the pointer, structure,
and dynamic memory allocation features in C are extremely useful
in software of this complexity, with the great variety of method
options offered. Finally, we prefer {\C} over {\CPP} for {\kinsol}
because of the wider availability of {\C} compilers, the
potentially greater efficiency of {\C}, and the greater ease of
interfacing the solver to applications written in {\F}.
\index{KINSOL@{\kinsol}!motivation for writing in C|)}

In the process of translating NKSOL into {\C}, the overall
{\kinsol} organization has been changed considerably. One key
feature of the {\kinsol} organization is that a separate module
devoted to vector operations has been created.  This module
facilitated extension to multiprosessor environments with minimal
impact on the rest of the solver. The new vector module design is
shared across the {\sundials} suite. This {\nvector} module is
written in terms of abstract vector operations with the actual
routines attached by a particular implementation (such as serial
or parallel) of {\nvector}. This allows writing the {\sundials}
solvers in a manner independent of the actual {\nvector}
implementation (which can be user-supplied), as well as allowing
more than one {\nvector} module linked into an executable file.

\section{Changes from previous versions}

\subsection*{Changes in v2.2.0}

The major changes from the previous version involve a redesign of
the user interface across the entire {\sundials} suite. We have
eliminated the mechanism of providing optional inputs and
extracting optional statistics from the solver through the
\id{iopt} and \id{ropt} arrays. Instead, {\kinsol} now provides a
set of routines (with prefix \id{KINSet}) to change the default
values for various quantities controlling the solver and a set of
extraction routines (with prefix \id{KINGet}) to extract
statistics after return from the main solver routine. Similarly,
each linear solver module provides its own set of {\id{set}-} and
{\id{get}-type} routines. For more details see Chapter \ref{c:usage}.

Additionally, the interfaces to several user-supplied routines
(such as those providing Jacobian-vector products and
preconditioner information) were simplified by reducing the number
of arguments. The same information that was previously accessible
through such arguments can now be obtained through {\id{set}-type}
functions.

\subsection*{Changes in v2.2.1}

The changes in this minor {\sundials} release affect only the build system.

\section{Reading this User Guide}\label{ss:reading}

The structure of this document is as follows:
\begin{itemize}
\item
  The next chapter discusses how to install the \kinsol package.
\item
  In Chapter \ref{s:math}, we provide short descriptions of the numerical
  methods implemented by {\kinsol} for the solution of nonlinear systems.
\item
  The following chapter describes the structure of the {\sundials} suite
  of solvers (\S\ref{ss:sun_org}) and the software organization of the {\kinsol}
  solver (\S\ref{ss:kinsol_org}).
\item
  In Chapter \ref{c:usage}, we give an overview of the usage of {\kinsol},
  as well as a complete description of the user interface and of the
  user-defined routines for solution of nonlinear systems.
\item
  Chapter \ref{s:nvector} gives a brief overview of the generic {\nvector} module
  shared among the various components of {\sundials}, as well as details of the
  two {\nvector} implementations provided with {\sundials}: a serial implementation
  (\S\ref{ss:nvec_ser}) and a parallel implementation, based on {\mpi} \index{MPI}
  (\S\ref{ss:nvec_par}).
\item
  Chapter \ref{s:new_linsolv} describes the interfaces to the linear solver
  modules, so that a user can provide his/her own such module.
\item
  Chapter \ref{s:gen_linsolv} describes the generic linear solvers shared
  by all {\sundials} solvers.
\end{itemize}

Finally, the reader should be aware of the following notational
conventions in this user guide:  program listings and identifiers
(such as \id{KINMalloc}) within textual explanations appear in
typewriter type style; fields in {\C} structures (such as {\em
content}) appear in italics; and packages or modules are written
in all capitals.

\paragraph{Acknowledgments.}
We wish to acknowledge the contributions to previous versions of the
{\kinsol} code and user guide of Allan G. Taylor.
