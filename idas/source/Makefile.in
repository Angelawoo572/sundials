#--------------------------------------------------------------------------------
# File        : Makefile
# Programmers : Radu Serban @ LLNL
#--------------------------------------------------------------------------------
# Makefile for the IDAS package.
# @configure_input@
#--------------------------------------------------------------------------------

# Shell
SHELL = @SHELL@

# SUNDIALS instalation directory
prefix      = @prefix@
exec_prefix = @exec_prefix@
includedir  = @includedir@
libdir      = @libdir@

# Path to sources
srcdir = @srcdir@

# Archiver program
AR = @AR@

# Compiler and compiler options
CC       = @CC@
CPPFLAGS = @CPPFLAGS@
CFLAGS   = @CFLAGS@

# IDAS and SHARED include directories
SHARED_INC_DIR = ${srcdir}/../../shared/include
IDAS_INC_DIR   = ${srcdir}/../include

INCDIRS = -I${IDAS_INC_DIR} -I${SHARED_INC_DIR}

# IDAS library name
IDAS_LIB = libidas.a

# Source and object files
SRC =	${srcdir}/idas.c \
	${srcdir}/idaa.c \
	${srcdir}/idasic.c \
	${srcdir}/idasio.c \
	${srcdir}/idasband.c \
	${srcdir}/idasdense.c \
	${srcdir}/idasspgmr.c \
	${srcdir}/idasbbdpre.c

OBJ = idas.o idaa.o idasic.o idasio.o idasband.o idasdense.o idasspgmr.o idasbbdpre.o

#--------------------------------------------------------------------------------
# Make rules
#--------------------------------------------------------------------------------

all: ${OBJ}

install: ${OBJ}
	${AR} ${IDAS_LIB} ${OBJ}
	cp ${IDAS_LIB} ${libdir}
	cp ${IDAS_INC_DIR}/idas.h       ${includedir}
	cp ${IDAS_INC_DIR}/idaa.h       ${includedir}
	cp ${IDAS_INC_DIR}/idasdense.h  ${includedir}
	cp ${IDAS_INC_DIR}/idasband.h   ${includedir}
	cp ${IDAS_INC_DIR}/idasspgmr.h  ${includedir}
	cp ${IDAS_INC_DIR}/idasbbdpre.h ${includedir}

clean:
	rm -f ${OBJ}
	rm -f ${IDAS_LIB}

uninstall:
	rm -f ${libdir}/${IDAS_LIB}
	rm -f ${includedir}/idas.h
	rm -f ${includedir}/idaa.h
	rm -f ${includedir}/idasdense.h
	rm -f ${includedir}/idasband.h
	rm -f ${includedir}/idasspgmr.h
	rm -f ${includedir}/idasbbdpre.h

idas.o: ${srcdir}/idas.c
	${CC} -c ${CFLAGS} ${CPPFLAGS} ${INCDIRS} -o $@ $<
idaa.o: ${srcdir}/idaa.c
	${CC} -c ${CFLAGS} ${CPPFLAGS} ${INCDIRS} -o $@ $<
idasic.o: ${srcdir}/idasic.c
	${CC} -c ${CFLAGS} ${CPPFLAGS} ${INCDIRS} -o $@ $<
idasio.o: ${srcdir}/idasio.c
	${CC} -c ${CFLAGS} ${CPPFLAGS} ${INCDIRS} -o $@ $<
idasband.o: ${srcdir}/idasband.c
	${CC} -c ${CFLAGS} ${CPPFLAGS} ${INCDIRS} -o $@ $<
idasdense.o: ${srcdir}/idasdense.c
	${CC} -c ${CFLAGS} ${CPPFLAGS} ${INCDIRS} -o $@ $<
idasspgmr.o: ${srcdir}/idasspgmr.c
	${CC} -c ${CFLAGS} ${CPPFLAGS} ${INCDIRS} -o $@ $<
idasbbdpre.o: ${srcdir}/idasbbdpre.c
	${CC} -c ${CFLAGS} ${CPPFLAGS} ${INCDIRS} -o $@ $<

#---End of Makefile---