                              CVODE
                    Release 2.2.0, November 2002
             Scott D. Cohen, Alan C. Hindmarsh, Radu Serban
              Center for Applied Scientific Computing, LLNL

CVODE is a solver for stiff and nonstiff ODE systems (initial value problem) 
given in explicit form dy/dt = f(t,y). It is written in ANSI standard C.

CVODE can be used both on serial and parallel (MPI) computers.  The main
difference is in the NVECTOR module of vector kernels.  The desired
version is obtained when compiling the example files by linking the
appropriate library of NVECTOR kernels.  In the parallel version,
communication between processors is done with the MPI (Message Passage
Interface) system. 

When used with the serial NVECTOR module, CVODE provides both direct (dense 
and band) and a preconditioned Krylov (iterative) linear solvers. When CVODE 
is used with the parallel NVECTOR module, only the Krylov linear solver is 
available. (An approximate diagonal Jacobian option is available with both 
versions.)  For the serial version, there is a banded preconditioner module 
called CVBANDPRE available for use with the Krylov solver, while for the parallel 
version there is a preconditioner module called CVBBDPRE which provides a
band-block-diagonal preconditioner.

CVODE is part of a software family called SUNDIALS: SUite of Nonlinear
and DIfferential/ALgebraic equation Solvers.  This suite consists of
CVODE, KINSOL, and IDA, and variants of these.  The directory
structure of the package supplied reflects this family relationship.

For use with Fortran applications, a set of Fortran/C interface routines,
called FCVODE, is also supplied.  These are written in C, but assume that
the user calling program and all user-supplied routines are in Fortran.

The notes below provide the location of documentation, directions for the 
installation of the CVODE package, and relevant references. Following that 
is a brief history of revisions to the package.

A. Documentation
----------------

/sundials/cvode/doc contains PostScript and PDF files for the 
CVODE User Guide (cv_guide.ps and cv_guide.pdf) and the CVODE
Examples (cv_examples.ps and cv_examples.pdf) documents.

B. Installation
---------------

For basic installation instructions see /sundials/INSTALL. 
For complete installation instructions see the "CVODE Installation Procedure"
chapter in the CVODE User Guide.

C. References
-------------

[1] A. C. Hindmarsh and R. Serban, "User Documentation for CVODE v2.2.0," 
    LLLNL technical report UCRL-SM-208108, November 2004.

[2] A. C. Hindmarsh and R. Serban, "Example Programs for CVODE v2.2.0," 
    LLNL technical report UCRL-SM-208110, November 2004.

[3] S.D. Cohen and A.C. Hindmarsh, "CVODE, a Stiff/nonstiff ODE Solver in C,"
    Computers in Physics, 10(2), pp. 138-143, 1996.

[4] A. C. Hindmarsh, P. N. Brown, K. E. Grant, S. L. Lee, R. Serban, 
    D. E. Shumaker, and C. S. Woodward, "SUNDIALS, Suite of Nonlinear and 
    Differential/Algebraic Equation Solvers," ACM Trans. Math. Softw., 
    accepted, 2004.

D.1. Revision History since release 2.0 (July 2002)
---------------------------------------------------

- New features
   - added option to specify a value of the independent variable (time)
     past which the integratino is never to proceed.
   - added root finding capabilities.

- Changes related to the NVECTOR module 
  (see also the file sundials/shared/README)
   - removed machEnv, redefined table of vector operations (now contained
     in the N_Vector structure itself).
   - all CVODE functions create new N_Vector variables through cloning, using
     an N_Vector passed by the user as a template.

- Changes to type names and CVODE constants
   - removed type 'integertype'; instead use int or long int, as appropriate.
   - restructured the list of return values from the various CVODE functions.
   - changed all CVODE constants (inputs and return values) to have the
     prefix 'CV_' (e.g. CV_SUCCESS).
   - renamed various function types to have the prefix 'CV' (e.g. CVRhsFn).

- Changes to optional input/ouput
   - added CVodeSet* and CVodeGet* functions for optional inputs/outputs, 
     replacing the arrays iopt and ropt.
   - added new optional inputs (e.g. maximum number of Newton iterations,
     maximum number of convergence failures, etc).
   - the value of the last return flag from any function within a linear
     solver module can be obtained as an optional output (e.g. CVDenseGetLastFlag).
  
- Changes to user-callable functions
   - added new function CVodeCreate which initializes the CVODE solver
     object and returns a pointer to the CVODE memory block.
   - removed N (problem size) from all functions except the initialization
     functions for the direct linear solvers (CVDense and CVBand).
   - shortened argument lists of most CVODE functions (the arguments that
     were dropped can now be specified through CVodeSet* functions).
   - removed reinitialization functions for band/dense/SPGMR linear
     solvers (same functionality can be obtained using CV*Set* functions).
   - in CVBBDPRE, added a new function, CVBBDSpgmr to initialize the
     SPGMR linear solver with the BBD preconditioner.
   - function names changed in CVBANDPRE and CVBBDPRE for uniformity.

- Changes to user-supplied functions
   - removed N (probem dimension) from argument lists.
   - shortened argument lists for user dense/band/SPGMR Jacobian routines.
   - in CVSPGMR, shortened argument lists for user preconditioner functions.

- changes to the FCVODE module
   - revised to use underscore and precision flags at compile time (from configure)
   - reorganized FCVODE into fewer files
   - added tstop and root-finding capabilities
   - use CV*Set* and CV*Get* functions from CVODE (although the optional I/O 
     is still communicated to the user of FCVODE through arrays IOPT and ROPT)
   - added new optional inputs and outputs (e.g.tstop, nlscoef, maxnef, maxcor, 
     maxncf, etc.) and rearranged locations in IOPT and ROPT for uniformity
   


D.2 Previous revisions (YYYYMMDD)
---------------------------------

D.2.1 serial version of CVODE (1993 - March 2002)
-------------------------------------------------

1993-94   DATE WRITTEN.  First released 2 September 1994.
19941122  In CVAllocVectors, fixed machEnv; minor comment corrections.
19950210  Revised ABS in llnlmath.h for portability.
19950214  Added 'static' to VScaleDiff (vector.c) and CVStep (cvode.c);
          expanded PSolveFn description in iterativ.h.
19970811  Type names changed to LLNL_FLOAT etc.
19980120  Name changes: VECTOR to NVECTOR etc.; included expanded version of
          NVECTOR module in support of KINSOL.
19980508  Wrappers on header files for C++ use; type bool changed to boole;
          guards around definitions of macros MIN etc.
20000316  SPGMR module modified for correct treatment of scalings;
          in cvode.c, first f call moved from CVodeMalloc to CVode;
          argument ewt removed from CVEwtSet, CVEwtSetSS, CVEwtSetSV;
          added new routine CVReInit for re-initialization of CVODE;
          file doc/Readme added, with corrections to usage;
          minor errors corrected throughout.
20000320  In NVECTOR module: augmented module with three kernels (in support
          of IDA); removed unused variable in N_VWL2Norm.
20000323  Added band preconditioner module CVBANDPRE.
20000719  Fixed memory leak bugs in CVReInit.
20000808  Fixed bug in N_VMin routine.
20011114  Added option for stability limit detection algorithm STALD.
20011115  Reorganized DENSE module, with smalldense.* files separate.
20011214  All makefiles revised to use new CVODE/PVODE package structure.
20011220  Default type 'integer' changed to 'long int' in llnltyps.h.
20011220  Optional input ropt[HMAX] examined on every call to CVode.
20011220  Minor changes in cvode.c: comment errors fixed; conditional
          copy of acor in CVChooseEta; more robust tfuzz in CVodeDky. 
20011221  Optional input iopt[MXHNIL] = -1 means no t+h=t messages.
20011228  Added arguments jtimes (optional user J*v routine) and
          jac_data to CVSpgmr.
20020111  Minor corrections to cvode.c, in initialization of hmax_inv,
          nscon, and sldeton.
20020114  Linear solver modules reorganized: linear solver specification
          routines perform malloc operations and return a completion flag.
          Re-use of linear solver memory is allowed if linear solver
          choice and parameters are unchanged.   All examples modified
          to receive and test new return flag.
20020114  Minor changes to cvode.c and cvspgmr.c: unused variables in
          declarations, missing (non-occurring) return values.
20020301  Added ReInit routine to CVDENSE, CVBAND, CVSPGMR modules.
          Corrected usage note on CVReInit in cvode.h.
20020305  Added CVReInitBandPre routine to CVBANDPRE module.


D.2.2 parallel version of CVODE (PVODE)  (July 1995 - March 2002)
-----------------------------------------------------------------

19950726  DATE WRITTEN; MPI version of VECTOR module written, creating 
          MPI_PVODE; makefiles written with defs. specific to IBM-SP.
19950929  Makefiles revised to include definitions for Cray-T3D; packaged
          in directory, with subdirectories /source, /include, /examples.
19970116  Subdirectory /lib added; makefiles create and use libpvode.a.
19970124  Combined example makefiles into one.
19970219  FPVODE package of Fortran/C interfaces written, with examples.
19970625  Wrote preconditioner module BBDPRE.
19970724  FPVBBD - Fortran/C interfaces to BBDPRE precond. module written.
19970811  Type names changed to LLNL_FLOAT etc.
19970813  Changed first FFUN arg. in FPVODE to local length NLOC.
19971103  Added argc,argv to PVInitMPI call list; removed ICOMM
          argument to FPVINITMPI (pass MPI_COMM_WORLD).
19971201  Name changes: PVInitMPI/PVFreeMPI to PVecInitMPI/PVecFreeMPI.
19971208  Added optional argument dqrely to BBDPRE.
19971215  Package restructured - added subdirectory /precon, pvkxb example.
19971217  In FPVODE and FPVBBD, use name mappings dependent on parameters
          set in fcmixpar.h.
19980120  Name changes: VECTOR to NVECTOR etc.; expanded NVECTOR module from
          KINSOL included; package restructured - subdirectory /fcmix added.
19980206  Name changes for compatibility with KINSOL: BBDPRE to PVBBDPRE,
          FFUN to PVFUN, etc.; added report as reference.
19980508  Wrappers on header files for C++ use; type bool changed to boole;
          guards around definitions of macros MIN etc.
19980803  In PVBBDPRE, added two half-bandwidth arguments;
          use library file libpvpre.a for preconditioner module.
19980923  In FPVBBDIN, added two half-bandwidth arguments.
19981103  PS file for user doc. added to /doc subdirectory; README revised.
19981209  Simplified Fortran/C interface header files.
20000316  SPGMR module modified for correct treatment of scalings;
          in cvode.c, first f call moved from CVodeMalloc to CVode;
          argument ewt removed from CVEwtSet, CVEwtSetSS, CVEwtSetSV;
          added new routine CVReInit for re-initialization of CVODE;
          file doc/Readme added, with corrections to usage;
          minor errors corrected throughout.
20000320  In NVECTOR module: removed comm = NULL option in PVecInitMPI
          call, augmented module with three kernels (in support of IDA),
          removed unused variable in N_VWL2Norm;
          in PVBBDPRE module: added limits on half-bandwidths, preset
          relative increment value, revised internal comments.
20000321  In FPVODE module: added interface routine FPVREINIT, and
          expanded diagkf example to run two cases, using FPVREINIT.
20000719  Fixed memory leak bugs in CVReInit and FPVREINIT.
20000808  Fixed bug in N_VMin routine.
20011114  Added option for stability limit detection algorithm STALD;
          revised FPVODE documentation.
20011119  Renamed FPVODE example files for uniqueness.
20011214  All makefiles revised to use new CVODE/PVODE package structure.
20011220  Default type 'integer' changed to 'long int' in llnltyps.h.
20011220  In nvector.h, PVecInitMPI prototype, corrected type
          (int to integer) of length arguments.
20011220  Optional input ropt[HMAX] examined on every call to CVode.
20011220  Minor changes in cvode.c: comment errors fixed; conditional
          copy of acor in CVChooseEta; more robust tfuzz in CVodeDky. 
20011221  Optional input iopt[MXHNIL] = -1 means no t+h=t messages.
20011228  Added arguments jtimes (optional user J*v routine) and
          jac_data to CVSpgmr.  Revised examples accordingly.
20011228  Revised and expanded FPVODE interface package to accommodate
          optional jtimes routine.  Revised examples accordingly.
20020111  Minor corrections to cvode.c, in initialization of hmax_inv,
          nscon, and sldeton.
20020114  Linear solver modules reorganized: specification routines
          CVDiag and CVSpgmr perform malloc operations and return a
          completion flag.  Re-use of linear solver memory is allowed if
          linear solver choice and parameters are unchanged.  Fortran
          interface routines modified analogously.  All examples
          modified to receive and test new return flag.
20020114  Minor changes to cvode.c and cvspgmr.c: unused variables in
          declarations, missing (non-occurring) return values.
20020115  Minor corrections to cvode.h (CVReInit description), cvode.c
          (formatting in CVsldet), and cvbandpre.c (include added).
20020301  Added CVReInitSpgmr routine to CVSPGMR module.
          Corrected usage note on CVReInit in cvode.h.
          Revised cvdemk to use CVReInitSpgmr.
          Added six Fortran/C routines to interface to CVReInitSpgmr.
          Revised pvdiagkf example to use FCVREINSPGMR10.
          In pvaddenda file, revised two usage notes and added one.
20020306  Added PVReInitBBD routine to PVBBDPRE module.
          Revised pvkxb example to use PVReInitBBD.
          Added FPVREINBBD0/FPVREINBBD1 routines to FPVBBD module.
          Revised pvdiagkbf example to use FPVREINIT and FPVREINBBD0.


D.2.3. combined CVODE package (March 2002 - June 2002)
------------------------------------------------------

20020313  Modified to work with new NVECTOR abstraction.
          Changed name of PVBBDPRE module to CVBBDPRE and changed 
          routine names to reflect this.
20020321  Merged readme files cvreadme and pvreadme.
          Revisions throughout to reflect usage changes for NVECTOR modules
          (e.g. header file names, function calls in place of macros).
          Changed machEnv field from type void* to type M_Env. 
          Changed dense/band backsolve argument b type from N_Vector to real*.
          Added compatibility tests for linear solver and preconditoner modules
          vs NVECTOR module version.
          Added local vector length to CVBBDPRE data block.
          Added cvode_mem as argument to CVBandPreAlloc and CVBBDAlloc.
20020328  In FCVODE: (1) removed routines to initialize/free machine env. field,
          (2) added interfaces to dense/band linear solvers,
          (3) added prototypes for Fortran routines (prevents compiler warning),
          (4) changed argument Nlocal to N in Fortran routines,
          (5) changed from NVECTOR macros to function calls.
20020626  Changed type names real/integer to realtype/integertype.
