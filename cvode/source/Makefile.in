#--------------------------------------------------------------------------------
# File        : Makefile
# Programmers : Radu Serban @ LLNL
#--------------------------------------------------------------------------------
# Makefile for the CVODE package.
# @configure_input@
#--------------------------------------------------------------------------------

# Shell
SHELL = @SHELL@

# SUNDIALS instalation directory
prefix      = @prefix@
exec_prefix = @exec_prefix@
includedir  = @includedir@
libdir      = @libdir@

# Path to sources
srcdir = @srcdir@

# Archiver program
AR = @AR@

# Compiler options
CC       = @CC@
CPPFLAGS = @CPPFLAGS@
CFLAGS   = @CFLAGS@

# CVODE and SHARED include directories
SHARED_INC_DIR = ${srcdir}/../../shared/include
CVODE_INC_DIR  = ${srcdir}/../include

INCDIRS = -I${CVODE_INC_DIR} -I${SHARED_INC_DIR} 

# CVODE library name
CVODE_LIB = libcvode.a

# Source and object files
SRC =	${srcdir}/cvode.c \
	${srcdir}/cvband.c \
	${srcdir}/cvdense.c \
	${srcdir}/cvdiag.c \
	${srcdir}/cvspgmr.c \
	${srcdir}/cvbandpre.c \
	${srcdir}/cvbbdpre.c

OBJ = cvode.o cvband.o cvdense.o cvdiag.o cvspgmr.o cvbandpre.o cvbbdpre.o

#--------------------------------------------------------------------------------
# Make rules
#--------------------------------------------------------------------------------

all: ${OBJ}

install: ${OBJ}
	${AR} ${CVODE_LIB} ${OBJ}
	cp ${CVODE_LIB} ${libdir}
	cp ${CVODE_INC_DIR}/cvode.h      ${includedir}
	cp ${CVODE_INC_DIR}/cvdense.h    ${includedir}
	cp ${CVODE_INC_DIR}/cvband.h     ${includedir}
	cp ${CVODE_INC_DIR}/cvdiag.h     ${includedir}
	cp ${CVODE_INC_DIR}/cvspgmr.h    ${includedir}
	cp ${CVODE_INC_DIR}/cvbandpre.h  ${includedir}
	cp ${CVODE_INC_DIR}/cvbbdpre.h   ${includedir}

clean:
	rm -f ${OBJ}
	rm -f ${CVODE_LIB}

uninstall:
	rm -f ${libdir}/${CVODE_LIB}
	rm -f ${includedir}/cvode.h
	rm -f ${includedir}/cvdense.h
	rm -f ${includedir}/cvband.h
	rm -f ${includedir}/cvdiag.h
	rm -f ${includedir}/cvspgmr.h
	rm -f ${includedir}/cvbandpre.h
	rm -f ${includedir}/cvbbdpre.h

cvode.o : ${srcdir}/cvode.c
	${CC} -c ${CFLAGS} ${CPPFLAGS} ${INCDIRS} -o $@ $<
cvband.o : ${srcdir}/cvband.c
	${CC} -c ${CFLAGS} ${CPPFLAGS} ${INCDIRS} -o $@ $<
cvdense.o : ${srcdir}/cvdense.c
	${CC} -c ${CFLAGS} ${CPPFLAGS} ${INCDIRS} -o $@ $<
cvdiag.o : ${srcdir}/cvdiag.c
	${CC} -c ${CFLAGS} ${CPPFLAGS} ${INCDIRS} -o $@ $<
cvspgmr.o : ${srcdir}/cvspgmr.c
	${CC} -c ${CFLAGS} ${CPPFLAGS} ${INCDIRS} -o $@ $<
cvbandpre.o : ${srcdir}/cvbandpre.c
	${CC} -c ${CFLAGS} ${CPPFLAGS} ${INCDIRS} -o $@ $<
cvbbdpre.o : ${srcdir}/cvbbdpre.c
	${CC} -c ${CFLAGS} ${CPPFLAGS} ${INCDIRS} -o $@ $<

#---End of Makefile---
