\documentclass[titlepage,10pt]{article}

\input{m2tex}

\usepackage{calc, chngpage}
\usepackage[nottoc]{tocbibind}
\usepackage{rotating}
\usepackage{multirow}
\usepackage{tabls}

%----- Page formatting
\setlength{\oddsidemargin}{0.5in}
\setlength{\evensidemargin}{0.0in}
\setlength{\paperwidth}{8.5in}
\setlength{\hoffset}{0in}
\setlength{\textwidth}{\paperwidth-(1in+\hoffset)*2-\oddsidemargin-\evensidemargin}
\setlength{\textheight}{9.0in}

%---- Tables
\setlength{\extrarulesep}{2pt}

%----- UCRL number, date, versions
\newcommand{\STBucrl}{UCRL-SM-212121}
\newcommand{\STBdate}{May 2005}

%----- LLNL disclaimer
\newcommand{\disclaimer}{%
\changetext{.625in}{}{}{}{}
\thispagestyle{empty}% no number of this page
\vglue5\baselineskip
\begin{center}
{\bf DISCLAIMER}
\end{center}
\noindent
This document was prepared as an account of work sponsored by an agency of the
United States Government.  Neither the United States Government nor the University
of California nor any of their employees, makes any warranty, express or implied,
or assumes any legal liability or responsibility for the accuracy, completeness,
or usefulness of any information, apparatus, product, or process disclosed, or
represents that its use would not infringe privately owned rights. Reference
herein to any specific commercial product, process, or service by trade name,
trademark, manufacturer, or otherwise, does not necessarily constitute or imply
its endorsement, recommendation, or favoring by the United States Government
or the University of California.  The views and opinions of authors expressed
herein do not necessarily state or reflect those of the United States Government
or the University of California, and shall not be used for advertising or
product endorsement purposes.

\vskip2\baselineskip
This research was supported under the auspices of the U.S. Department of Energy by
the University of California, Lawrence Livermore National Laboratory under
contract No.  W-7405-Eng-48.
\vfill
\begin{center}
Approved for public release; further dissemination unlimited
\end{center}
\clearpage
\changetext{-.625in}{}{}{}{}
}

%----- Clear empty double page
\newcommand{\clearemptydoublepage}{\newpage{\pagestyle{empty}\cleardoublepage}}

%----- SUNDIALS MODULES
\newcommand{\sundialsTB}{{\normalfont\scshape sundialsTB}}
\newcommand{\sundials}{{\normalfont\scshape sundials}}
\newcommand{\nvector}{{\normalfont\scshape nvector}}
\newcommand{\putils}{{\normalfont\scshape putils}}
\newcommand{\cvode}{{\normalfont\scshape cvode}}
\newcommand{\cvodes}{{\normalfont\scshape cvodes}}
\newcommand{\ida}{{\normalfont\scshape ida}}
\newcommand{\idas}{{\normalfont\scshape idas}}
\newcommand{\kinsol}{{\normalfont\scshape kinsol}}

\newcommand{\matlab}{{\normalfont\scshape matlab}}
\newcommand{\mpiTB}{{\normalfont\scshape mpiTB}}

%----- title and author
\title{{\sundialsTB}, a {\matlab} Interface to {\sundials}}
\author{
  Radu Serban \\ 
  {\em Center for Applied Scientific Computing} \\ 
  {\em Lawrence Livermore National Laboratory}
}
\date{\STBdate \\ \vfill \STBucrl}

%------ BEGIN document

\begin{document}

\pagestyle{empty}
\maketitle
\disclaimer

\tableofcontents

\clearemptydoublepage

\pagestyle{plain}\pagenumbering{arabic}

\section{Introduction}

{\sundials}~\cite{HBGLSSW:04}, SUite of Nonlinear and DIfferential/ALgebraic equation Solvers,
is a family of software tools for integration of ODE and DAE initial value problems
and for the solution of nonlinear systems of equations.
It consists of {\cvode}, {\ida}, and {\kinsol}, and variants of these with 
sensitivity analysis capabilities.

{\sundialsTB} is a collection of {\matlab} functions which provide interfaces to
the {\sundials} solvers.

The core of each {\matlab} interface in {\sundialsTB} is a single {\sc mex} 
file which interfaces to the various user-callable functions for that solver.
However, this {\sc mex} file should not be called directly, but rather through the 
user-callable functions provided for each {\matlab} interface.

A major design principle for {\sundialsTB}
was to provide an interface that is, as much as possible, equally familiar to
users of both the {\sundials} codes and {\matlab}. Moreover, we tried to keep the
number of user-callable functions to a minimum. For example, the {\cvodes} {\matlab} 
interface contains only 9 such functions, 3 of which interface solely to the adjoint
sensitivity module in {\cvodes}. In tune with the {\matlab} {\sc odeset} function, optional
solver inputs in {\sundialsTB} are specified through a single function
({\tt CvodeSetOptions} for {\cvodes}). However, unlike the ODE solvers in {\matlab}, we
have kept the more flexible {\sundials} model in which a separate ``solve'' function 
({\tt CVodeSolve} for {\cvodes}) must be called to return the solution at a desired 
output time. Solver statistics, as well as optional outputs (such as
solution and solution derivatives at additional times) can be obtained at any time
with calls to separate functions ({\tt CVodeGetStats} and {\tt CVodeGet} for {\cvodes}).

This document provides a complete documentation for the {\sundialsTB} functions.
For additional details on the methods and underlying {\sundials} software consult
also the coresponding {\sundials} user guides~\cite{cvodes_ug,kinsol_ug}.

\subsection{Notes}

The version numbers for the {\matlab} interfaces correspond to those of the 
corresponding {\sundials} solver with wich the interface is compatible.

\subsection{Requirements}

Each interface module in {\sundialsTB} requires the appropriate version of the 
corresponding {\sundials} solver. For parallel support, {\sundialsTB} depends on
{\mpiTB} with {\sc lam} v $> 7.1.1$ (for MPI-2 spawning feature).

\subsection{Installation} 

\begin{enumerate}
\item Install the appropriate version of the {\sundials} solver(s).
\item Modify {\tt Makefile} ({\tt SUNDIALS} location) in the {\tt mex} directory 
  and compile
\item Optionally, for parallel support, install and configure {\sc LAM} 
  (local copy, since typical installations only install static libraries) and {\mpiTB}
\item Add the following paths to your {\matlab} {\tt startup.m} script:
  \begin{itemize}
  \item {\tt sundialsTB/cvodes} and {\tt sundialsTB/mex/cvm}   for {\cvodes}
%  \item {\tt sundialsTB/ida}    and {\tt sundialsTB/mex/idm}   for {\ida}
  \item {\tt sundialsTB/kinsol} and {\tt sundialsTB/mex/kim}   for {\kinsol}
  \item {\tt sundialsTB/nvector} and {\tt sundialsTB/mex/nvm}  for {\nvector} operations
  \item {\tt sundialsTB/putils}                                for {\tt mpirun} function
  \end{itemize}
\item In {\matlab}, try:
  \begin{itemize}
  \item {\tt help cvodes}
  \item {\tt help kinsol}
  \item{\tt help nvector}
  \item {\tt help putils}
  \end{itemize}
\end{enumerate}

\subsection{Links} 

The required software packages can be obtained from the following addresses.

\begin{tabular}{rl}
{\sundials} & {\tt http://www.llnl.gov/CASC/sundials} \\
{\mpiTB}    & {\tt http://atc.ugr.es/javier-bin/mpitb\_eng}\\
{\sc lam}   & {\tt http://www.lam-mpi.org/}
\end{tabular}
