\subsection{IDA}\label{ss:IDA}

IDA solves the  Initial Value Problem for DAE systems, which we write as
\begin{equation}\label{e:DAE}
  F(t,y,{\dot y}) = 0 \, ,\quad y(t_0) = y_0 \, ,~ {\dot y}(t_0) = {\dot y}_0 \, ,
\end{equation}
where  $F:R \times R^N \times R^N \rightarrow R^N$.
IDA is a rewrite in C of the Fortran solver DASPK by Brown, Hindmarsh,
and Petzold \cite{BHP:94}.

The integration method in IDA is variable-order variable-coefficient
BDF, in fixed-leading-coefficient form.  The method is implicit, and
each step involves a Newton iteration.  The Newton corrections involve
the Newton matrix
\begin{equation}\label{e:DAE_Jacobian}
  J = \frac{\partial F}{\partial y} + \alpha \frac{\partial F}{\partial {\dot y}} \, . 
\end{equation}
Here $\alpha$ is related to stepsize $h$ and the leading BDF
coefficient $\alpha_0$ by the relation $\alpha = \alpha_0/h$.

The linear systems are solved by one three methods:
\begin{itemize}
\item direct dense solve (user or internal $J$) (serial version only),
\item direct banded solve (user or internal $J$) (serial version
      only), or
\item SPGMR = Scaled Preconditioned GMRES, with restarts allowed.
      here preconditioning is allowed only on the left, so that GMRES
      is applied to systems $(P^{-1}J)(\Delta y) = -P^{-1}F$, and
      the user must supply routines for the setup and solve phases for
      the preconditioner $P$.
\end{itemize}

IDA permits the user to impose four different inequality constraints:
\begin{equation}
  y^i > 0~~ \mbox{or} ~~ y^i < 0~~ \mbox{or} ~~y^i \geq 0~~
  \mbox{or} ~~y^i \leq 0 ~.
\end{equation}
Any of these constraints, or no constraint, may be imposed on each
component of the solution vector $y$.

A difficulty often arises in solving DAE systems, that does arise for
ODEs -- namely the setting of initial conditions.  The user's input
values in $y_0, {\dot y}_0$ may or may not be consistent with the given
system $F = 0$.  But for integration to succeed, these vectors must
be consistent (or very close to consistent).

IDA provides an optional user-callable routine \cite{BHP:98} which
solves for consistent initial values, for two classes of problems:
\begin{itemize}
\item semi-explicit index-1 systems, where the differential components
of $y_0$ are known, but the algebraic components are unknown; and
\item problems with all of $y'_0$ specified and all of $y_0$ unknown.
\end{itemize}

In both cases, IDA solves the system $F(t_0,y_0, {\dot y}_0) = 0$ for the
unknown components of $y_0$ and ${\dot y}_0$, using Newton iteration
augmented with a linesearch global strategy.  In doing this, it makes
use of the existing machinery that is to be used for solving the
linear systems during the integration, in combination with certain
tricks involving the stepsize (which is set artificially for this
calculation).


