#--------------------------------------------------------------------------------------
# File        : Makefile
# Programmers : Radu Serban @ LLNL
#--------------------------------------------------------------------------------------
# Makefile for the parallel NVECTOR module.
# @configure_input@
#--------------------------------------------------------------------------------------

# Shell
SHELL = @SHELL@

# SUNDIALS instalation directory
prefix      = @prefix@
exec_prefix = @exec_prefix@
includedir  = @includedir@
libdir      = @libdir@

# Path to sources
srcdir = @srcdir@

# Archiver program
AR = @AR@

# Compiler and compiler options
CPPFLAGS  = @CPPFLAGS@
CFLAGS    = @CFLAGS@
MPICC     = @MPICC@
MPIINC    = @MPIINC@

# SHARED and NVECPAR include directory
SHARED_INC_DIR  = ${srcdir}/../shared/include
NVECPAR_INC_DIR = ${srcdir}

INCDIRS = -I${SHARED_INC_DIR} -I${NVECPAR_INC_DIR} ${MPIINC}

# NVECPARALLEL libraries
NVECPAR_LIB  = libnvecparallel.a
FNVECPAR_LIB = libfnvecparallel.a

# Source and object files
SRC =	${srcdir}/nvector_parallel.c \
	${srcdir}/fnvector_parallel.c

OBJ = nvector_parallel.o fnvector_parallel.o

#--------------------------------------------------------------------------------
# Make rules
#--------------------------------------------------------------------------------

all: ${OBJ}


install: ${OBJ}
	${AR} ${NVECPAR_LIB} nvector_parallel.o
	${AR} ${FNVECPAR_LIB} fnvector_parallel.o
	cp ${NVECPAR_LIB}  ${libdir}
	cp ${FNVECPAR_LIB} ${libdir}
	cp ${NVECPAR_INC_DIR}/nvector_parallel.h  ${includedir}
	cp ${NVECPAR_INC_DIR}/fnvector_parallel.h ${includedir}

clean:
	rm -f ${OBJ}
	rm -f ${NVECPAR_LIB}
	rm -f ${FNVECPAR_LIB}

uninstall:
	rm -f ${libdir}/${NVECPAR_LIB}
	rm -f ${libdir}/${FNVECPAR_LIB}
	rm -f ${includedir}/nvector_parallel.h
	rm -f ${includedir}/fnvector_parallel.h

${OBJ}: %.o : ${srcdir}/%.c
	${MPICC} -c ${CFLAGS} ${CPPFLAGS} ${INCDIRS} -o $@ $<

#---End of Makefile---